09/04/2025 03:08:46 PM - INFO - Reading in the 2010 block shapefile with 109228 rows
09/04/2025 03:08:46 PM - INFO - Reading in crosswalk file: blocks_mazs_tazs_2.5.csv
09/04/2025 03:08:46 PM - INFO - Starting iteration 1 of 5
09/04/2025 03:08:46 PM - INFO - Join block shapefile to crosswalk csv resulting in 109228 rows
09/04/2025 03:08:46 PM - INFO - The Dataframe has the following columns:
09/04/2025 03:08:46 PM - INFO - None
09/04/2025 03:08:46 PM - INFO - blocks_maz_df has length 109228
09/04/2025 03:08:46 PM - INFO - 
  STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10      NAME10  ...                                           geometry     maz     taz    GEOID10_BG GEOID10_TRACT  GEOID10_COUNTY
0        06        055    201700      4004  060552017004004  Block 4004  ...  POLYGON ((-122.46065 38.61807, -122.46062 38.6...  610054  600102  060552017004   06055201700           06055
1        06        055    201700      1013  060552017001013  Block 1013  ...  POLYGON ((-122.35414 38.50767, -122.35408 38.5...  611025  600006  060552017001   06055201700           06055
2        06        055    201700      4007  060552017004007  Block 4007  ...  POLYGON ((-122.4883 38.59902, -122.48826 38.60...  610857  600102  060552017004   06055201700           06055
3        06        055    201700      4023  060552017004023  Block 4023  ...  POLYGON ((-122.47466 38.59312, -122.47346 38.5...  611028  600102  060552017004   06055201700           06055
4        06        055    201403      1023  060552014031023  Block 1023  ...  POLYGON ((-122.1789 38.38562, -122.17748 38.38...  610051  600097  060552014031   06055201403           06055

[5 rows x 21 columns]
09/04/2025 03:08:47 PM - INFO - blocks_neighbor_df has length 725774
09/04/2025 03:08:47 PM - INFO - 
       src_GEOID10      nbr_GEOID10  LENGTH  NODE_COUNT nbr_GEOID10_BG          GEOID10     maz     taz
0  060014001001000  060014001001001 1838.32           0   060014001001  060014001001001  333453  301054
1  060014001001000  060014001001002 1291.63           0   060014001001  060014001001002  333453  301054
2  060014001001000  060014001001003  148.32           0   060014001001  060014001001003  333453  301054
3  060014001001000  060014001001004  560.54           0   060014001001  060014001001004  333453  301054
4  060014001001000  060014001001005  180.17           0   060014001001  060014001001005  333453  301054
09/04/2025 03:08:47 PM - INFO - Number of unique GEOID10: 109228
09/04/2025 03:08:47 PM - INFO -   Min: 060014001001000
09/04/2025 03:08:47 PM - INFO -   Max: 060979901000010
09/04/2025 03:08:47 PM - INFO - 
09/04/2025 03:08:47 PM - INFO - Number of unique maz: 39587
09/04/2025 03:08:48 PM - INFO -    Min: 10001
09/04/2025 03:08:48 PM - INFO -    Max: 814506
09/04/2025 03:08:48 PM - INFO - 
09/04/2025 03:08:48 PM - INFO - Number of unique taz: 4734
09/04/2025 03:08:48 PM - INFO -    Min: 1
09/04/2025 03:08:48 PM - INFO -    Max: 800210
09/04/2025 03:08:48 PM - INFO - 
09/04/2025 03:08:48 PM - INFO - Verified one taz per maz
09/04/2025 03:08:48 PM - INFO - Verified one GEOID10_COUNTY per maz
09/04/2025 03:08:48 PM - WARNING - Multiple GEOID10_TRACT for a single maz: 1
09/04/2025 03:08:48 PM - WARNING - 
        GEOID10_TRACT
maz                  
718685              2
09/04/2025 03:08:48 PM - INFO - move_small_block_to_neighbor for GEOID10_TRACT
09/04/2025 03:08:48 PM - INFO - Attempting to fix maz 718685
09/04/2025 03:08:48 PM - DEBUG - 
      STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
6812         06        097    151700      2027  060971517002027  ...  718685  700241  060971517002   06097151700          06097
21394        06        097    151503      3011  060971515033011  ...  718685  700241  060971515033   06097151503          06097
22360        06        097    151700      2025  060971517002025  ...  718685  700241  060971517002   06097151700          06097
28172        06        097    151503      3000  060971515033000  ...  718685  700241  060971515033   06097151503          06097
92991        06        097    151700      2029  060971517002029  ...  718685  700241  060971517002   06097151700          06097

[5 rows x 21 columns]
09/04/2025 03:08:48 PM - DEBUG - group 06097151503 has 2 rows and 83.8 percent of land
09/04/2025 03:08:48 PM - DEBUG - 
      STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
21394        06        097    151503      3011  060971515033011  ...  718685  700241  060971515033   06097151503          06097
28172        06        097    151503      3000  060971515033000  ...  718685  700241  060971515033   06097151503          06097

[2 rows x 21 columns]
09/04/2025 03:08:48 PM - DEBUG - group 06097151700 has 3 rows and 16.2 percent of land
09/04/2025 03:08:48 PM - DEBUG - 
      STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
6812         06        097    151700      2027  060971517002027  ...  718685  700241  060971517002   06097151700          06097
22360        06        097    151700      2025  060971517002025  ...  718685  700241  060971517002   06097151700          06097
92991        06        097    151700      2029  060971517002029  ...  718685  700241  060971517002   06097151700          06097

[3 rows x 21 columns]
09/04/2025 03:08:48 PM - DEBUG -   No neighbors in same block group with maz/taz
09/04/2025 03:08:48 PM - DEBUG -   No neighbors in same block group with maz/taz
09/04/2025 03:08:48 PM - DEBUG -   No neighbors in same block group with maz/taz
09/04/2025 03:08:48 PM - INFO - ====> moved 0 blocks to neighbor
09/04/2025 03:08:48 PM - WARNING - Multiple GEOID10_BG for a single maz: 2
09/04/2025 03:08:48 PM - WARNING - 
        GEOID10_BG
maz               
411035           2
718685           2
09/04/2025 03:08:48 PM - INFO - move_small_block_to_neighbor for GEOID10_BG
09/04/2025 03:08:48 PM - INFO - Attempting to fix maz 411035
09/04/2025 03:08:48 PM - DEBUG - 
       STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
25347         06        013    380000      3022  060133800003022  ...  411035  400461  060133800003   06013380000          06013
27226         06        013    380000      3025  060133800003025  ...  411035  400461  060133800003   06013380000          06013
45112         06        013    380000      1030  060133800001030  ...  411035  400461  060133800001   06013380000          06013
81307         06        013    380000      3021  060133800003021  ...  411035  400461  060133800003   06013380000          06013
98945         06        013    380000      3024  060133800003024  ...  411035  400461  060133800003   06013380000          06013
106972        06        013    380000      3023  060133800003023  ...  411035  400461  060133800003   06013380000          06013

[6 rows x 21 columns]
09/04/2025 03:08:48 PM - DEBUG - group 060133800001 has 1 rows and 0.3 percent of land
09/04/2025 03:08:48 PM - DEBUG - 
      STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
45112        06        013    380000      1030  060133800001030  ...  411035  400461  060133800001   06013380000          06013

[1 rows x 21 columns]
09/04/2025 03:08:48 PM - DEBUG -   No neighbors in same block group with maz/taz
09/04/2025 03:08:48 PM - DEBUG - group 060133800003 has 5 rows and 99.7 percent of land
09/04/2025 03:08:48 PM - DEBUG - 
       STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
25347         06        013    380000      3022  060133800003022  ...  411035  400461  060133800003   06013380000          06013
27226         06        013    380000      3025  060133800003025  ...  411035  400461  060133800003   06013380000          06013
81307         06        013    380000      3021  060133800003021  ...  411035  400461  060133800003   06013380000          06013
98945         06        013    380000      3024  060133800003024  ...  411035  400461  060133800003   06013380000          06013
106972        06        013    380000      3023  060133800003023  ...  411035  400461  060133800003   06013380000          06013

[5 rows x 21 columns]
09/04/2025 03:08:48 PM - INFO - Attempting to fix maz 718685
09/04/2025 03:08:48 PM - DEBUG - 
      STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
6812         06        097    151700      2027  060971517002027  ...  718685  700241  060971517002   06097151700          06097
21394        06        097    151503      3011  060971515033011  ...  718685  700241  060971515033   06097151503          06097
22360        06        097    151700      2025  060971517002025  ...  718685  700241  060971517002   06097151700          06097
28172        06        097    151503      3000  060971515033000  ...  718685  700241  060971515033   06097151503          06097
92991        06        097    151700      2029  060971517002029  ...  718685  700241  060971517002   06097151700          06097

[5 rows x 21 columns]
09/04/2025 03:08:48 PM - DEBUG - group 060971515033 has 2 rows and 83.8 percent of land
09/04/2025 03:08:48 PM - DEBUG - 
      STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
21394        06        097    151503      3011  060971515033011  ...  718685  700241  060971515033   06097151503          06097
28172        06        097    151503      3000  060971515033000  ...  718685  700241  060971515033   06097151503          06097

[2 rows x 21 columns]
09/04/2025 03:08:48 PM - DEBUG - group 060971517002 has 3 rows and 16.2 percent of land
09/04/2025 03:08:48 PM - DEBUG - 
      STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10  ...     maz     taz    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY
6812         06        097    151700      2027  060971517002027  ...  718685  700241  060971517002   06097151700          06097
22360        06        097    151700      2025  060971517002025  ...  718685  700241  060971517002   06097151700          06097
92991        06        097    151700      2029  060971517002029  ...  718685  700241  060971517002   06097151700          06097

[3 rows x 21 columns]
09/04/2025 03:08:48 PM - DEBUG -   No neighbors in same block group with maz/taz
09/04/2025 03:08:48 PM - DEBUG -   No neighbors in same block group with maz/taz
09/04/2025 03:08:48 PM - DEBUG -   No neighbors in same block group with maz/taz
09/04/2025 03:08:48 PM - INFO - ====> moved 0 blocks to neighbor
09/04/2025 03:08:48 PM - WARNING - Multiple GEOID10_TRACT for a single taz: 2
09/04/2025 03:08:48 PM - WARNING - 
        GEOID10_TRACT
taz                  
327                 2
700241              2
09/04/2025 03:08:48 PM - INFO - splitting taz for tract
09/04/2025 03:08:48 PM - INFO - Attempting to fix taz    327
09/04/2025 03:08:48 PM - DEBUG - 
               ALAND10  ALAND10_pct
GEOID10_TRACT                      
06075017902       4650         0.01
06075023103     748028         0.99
09/04/2025 03:08:48 PM - INFO - Tract/taz portion too small -- skipping
09/04/2025 03:08:48 PM - INFO - Attempting to fix taz 700241
09/04/2025 03:08:48 PM - DEBUG - 
               ALAND10  ALAND10_pct
GEOID10_TRACT                      
06097151503     977478         1.00
06097151700       4177         0.00
09/04/2025 03:08:48 PM - INFO - Tract/taz portion too small -- skipping
09/04/2025 03:08:48 PM - INFO - Verified one GEOID10_COUNTY per taz
09/04/2025 03:08:48 PM - INFO - No blocks moved or tazs split -- exiting iterations
09/04/2025 03:08:48 PM - INFO - Saving crosswalk as final crosswalk: blocks_mazs_tazs_2.5.csv
09/04/2025 03:08:49 PM - INFO - Number of blocks per maz: 
09/04/2025 03:08:49 PM - INFO -    Min: 1
09/04/2025 03:08:49 PM - INFO -    Max: 89
09/04/2025 03:08:49 PM - INFO -   Mean: 2.7092227246318235
09/04/2025 03:08:49 PM - INFO - 
09/04/2025 03:08:49 PM - INFO - Number of maz per taz: 
09/04/2025 03:08:49 PM - INFO -    Min: 1
09/04/2025 03:08:49 PM - INFO -    Max: 118
09/04/2025 03:08:49 PM - INFO -   Mean: 8.36227291930714
09/04/2025 03:08:49 PM - INFO - 
09/04/2025 03:08:49 PM - INFO - Number of blocks without maz/taz: 1978
09/04/2025 03:08:49 PM - INFO - Number of blocks without maz/taz with land area: 0
09/04/2025 03:08:49 PM - INFO - Number of blocks with maz/taz without land area: 0
09/04/2025 03:08:49 PM - INFO - maz_taz_county_check=
                   maz             taz        
                   min     max     min     max
GEOID10_COUNTY                                
06001           310001  334484  300001  301132
06013           410001  428307  400001  400641
06041           810002  814506  800001  800210
06055           610002  661598  600001  600107
06075            10001   17386       1     651
06081           110002  119251  100001  100467
06085           210002  232367  200002  201093
06095           510002  520521  500001  500287
06097           710009  720388  700001  700387
09/04/2025 03:08:49 PM - INFO - Dissolving blocks into MAZs and TAZs
09/04/2025 03:09:08 PM - INFO - Calculated part count for mazs
09/04/2025 03:09:08 PM - INFO - Calculated perimeter length for mazs
09/04/2025 03:09:08 PM - INFO - Calculated perim*perim/area for mazs
09/04/2025 03:09:08 PM - INFO - Calculated acres for mazs
09/04/2025 03:09:08 PM - INFO - Creating centroids for maz
09/04/2025 03:09:11 PM - INFO - Created 39,587 records
09/04/2025 03:09:11 PM - INFO - Saving final mazs into mazs_TM2_2_5.shp
09/04/2025 03:09:40 PM - INFO - Calculated part count for tazs
09/04/2025 03:09:40 PM - INFO - Calculated perimeter length for tazs
09/04/2025 03:09:40 PM - INFO - Calculated perim*perim/area for tazs
09/04/2025 03:09:40 PM - INFO - Calculated acres for tazs
09/04/2025 03:09:40 PM - INFO - Creating centroids for taz
09/04/2025 03:09:40 PM - INFO - Created 4,734 records
09/04/2025 03:09:40 PM - INFO - Saving final tazs into tazs_TM2_2_5.shp
09/04/2025 03:09:40 PM - INFO - Joining mazs/tazs to superdistricts
09/04/2025 03:09:45 PM - INFO - Read M:\Data\Census\Geography\tl_2010_06_puma10\2010_Census_Tract_to_2010_PUMA.txt; head=
  STATEFP10 COUNTYFP10 TRACTCE10 PUMA10
0        01        001    020100  02100
1        01        001    020200  02100
2        01        001    020300  02100
3        01        001    020400  02100
4        01        001    020500  02100
09/04/2025 03:09:45 PM - INFO - blocks_maz_df len=107,250.head():
  STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10      NAME10  ...                                           geometry     maz     taz    GEOID10_BG GEOID10_TRACT  GEOID10_COUNTY
0        06        055    201700      4004  060552017004004  Block 4004  ...  POLYGON ((-122.46065 38.61807, -122.46062 38.6...  610054  600102  060552017004   06055201700           06055
1        06        055    201700      1013  060552017001013  Block 1013  ...  POLYGON ((-122.35414 38.50767, -122.35408 38.5...  611025  600006  060552017001   06055201700           06055
2        06        055    201700      4007  060552017004007  Block 4007  ...  POLYGON ((-122.4883 38.59902, -122.48826 38.60...  610857  600102  060552017004   06055201700           06055
3        06        055    201700      4023  060552017004023  Block 4023  ...  POLYGON ((-122.47466 38.59312, -122.47346 38.5...  611028  600102  060552017004   06055201700           06055
4        06        055    201403      1023  060552014031023  Block 1023  ...  POLYGON ((-122.1789 38.38562, -122.17748 38.38...  610051  600097  060552014031   06055201403           06055

[5 rows x 21 columns]
09/04/2025 03:09:45 PM - INFO - blocks_maz_df len=107,250.head():
  STATEFP10 COUNTYFP10 TRACTCE10 BLOCKCE10          GEOID10      NAME10 MTFCC10 UR10  ...    GEOID10_BG GEOID10_TRACT GEOID10_COUNTY  suprdistid      DistName   MAZ_X MAZ_Y PUMA10
0        06        055    201700      4004  060552017004004  Block 4004   G5040    R  ...  060552017004   06055201700          06055          28  Saint Helena -122.45 38.62  05500
1        06        055    201700      1013  060552017001013  Block 1013   G5040    R  ...  060552017001   06055201700          06055          28  Saint Helena -122.33 38.51  05500
2        06        055    201700      4007  060552017004007  Block 4007   G5040    R  ...  060552017004   06055201700          06055          28  Saint Helena -122.48 38.60  05500
3        06        055    201700      4023  060552017004023  Block 4023   G5040    R  ...  060552017004   06055201700          06055          28  Saint Helena -122.46 38.59  05500
4        06        055    201403      1023  060552014031023  Block 1023   G5040    R  ...  060552014031   06055201403          06055          28  Saint Helena -122.15 38.37  05500

[5 rows x 26 columns]
