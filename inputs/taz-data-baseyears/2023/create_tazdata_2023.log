[1] "BLOCK2020_TAZ1454:"
            GEOID                                                                         NAME variable   blockgroup       tract TAZ1454 SUPERD block_POPULATION
1 060855017001008 Block 1008, Block Group 1, Census Tract 5017, Santa Clara County, California  P1_001N 060855017001 06085501700     560     11                0
2 060855109001003 Block 1003, Block Group 1, Census Tract 5109, Santa Clara County, California  P1_001N 060855109001 06085510900     360      8               81
3 060014351032020  Block 2020, Block Group 2, Census Tract 4351.03, Alameda County, California  P1_001N 060014351032 06001435103     820     17                0
4 060014305003017     Block 3017, Block Group 3, Census Tract 4305, Alameda County, California  P1_001N 060014305003 06001430500     853     17              116
5 060014506071030  Block 1030, Block Group 1, Census Tract 4506.07, Alameda County, California  P1_001N 060014506071 06001450607     739     15                0
6 060014507451018  Block 1018, Block Group 1, Census Tract 4507.45, Alameda County, California  P1_001N 060014507451 06001450745     743     15              140
[1] "ACS_5year: 2022"
[1] "emp_self_employed_w:"
# A tibble: 1,453 × 8
   TAZ1454 AGREMPN FPSEMPN HEREMPN MWTEMPN OTHEMPN RETEMPN TOTEMP
     <int>   <int>   <int>   <int>   <int>   <int>   <int>  <dbl>
 1       1       6     462     323     114     122      42   1069
 2       2      11     799     559     198     211      72   1850
 3       3       1      55      38      14      15       5    128
 4       4      12     932     652     231     247      84   2158
 5       5       7     521     365     129     138      47   1207
 6       6       2     136      95      34      36      12    315
 7       7       3     165     116      41      44      15    384
 8       8       1     102      72      24      28       9    236
 9       9       2     179     126      44      47      16    414
10      10       6     450     314     111     119      40   1040
# ℹ 1,443 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "emp_self_employed_county total: 397,955"
[1] "LEHD LODES from 2022 (after adding self-employment):"
# A tibble: 99 × 3
   w_county h_county         TOTEMP
   <chr>    <chr>             <dbl>
 1 Alameda  Alameda          431548
 2 Alameda  Contra Costa     109614
 3 Alameda  Marin              7941
 4 Alameda  Napa               2928
 5 Alameda  Outside Bay Area 175351
 6 Alameda  San Francisco     36469
 7 Alameda  San Mateo         30997
 8 Alameda  Santa Clara       77684
 9 Alameda  Solano            19277
10 Alameda  Sonoma             8413
# ℹ 89 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "employment:"
# A tibble: 1,454 × 8
   TAZ1454 AGREMPN FPSEMPN HEREMPN MWTEMPN RETEMPN OTHEMPN TOTEMP
     <int>   <int>   <int>   <int>   <int>   <int>   <int>  <dbl>
 1       1       9   13221    2082     599     263    1715  17889
 2       2      18   17213    3233    1225     151    4318  26158
 3       3       1    1237     526      15      59     346   2184
 4       4      12   14568    3295     628     596    4574  23673
 5       5       7    5877    3591     716    2257    1612  14060
 6       6       2     564    2726      63      78     136   3569
 7       7       3    1379    4310      49     386     183   6310
 8       8       1     684    2642      56      48     727   4158
 9       9       2     864    3761      48     153    1836   6664
10      10      16    4396   10467     795     183    9677  25534
# ℹ 1,444 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "TOTEMP: 3,661,303"
[1] "blockTAZBG has 5187 rows:"
# A tibble: 6 × 2
  blockgroup   BGTotal
  <chr>          <int>
1 060014001001    1789
2 060014001002    1249
3 060014002001    1022
4 060014002002     979
5 060014003001    1123
6 060014003002    1528
[1] "blockTAZTract has 1772 rows:"
# A tibble: 6 × 2
  tract       TractTotal
  <chr>            <int>
1 06001400100       3038
2 06001400200       2001
3 06001400300       5504
4 06001400400       4112
5 06001400500       3644
6 06001400600       1788
[1] "combined_block has 82209 rows"
[1] "head(combined_block):"
             GEOID                                                                             NAME variable   blockgroup       tract TAZ1454 SUPERD block_POPULATION BGTotal    sharebg TractTotal  sharetract
1  060855017001008     Block 1008, Block Group 1, Census Tract 5017, Santa Clara County, California  P1_001N 060855017001 06085501700     560     11                0    1101 0.00000000       5155 0.000000000
2  060855109001003     Block 1003, Block Group 1, Census Tract 5109, Santa Clara County, California  P1_001N 060855109001 06085510900     360      8               81    1653 0.04900181       5404 0.014988897
3  060014351032020      Block 2020, Block Group 2, Census Tract 4351.03, Alameda County, California  P1_001N 060014351032 06001435103     820     17                0    1829 0.00000000       7726 0.000000000
4  060014305003017         Block 3017, Block Group 3, Census Tract 4305, Alameda County, California  P1_001N 060014305003 06001430500     853     17              116    1825 0.06356164       6289 0.018444904
5  060014506071030      Block 1030, Block Group 1, Census Tract 4506.07, Alameda County, California  P1_001N 060014506071 06001450607     739     15                0    2435 0.00000000       6054 0.000000000
6  060014507451018      Block 1018, Block Group 1, Census Tract 4507.45, Alameda County, California  P1_001N 060014507451 06001450745     743     15              140    3052 0.04587156       6374 0.021964230
7  060014507421002      Block 1002, Block Group 1, Census Tract 4507.42, Alameda County, California  P1_001N 060014507421 06001450742     745     15               36    1746 0.02061856       5439 0.006618864
8  060014278001003         Block 1003, Block Group 1, Census Tract 4278, Alameda County, California  P1_001N 060014278001 06001427800     959     18                0     731 0.00000000       4827 0.000000000
9  060014006001007         Block 1007, Block Group 1, Census Tract 4006, Alameda County, California  P1_001N 060014006001 06001400600    1000     19               40    1076 0.03717472       1788 0.022371365
10 060014075001003         Block 1003, Block Group 1, Census Tract 4075, Alameda County, California  P1_001N 060014075001 06001407500     903     18                0     998 0.00000000       4383 0.000000000
11 060133551091008 Block 1008, Block Group 1, Census Tract 3551.09, Contra Costa County, California  P1_001N 060133551091 06013355109    1186     24               53    1374 0.03857351       7167 0.007395005
12 060133680013009 Block 3009, Block Group 3, Census Tract 3680.01, Contra Costa County, California  P1_001N 060133680013 06013368001    1067     20               91    1225 0.07428571       5467 0.016645327
13 060133040072005 Block 2005, Block Group 2, Census Tract 3040.07, Contra Costa County, California  P1_001N 060133040072 06013304007    1179     24              123    1552 0.07925258       4706 0.026136847
14 060855078083002  Block 3002, Block Group 3, Census Tract 5078.08, Santa Clara County, California  P1_001N 060855078083 06085507808     492     10               99    1438 0.06884562       5674 0.017448008
15 060952529092014       Block 2014, Block Group 2, Census Tract 2529.09, Solano County, California  P1_001N 060952529092 06095252909    1278     26              115    2758 0.04169688       4421 0.026012214
16 060952527026124       Block 6124, Block Group 6, Census Tract 2527.02, Solano County, California  P1_001N 060952527026 06095252702    1251     26                0    1077 0.00000000       7039 0.000000000
17 060952535013017       Block 3017, Block Group 3, Census Tract 2535.01, Solano County, California  P1_001N 060952535013 06095253501    1290     26                0    1596 0.00000000       6327 0.000000000
18 060014079001005         Block 1005, Block Group 1, Census Tract 4079, Alameda County, California  P1_001N 060014079001 06001407900     907     18              176     875 0.20114286       3081 0.057124310
19 060014219004016         Block 4016, Block Group 4, Census Tract 4219, Alameda County, California  P1_001N 060014219004 06001421900    1025     19                0     910 0.00000000       3901 0.000000000
20 060014277004001         Block 4001, Block Group 4, Census Tract 4277, Alameda County, California  P1_001N 060014277004 06001427700     963     18              145     883 0.16421291       5016 0.028907496
[1] "DHC_tract_raw (1772 rows):"
                       [,1]   
gq_inst_m_0017         "  574"
gq_noninst_m_0017_univ "  112"
gq_noninst_m_0017_mil  "    1"
gq_noninst_m_0017_oth  " 1940"
gq_inst_m_1864         "18883"
gq_noninst_m_1864_univ "23833"
gq_noninst_m_1864_mil  " 1268"
gq_noninst_m_1864_oth  "35734"
gq_inst_m_65p          " 9078"
gq_noninst_m_65p_univ  "   13"
gq_noninst_m_65p_mil   "    3"
gq_noninst_m_65p_oth   " 7283"
gq_inst_f_0017         "  489"
gq_noninst_f_0017_univ "  167"
gq_noninst_f_0017_mil  "    1"
gq_noninst_f_0017_oth  " 1849"
gq_inst_f_1864         " 6139"
gq_noninst_f_1864_univ "26563"
gq_noninst_f_1864_mil  "  411"
gq_noninst_f_1864_oth  "20458"
gq_inst_f_65p          "12915"
gq_noninst_f_65p_univ  "    6"
gq_noninst_f_65p_mil   "    0"
gq_noninst_f_65p_oth   " 7137"
[1] "ACS_tract_raw (1772 rows):"
# A tibble: 1,772 × 9
   GEOID       hhwrks0 hhwrks1 hhwrks2 hhwrks3p ownkidsyes rentkidsyes ownkidsno rentkidsno
   <chr>         <dbl>   <dbl>   <dbl>    <dbl>      <dbl>       <dbl>     <dbl>      <dbl>
 1 06001400100     412     589     299       77        365          18       885        109
 2 06001400200     166     388     275       47        123          79       367        307
 3 06001400300     725     907     860      146        375         217       572       1474
 4 06001400400     417     523     718      102        289         182       584        705
 5 06001400500     339     697     482      161        183         115       618        763
 6 06001400600      89     274     356       49        103          96       207        362
 7 06001400700     281     846     658      227        265         164       482       1101
 8 06001400800     287     819     663      116        148         214       513       1010
 9 06001400900     148     385     421      159        129         209       273        502
10 06001401000     325     843     857      277        293         187       648       1174
# ℹ 1,762 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "ACS_BG_raw (5187 rows):"
# A tibble: 5,187 × 132
   GEOID        tothh hhpop male0_4 male5_9 male10_14 male15_17 male18_19 male20 male21 male22_24 male25_29 male30_34 male35_39 male40_44 male45_49 male50_54 male55_59 male60_61 male62_64 male65_66 male67_69 male70_74 male75_79 male80_84 male85p female0_4 female5_9 female10_14 female15_17 female18_19 female20 female21 female22_24 female25_29 female30_34 female35_39 female40_44 female45_49 female50_54 female55_59 female60_61 female62_64 female65_66 female67_69 female70_74 female75_79 female80_84
   <chr>        <dbl> <dbl>   <dbl>   <dbl>     <dbl>     <dbl>     <dbl>  <dbl>  <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>     <dbl>   <dbl>     <dbl>     <dbl>       <dbl>       <dbl>       <dbl>    <dbl>    <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>       <dbl>
 1 060014001001   711  1975      52      79       144        28         0      0      0        31        40        94        11        60        36       161        28        65        28         9        46        86        26         8      44        19        94          30          21          10        0       24          21          31          61          90          28          31         120          64           0          24           9          53          47          46          50
 2 060014001002   666  1294      20      26        23         0         0      0      0         0         0        22        19        10        49        40       157        26         9        10        30        28        30        20      26        42        41          29          13           0        0        0           0          12           8          56          55          57          64          54           0          28          47          45          41          28          42
 3 060014002001   421   948      35      20        12        20         0      4      0         0         8        15        57        22        18        14        29        10        12        19        23        75        32         5       9        40         0          25           4          11        0        0          13          39          17          41          22          43           8          25           6          28          13          26          71          47          19
 4 060014002002   455  1072      48      15         9         0        10      0      0        12       103        93        63        32        51        56        25         0        39         0        12        20        18        16      14        46         7          34          35           0        0        0           7          69          47          77           5          44          33          17           7          12           3           9          14          69          28
 5 060014003001   485  1300       0      68        98        18        18      0      0        27       125        33        32        70        15        73        79         0         0         0         0        49        73         0       0        14        40          18          16           0        0        0           0          11          55          16          55          53         113           0           0          25          15           0          54          37           0
 6 060014003002  1009  1680       3       0        34        67         6      0      6         0       229       131       146        20       157         0         0         0         0         0         0        20         1         0      18         4        42           0          14           7        8        0           0         133          66          35          60         132          65          20           0           0          12          42          69           0          18
 7 060014003003   601  1093       0      21         0        64        45      0      0         0         0        47        35        10        44         0        85        25        67         0         0        51         0        14      13        14        42          30           0           0        0       23           0          69          51          81          16           7         108           8           0          15          46           0          29          36           0
 8 060014003004   543  1516      31     117        29         0         0      0      0         0        32       137        40        54        15        98        16        21         0         0        31         0        29        14       0        61        70          27           0          23        0        0           0         187         116          60          31          56          36          18          16          48           0          23          34          34           0
 9 060014004001   642  1249       0      29        48        15         0      0      0         0         0        76        78        24        87        68         9        15        49         9        10        36        21         0       0        16        44          22           6          10       12        0           0          82          50          71          47          39           8          35          22           9          56          34          64          38           0
10 060014004002   503  1314      61      32        17         0         0      0      0         0        65        58        60        48        39        10         8        23        40        14        10        28         9         9       8        41        71          94          12           0        0        0          52          87          19         111          49          55          21          36           0          48          17           9          10          10          23
# ℹ 5,177 more rows
# ℹ 84 more variables: female85p <dbl>, own1 <dbl>, own2 <dbl>, own3 <dbl>, own4 <dbl>, own5 <dbl>, own6 <dbl>, own7p <dbl>, rent1 <dbl>, rent2 <dbl>, rent3 <dbl>, rent4 <dbl>, rent5 <dbl>, rent6 <dbl>, rent7p <dbl>, white_nonh <dbl>, black_nonh <dbl>, asian_nonh <dbl>, total_nonh <dbl>, total_hisp <dbl>, unit1d <dbl>, unit1a <dbl>, unit2 <dbl>, unit3_4 <dbl>, unit5_9 <dbl>, unit10_19 <dbl>, unit20_49 <dbl>, unit50p <dbl>, mobile <dbl>, boat_RV_Van <dbl>, employed <dbl>, armedforces <dbl>,
#   hhinc000_010 <dbl>, hhinc010_015 <dbl>, hhinc015_020 <dbl>, hhinc020_025 <dbl>, hhinc025_030 <dbl>, hhinc030_035 <dbl>, hhinc035_040 <dbl>, hhinc040_045 <dbl>, hhinc045_050 <dbl>, hhinc050_060 <dbl>, hhinc060_075 <dbl>, hhinc075_100 <dbl>, hhinc100_125 <dbl>, hhinc125_150 <dbl>, hhinc150_200 <dbl>, hhinc200p <dbl>, occ_m_manage <dbl>, occ_m_prof_biz <dbl>, occ_m_prof_comp <dbl>, occ_m_svc_comm <dbl>, occ_m_prof_leg <dbl>, occ_m_prof_edu <dbl>, occ_m_svc_ent <dbl>, occ_m_prof_heal <dbl>,
#   occ_m_svc_heal <dbl>, occ_m_svc_fire <dbl>, occ_m_svc_law <dbl>, occ_m_ret_eat <dbl>, occ_m_man_build <dbl>, occ_m_svc_pers <dbl>, occ_m_ret_sales <dbl>, occ_m_svc_off <dbl>, occ_m_man_nat <dbl>, occ_m_man_prod <dbl>, occ_f_manage <dbl>, occ_f_prof_biz <dbl>, occ_f_prof_comp <dbl>, occ_f_svc_comm <dbl>, occ_f_prof_leg <dbl>, occ_f_prof_edu <dbl>, occ_f_svc_ent <dbl>, occ_f_prof_heal <dbl>, occ_f_svc_heal <dbl>, occ_f_svc_fire <dbl>, occ_f_svc_law <dbl>, occ_f_ret_eat <dbl>,
#   occ_f_man_build <dbl>, occ_f_svc_pers <dbl>, occ_f_ret_sales <dbl>, occ_f_svc_off <dbl>, occ_f_man_nat <dbl>, occ_f_man_prod <dbl>
# ℹ Use `print(n = ...)` to see more rows
[1] "interim (82209 rows):"
             GEOID                                                                             NAME variable   blockgroup       tract TAZ1454 SUPERD block_POPULATION BGTotal    sharebg TractTotal  sharetract tothh hhpop male0_4 male5_9 male10_14 male15_17 male18_19 male20 male21 male22_24 male25_29 male30_34 male35_39 male40_44 male45_49 male50_54 male55_59 male60_61 male62_64 male65_66 male67_69 male70_74 male75_79 male80_84 male85p female0_4 female5_9 female10_14 female15_17 female18_19
1  060855017001008     Block 1008, Block Group 1, Census Tract 5017, Santa Clara County, California  P1_001N 060855017001 06085501700     560     11                0    1101 0.00000000       5155 0.000000000   440   831      50       0         0         0         0      0      0         9       109        67        55        70        32        15        17         0         0         0        12         0         0         0       0        42         0          48           0           0
2  060855109001003     Block 1003, Block Group 1, Census Tract 5109, Santa Clara County, California  P1_001N 060855109001 06085510900     360      8               81    1653 0.04900181       5404 0.014988897   754  1847      25     170        44         0         0      0      0        31        16        39        27        42        61       144        37        19        48         0         0        29        12        12     133         0         0         158          72           0
3  060014351032020      Block 2020, Block Group 2, Census Tract 4351.03, Alameda County, California  P1_001N 060014351032 06001435103     820     17                0    1829 0.00000000       7726 0.000000000   570  1774      15      14        27         0        87     31      9        79        15        21        46        32        14        57       140        48       160         0        16        26         0        35      23         0        36          37          68           0
4  060014305003017         Block 3017, Block Group 3, Census Tract 4305, Alameda County, California  P1_001N 060014305003 06001430500     853     17              116    1825 0.06356164       6289 0.018444904   496  1320      38       0         5        70         0     24      0         0        50        43        93        48        38        41        61        15        52         2         0        19        25         0       0         0        36          73          31           0
5  060014506071030      Block 1030, Block Group 1, Census Tract 4506.07, Alameda County, California  P1_001N 060014506071 06001450607     739     15                0    2435 0.00000000       6054 0.000000000   747  1810     112     131        47        28        21      0     18         0        14        61       111       103        34       107        24         0        41        16         0        13        10         0       0        13        50          64          13           1
6  060014507451018      Block 1018, Block Group 1, Census Tract 4507.45, Alameda County, California  P1_001N 060014507451 06001450745     743     15              140    3052 0.04587156       6374 0.021964230  1036  3344      83     200       145        71         0     34      0        32        35        20       219       208        95       211       112        31        15        23         0         0        11         0       0        82       154         218          88         122
7  060014507421002      Block 1002, Block Group 1, Census Tract 4507.42, Alameda County, California  P1_001N 060014507421 06001450742     745     15               36    1746 0.02061856       5439 0.006618864   659  1522      29      43        41        18        18      0     18        25        28       130        23        23        74       122        63         0        53        10         0        14         0        33      10        20        29          20          18          11
8  060014278001003         Block 1003, Block Group 1, Census Tract 4278, Alameda County, California  P1_001N 060014278001 06001427800     959     18                0     731 0.00000000       4827 0.000000000   241   557      17       8         0         0         0      0      7        23        41        47        19        42         0         0         0         0         0         0         0         0         9         0       0        45         7           0           0          23
9  060014006001007         Block 1007, Block Group 1, Census Tract 4006, Alameda County, California  P1_001N 060014006001 06001400600    1000     19               40    1076 0.03717472       1788 0.022371365   454  1140      64      16        22        17         0     10      0        10        42        93        48        45        60        16        29        14         7         0        25         5         0         0       0        18        27          10           0           7
10 060014075001003         Block 1003, Block Group 1, Census Tract 4075, Alameda County, California  P1_001N 060014075001 06001407500     903     18                0     998 0.00000000       4383 0.000000000   123   352      45       0         0         0         0      0      0        28         0        15         0         0        15         0         9         0         5        13         0        33         6         7       5         0        24           0           0           0
11 060133551091008 Block 1008, Block Group 1, Census Tract 3551.09, Contra Costa County, California  P1_001N 060133551091 06013355109    1186     24               53    1374 0.03857351       7167 0.007395005   351  1448       0       0       129       107         0      0      0         0       192        71        51        27        11        59        32        12        11         0         0         0        13         9       0         0       128         135           0           0
   female20 female21 female22_24 female25_29 female30_34 female35_39 female40_44 female45_49 female50_54 female55_59 female60_61 female62_64 female65_66 female67_69 female70_74 female75_79 female80_84 female85p own1 own2 own3 own4 own5 own6 own7p rent1 rent2 rent3 rent4 rent5 rent6 rent7p white_nonh black_nonh asian_nonh total_nonh total_hisp unit1d unit1a unit2 unit3_4 unit5_9 unit10_19 unit20_49 unit50p mobile boat_RV_Van employed armedforces hhinc000_010 hhinc010_015 hhinc015_020
1         0        0          14          76          38          74          11          33           0          23           0           0          36           0           0           0           0         0    8   12    0   11    0    0     0   175   167    67     0     0     0      0        252         52        152        537        294    131      0    33       0      15        20        51     298      0           0      535           0           33            0           51
2         0        0          21          19          34          68          88          21          52         112          18          34          13          13          14           9         113        99   75  303   30  119    0    0     0   118    41     0    21    47     0      0       1016          0        640       1803         44    617    187     0      21      31         0         0       0      0           0      821           0            0            0            0
3        30        0          11         112          34          14          13          34         220          78           0          86           0          15           0           0          65        26   86  158   89  176   61    0     0     0     0     0     0     0     0      0        698        113        528       1639        135    507     40     0      15       0         0         0       0      8           0      961           0           16            0            0
4         0       59           5          51          74           0          67          58          31          73          15           6           0          44          47           0          26         0   26  161   48    2    0   29     0    45   122     0    36    27     0      0        340        206        359        953        367    287      0    16     122       0        23         0      32     16           0      758           0           45            0            0
5         0        0          61           0         219           8          72         118         130          42          70           9           0           0          10           0           0        39   26   88   78  163   30    0     0   221   100    18    14     9     0      0        624         89        926       1683        127    357     83     9       0      18       236       219      30      0          16     1121           0            9            0           32
6         0       51           0          38          83         199         301         183          77          15          55           0          22          15          51          29           6        10   10  210  141  284   16   13     0    40    69    87   131    35     0      0        734          0       2346       3159        185    539    254     0      66     163         0         0      14      0           0     1416           0           87            0           26
7         0        9          19          72         122          20          32          69          24         124          19          54           0          31           7          17          14        16  117   81   28   84   41    0     0    64   216     9    19     0     0      0        778         10        394       1382        140    167    248    10     156      38        16        24       0      0           0      976           0            0            0            0
8         0        0           0           0          64          55          16          17           0          29          41           0           0          29          11           0           0         7   33   14   16   26   15    0     0    51    86     0     0     0     0      0        188          5        183        429        128    129     47     0      63       0        17         0       0      0           0      337           0            0            0            0
9         0        0           9          54          69         121          81          17          61          17          27          20          12           0          29          15          12        11    7   55   46   11    6    0     0   104   136    55    28     6     0      0        467        420         85       1085         55    208     70    12     126      12        23        14       0      8           0      707           0           20           55            0
10        0        0           0          64          18           0          21           0           0          37          25           0           0           5           0          38           0        10   42   10    0    0    7    0     0     0    46    18     0     0     0      0        165         93          0        276        147     84     18     0       0       0        21        14      17      0           0      139           0            0            0           20
11        0        0          58          40          82           0          73          10         146          26          10           0           0          12          41          13          13        39   26   61   38   27    0    0    65    48    20     0     0    47     0     19        519        552        212       1283        267    421      0     0       0       0         0         0       0      0           0      658           0            0           32            0
   hhinc020_025 hhinc025_030 hhinc030_035 hhinc035_040 hhinc040_045 hhinc045_050 hhinc050_060 hhinc060_075 hhinc075_100 hhinc100_125 hhinc125_150 hhinc150_200 hhinc200p occ_m_manage occ_m_prof_biz occ_m_prof_comp occ_m_svc_comm occ_m_prof_leg occ_m_prof_edu occ_m_svc_ent occ_m_prof_heal occ_m_svc_heal occ_m_svc_fire occ_m_svc_law occ_m_ret_eat occ_m_man_build occ_m_svc_pers occ_m_ret_sales occ_m_svc_off occ_m_man_nat occ_m_man_prod occ_f_manage occ_f_prof_biz occ_f_prof_comp occ_f_svc_comm
1             0            0            0           15           11            0           11           30           20           12           77           93        87           27             30             131              0             28             12             0               0              0              0             0            16               0              0              36             9            28             30           41             36               7              0
2            36            0            0           19           16            0           33           11           40           48          106          181       264           39             17             103              0              0             12            51              21              0              0             0             0               0              0              49            20           119             27           81             34              21              0
3             0            0            0            0            0            0            0           29           42           53           32          103       295           70             23              78              0              0             19             0              19              0              0            15             0               0             45               0            40           124             60           36              9              48              0
4             0            5           14            0            0           23           96            6            0          122          119            0        66           20             30              24              0              0              0             0              61              0              0             0             0               0             39              49            29            68            136            0             16              36              0
5            10            0           26           23            0           15           62           44          122            0           17           65       322          119             36             141             13              0             17             0               8              0              0             0             0              11              0             103            13            20             14          121             35             153              0
6             0            0           28            0            0            0           14            0          120           29           23          154       555          227             47             365              0              0             30             0              79              0             15            23            18               0              0              10             0            16             41          166             81              25              0
7             0            5           17            0            0            6           27           67          126           54           38          132       187           88             46             153              0              0              0             0               0              0              0             0             0               0              0              43            80            16             67           69            118              28             11
8            70            0            0            9            0            0            0            0            0           47            0           53        62           21              0              87              0              0              0             0               0              0              0             0             0               0              0               0            19             0             22            0             17              27              0
9             0            0           19            7            0           15           11           11           30           37           86           53       110           26              0              40              0              6              6            30               7             17              0             0            29              14              0               5             5            34             88           96             30              20             20
10            0           22            0            0            0            0           21           10           15            0            7            0        28            0              0              10              0              0              0             0               0              0              0             0             0              15              0               0             0             0              0           28              0               0              0
11            0            0           13            0            0            0            0          113           26           36           39           11        81           64              0              63             15              0              0             0               0              0             53             0            11              87              0               0            27            39             71            0              0               0              0
   occ_f_prof_leg occ_f_prof_edu occ_f_svc_ent occ_f_prof_heal occ_f_svc_heal occ_f_svc_fire occ_f_svc_law occ_f_ret_eat occ_f_man_build occ_f_svc_pers occ_f_ret_sales occ_f_svc_off occ_f_man_nat occ_f_man_prod hhwrks0 hhwrks1 hhwrks2 hhwrks3p ownkidsyes rentkidsyes ownkidsno rentkidsno gq_inst_m_0017 gq_noninst_m_0017_univ gq_noninst_m_0017_mil gq_noninst_m_0017_oth gq_inst_m_1864 gq_noninst_m_1864_univ gq_noninst_m_1864_mil gq_noninst_m_1864_oth gq_inst_m_65p gq_noninst_m_65p_univ
1               0             33            17              40              0              0             0             0              14              0               0             0             0              0     237     567     343      246        184         404       176        629              0                      0                     0                     0              0                      0                     0                   159             0                     0
2              45              0            30              28              0              0             0             0               0             68              37             0             0             19     547     709     682      131        344         231       901        593              0                      0                     0                     0              0                      0                     0                     0             0                     0
3               0            111             0              59              0              0             0             0               0             20              22           125            24             14     410     526    1232      293        900          41      1448         72              0                      0                     0                     3              0                      0                     0                     4             8                     0
4               0             78             0              16             27              0             0             0               0              0              92            37             0              0     493     657     732      223        301         281       894        629              9                      0                     0                     0            112                      0                     0                    12            27                     0
5               0             31             0              36             97              0             0            16               0              0              14           123             0              0     530     808     810      154        445         196       405       1256              0                      0                     0                    13              0                      0                     0                   161             0                     0
6               0            106             0              48              0              0             0             0               0             15               8            72             0             24     474     658    1009      114        673         223       996        363              0                      0                     0                     0              0                      0                     0                     0             0                     0
7               0             38            54              11              0              0             0            17               0              7              36            75             8             11     494     836     679      104        552         128      1101        332              0                      0                     0                     0              0                      0                     0                     0             0                     0
8               5              0             9              65              0              0             0            23               0              0              20             0             0             22     324     810     553       91        311         174       478        815              0                      0                     0                     0              0                      0                     0                     0             0                     0
9              26             19            35              54             12              0             0             0               0             38              18            32             0              0      89     274     356       49        103          96       207        362              0                      0                     0                     2              0                      0                     0                    14             0                     0
10              0              0             0               0              0              0             0             0               0              0               0            70             0             16     374     543     341       34        151         403       262        476              0                      0                     0                     2             26                      0                     0                    24            26                     0
11              0             70            10              29             20              0             0             0               0              0               0            50             0             49     545     596     568      283        461         227       898        406              0                      0                     0                     1              6                      0                     0                     1            23                     0
   gq_noninst_m_65p_mil gq_noninst_m_65p_oth gq_inst_f_0017 gq_noninst_f_0017_univ gq_noninst_f_0017_mil gq_noninst_f_0017_oth gq_inst_f_1864 gq_noninst_f_1864_univ gq_noninst_f_1864_mil gq_noninst_f_1864_oth gq_inst_f_65p gq_noninst_f_65p_univ gq_noninst_f_65p_mil gq_noninst_f_65p_oth
1                     0                   17              0                      0                     0                     0              0                      0                     0                    52             0                     0                    0                    3
2                     0                    0              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0                    0
3                     0                    4              0                      0                     0                     1              0                      0                     0                     5            14                     0                    0                    0
4                     0                    2              7                      0                     0                     0             43                      0                     0                     1             9                     0                    0                    3
5                     0                   24              0                      0                     0                    12              0                      0                     0                    85             0                     0                    0                   61
6                     0                    0              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0                    0
7                     0                    0              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0                    0
8                     0                    0              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0                    0
9                     0                    0              0                      0                     0                     1              0                      0                     0                     2             0                     0                    0                    0
10                    0                    2              0                      0                     0                     4              9                      0                     0                     9            20                     0                    0                    0
11                    0                    0              0                      0                     0                     0              8                      0                     0                     0            55                     0                    0                    0
 [ reached 'max' / getOption("max.print") -- omitted 82198 rows ]
[1] "workingdata (82209 rows):"
            GEOID                                                                         NAME variable   blockgroup       tract TAZ1454 SUPERD block_POPULATION BGTotal    sharebg TractTotal  sharetract tothh hhpop male0_4 male5_9 male10_14 male15_17 male18_19 male20 male21 male22_24 male25_29 male30_34 male35_39 male40_44 male45_49 male50_54 male55_59 male60_61 male62_64 male65_66 male67_69 male70_74 male75_79 male80_84 male85p female0_4 female5_9 female10_14 female15_17 female18_19 female20
1 060855017001008 Block 1008, Block Group 1, Census Tract 5017, Santa Clara County, California  P1_001N 060855017001 06085501700     560     11                0    1101 0.00000000       5155 0.000000000   440   831      50       0         0         0         0      0      0         9       109        67        55        70        32        15        17         0         0         0        12         0         0         0       0        42         0          48           0           0        0
2 060855109001003 Block 1003, Block Group 1, Census Tract 5109, Santa Clara County, California  P1_001N 060855109001 06085510900     360      8               81    1653 0.04900181       5404 0.014988897   754  1847      25     170        44         0         0      0      0        31        16        39        27        42        61       144        37        19        48         0         0        29        12        12     133         0         0         158          72           0        0
3 060014351032020  Block 2020, Block Group 2, Census Tract 4351.03, Alameda County, California  P1_001N 060014351032 06001435103     820     17                0    1829 0.00000000       7726 0.000000000   570  1774      15      14        27         0        87     31      9        79        15        21        46        32        14        57       140        48       160         0        16        26         0        35      23         0        36          37          68           0       30
4 060014305003017     Block 3017, Block Group 3, Census Tract 4305, Alameda County, California  P1_001N 060014305003 06001430500     853     17              116    1825 0.06356164       6289 0.018444904   496  1320      38       0         5        70         0     24      0         0        50        43        93        48        38        41        61        15        52         2         0        19        25         0       0         0        36          73          31           0        0
5 060014506071030  Block 1030, Block Group 1, Census Tract 4506.07, Alameda County, California  P1_001N 060014506071 06001450607     739     15                0    2435 0.00000000       6054 0.000000000   747  1810     112     131        47        28        21      0     18         0        14        61       111       103        34       107        24         0        41        16         0        13        10         0       0        13        50          64          13           1        0
6 060014507451018  Block 1018, Block Group 1, Census Tract 4507.45, Alameda County, California  P1_001N 060014507451 06001450745     743     15              140    3052 0.04587156       6374 0.021964230  1036  3344      83     200       145        71         0     34      0        32        35        20       219       208        95       211       112        31        15        23         0         0        11         0       0        82       154         218          88         122        0
7 060014507421002  Block 1002, Block Group 1, Census Tract 4507.42, Alameda County, California  P1_001N 060014507421 06001450742     745     15               36    1746 0.02061856       5439 0.006618864   659  1522      29      43        41        18        18      0     18        25        28       130        23        23        74       122        63         0        53        10         0        14         0        33      10        20        29          20          18          11        0
8 060014278001003     Block 1003, Block Group 1, Census Tract 4278, Alameda County, California  P1_001N 060014278001 06001427800     959     18                0     731 0.00000000       4827 0.000000000   241   557      17       8         0         0         0      0      7        23        41        47        19        42         0         0         0         0         0         0         0         0         9         0       0        45         7           0           0          23        0
9 060014006001007     Block 1007, Block Group 1, Census Tract 4006, Alameda County, California  P1_001N 060014006001 06001400600    1000     19               40    1076 0.03717472       1788 0.022371365   454  1140      64      16        22        17         0     10      0        10        42        93        48        45        60        16        29        14         7         0        25         5         0         0       0        18        27          10           0           7        0
  female21 female22_24 female25_29 female30_34 female35_39 female40_44 female45_49 female50_54 female55_59 female60_61 female62_64 female65_66 female67_69 female70_74 female75_79 female80_84 female85p own1 own2 own3 own4 own5 own6 own7p rent1 rent2 rent3 rent4 rent5 rent6 rent7p white_nonh black_nonh asian_nonh total_nonh total_hisp unit1d unit1a unit2 unit3_4 unit5_9 unit10_19 unit20_49 unit50p mobile boat_RV_Van employed armedforces hhinc000_010 hhinc010_015 hhinc015_020 hhinc020_025
1        0          14          76          38          74          11          33           0          23           0           0          36           0           0           0           0         0    8   12    0   11    0    0     0   175   167    67     0     0     0      0    0.00000  0.0000000   0.000000        537        294    131      0    33       0      15        20        51     298      0           0      535           0           33            0           51            0
2        0          21          19          34          68          88          21          52         112          18          34          13          13          14           9         113        99   75  303   30  119    0    0     0   118    41     0    21    47     0      0   49.78584  0.0000000  31.361162       1803         44    617    187     0      21      31         0         0       0      0           0      821           0            0            0            0           36
3        0          11         112          34          14          13          34         220          78           0          86           0          15           0           0          65        26   86  158   89  176   61    0     0     0     0     0     0     0     0      0    0.00000  0.0000000   0.000000       1639        135    507     40     0      15       0         0         0       0      8           0      961           0           16            0            0            0
4       59           5          51          74           0          67          58          31          73          15           6           0          44          47           0          26         0   26  161   48    2    0   29     0    45   122     0    36    27     0      0   21.61096 13.0936986  22.818630        953        367    287      0    16     122       0        23         0      32     16           0      758           0           45            0            0            0
5        0          61           0         219           8          72         118         130          42          70           9           0           0          10           0           0        39   26   88   78  163   30    0     0   221   100    18    14     9     0      0    0.00000  0.0000000   0.000000       1683        127    357     83     9       0      18       236       219      30      0          16     1121           0            9            0           32           10
6       51           0          38          83         199         301         183          77          15          55           0          22          15          51          29           6        10   10  210  141  284   16   13     0    40    69    87   131    35     0      0   33.66972  0.0000000 107.614679       3159        185    539    254     0      66     163         0         0      14      0           0     1416           0           87            0           26            0
7        9          19          72         122          20          32          69          24         124          19          54           0          31           7          17          14        16  117   81   28   84   41    0     0    64   216     9    19     0     0      0   16.04124  0.2061856   8.123711       1382        140    167    248    10     156      38        16        24       0      0           0      976           0            0            0            0            0
8        0           0           0          64          55          16          17           0          29          41           0           0          29          11           0           0         7   33   14   16   26   15    0     0    51    86     0     0     0     0      0    0.00000  0.0000000   0.000000        429        128    129     47     0      63       0        17         0       0      0           0      337           0            0            0            0           70
9        0           9          54          69         121          81          17          61          17          27          20          12           0          29          15          12        11    7   55   46   11    6    0     0   104   136    55    28     6     0      0   17.36059 15.6133829   3.159851       1085         55    208     70    12     126      12        23        14       0      8           0      707           0           20           55            0            0
  hhinc025_030 hhinc030_035 hhinc035_040 hhinc040_045 hhinc045_050 hhinc050_060 hhinc060_075 hhinc075_100 hhinc100_125 hhinc125_150 hhinc150_200 hhinc200p occ_m_manage occ_m_prof_biz occ_m_prof_comp occ_m_svc_comm occ_m_prof_leg occ_m_prof_edu occ_m_svc_ent occ_m_prof_heal occ_m_svc_heal occ_m_svc_fire occ_m_svc_law occ_m_ret_eat occ_m_man_build occ_m_svc_pers occ_m_ret_sales occ_m_svc_off occ_m_man_nat occ_m_man_prod occ_f_manage occ_f_prof_biz occ_f_prof_comp occ_f_svc_comm occ_f_prof_leg
1            0            0           15           11            0           11           30           20           12           77           93        87           27             30             131              0             28             12             0               0              0              0             0            16               0              0              36             9            28             30           41             36               7              0              0
2            0            0           19           16            0           33           11           40           48          106          181       264           39             17             103              0              0             12            51              21              0              0             0             0               0              0              49            20           119             27           81             34              21              0             45
3            0            0            0            0            0            0           29           42           53           32          103       295           70             23              78              0              0             19             0              19              0              0            15             0               0             45               0            40           124             60           36              9              48              0              0
4            5           14            0            0           23           96            6            0          122          119            0        66           20             30              24              0              0              0             0              61              0              0             0             0               0             39              49            29            68            136            0             16              36              0              0
5            0           26           23            0           15           62           44          122            0           17           65       322          119             36             141             13              0             17             0               8              0              0             0             0              11              0             103            13            20             14          121             35             153              0              0
6            0           28            0            0            0           14            0          120           29           23          154       555          227             47             365              0              0             30             0              79              0             15            23            18               0              0              10             0            16             41          166             81              25              0              0
7            5           17            0            0            6           27           67          126           54           38          132       187           88             46             153              0              0              0             0               0              0              0             0             0               0              0              43            80            16             67           69            118              28             11              0
8            0            0            9            0            0            0            0            0           47            0           53        62           21              0              87              0              0              0             0               0              0              0             0             0               0              0               0            19             0             22            0             17              27              0              5
9            0           19            7            0           15           11           11           30           37           86           53       110           26              0              40              0              6              6            30               7             17              0             0            29              14              0               5             5            34             88           96             30              20             20             26
  occ_f_prof_edu occ_f_svc_ent occ_f_prof_heal occ_f_svc_heal occ_f_svc_fire occ_f_svc_law occ_f_ret_eat occ_f_man_build occ_f_svc_pers occ_f_ret_sales occ_f_svc_off occ_f_man_nat occ_f_man_prod hhwrks0 hhwrks1 hhwrks2 hhwrks3p ownkidsyes rentkidsyes ownkidsno rentkidsno gq_inst_m_0017 gq_noninst_m_0017_univ gq_noninst_m_0017_mil gq_noninst_m_0017_oth gq_inst_m_1864 gq_noninst_m_1864_univ gq_noninst_m_1864_mil gq_noninst_m_1864_oth gq_inst_m_65p gq_noninst_m_65p_univ gq_noninst_m_65p_mil
1             33            17              40              0              0             0             0              14              0               0             0             0              0     237     567     343      246        184         404       176        629              0                      0                     0                     0              0                      0                     0                   159             0                     0                    0
2              0            30              28              0              0             0             0               0             68              37             0             0             19     547     709     682      131        344         231       901        593              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0
3            111             0              59              0              0             0             0               0             20              22           125            24             14     410     526    1232      293        900          41      1448         72              0                      0                     0                     3              0                      0                     0                     4             8                     0                    0
4             78             0              16             27              0             0             0               0              0              92            37             0              0     493     657     732      223        301         281       894        629              9                      0                     0                     0            112                      0                     0                    12            27                     0                    0
5             31             0              36             97              0             0            16               0              0              14           123             0              0     530     808     810      154        445         196       405       1256              0                      0                     0                    13              0                      0                     0                   161             0                     0                    0
6            106             0              48              0              0             0             0               0             15               8            72             0             24     474     658    1009      114        673         223       996        363              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0
7             38            54              11              0              0             0            17               0              7              36            75             8             11     494     836     679      104        552         128      1101        332              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0
8              0             9              65              0              0             0            23               0              0              20             0             0             22     324     810     553       91        311         174       478        815              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0
9             19            35              54             12              0             0             0               0             38              18            32             0              0      89     274     356       49        103          96       207        362              0                      0                     0                     2              0                      0                     0                    14             0                     0                    0
  gq_noninst_m_65p_oth gq_inst_f_0017 gq_noninst_f_0017_univ gq_noninst_f_0017_mil gq_noninst_f_0017_oth gq_inst_f_1864 gq_noninst_f_1864_univ gq_noninst_f_1864_mil gq_noninst_f_1864_oth gq_inst_f_65p gq_noninst_f_65p_univ gq_noninst_f_65p_mil gq_noninst_f_65p_oth    TOTHH     HHPOP   EMPRES  AGE0004   AGE0519  AGE2044   AGE4564    AGE65P    AGE62P other_nonh  hispanic      SFDU      MFDU    hh_own   hh_rent hh_size_1 hh_size_2  hh_size_3 hh_size_4_plus hh_wrks_0 hh_wrks_1 hh_wrks_2
1                   17              0                      0                     0                     0              0                      0                     0                    52             0                     0                    0                    3  0.00000   0.00000  0.00000 0.000000  0.000000  0.00000  0.000000  0.000000  0.000000    0.00000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.0000000       0.000000  0.000000  0.000000  0.000000
2                    0              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0                    0 36.94737  90.50635 40.23049 1.225045 21.756806 18.86570 26.754991 21.903811 25.921960   84.37392  2.156080 39.397459  2.548094 25.823956 11.123412  9.457350 16.856624  1.4700544       9.163339  8.198927 10.627128 10.222428
3                    4              0                      0                     0                     1              0                      0                     0                     5            14                     0                    0                    0  0.00000   0.00000  0.00000 0.000000  0.000000  0.00000  0.000000  0.000000  0.000000    0.00000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.0000000       0.000000  0.000000  0.000000  0.000000
4                    2              7                      0                     0                     0             43                      0                     0                     1             9                     0                    0                    3 31.52658  83.90137 48.17973 2.415342 13.665753 32.67068 24.789041 10.360548 14.047123   56.91797 23.327123 19.259178 12.267397 16.907397 14.619178  4.512877 17.987945  3.0509589       5.974795  9.093338 12.118302 13.501670
5                   24              0                      0                     0                    12              0                      0                     0                    85             0                     0                    0                   61  0.00000   0.00000  0.00000 0.000000  0.000000  0.00000  0.000000  0.000000  0.000000    0.00000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.0000000       0.000000  0.000000  0.000000  0.000000
6                    0              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0                    0 47.52294 153.39450 64.95413 7.568807 45.779817 55.96330 36.422018  7.660550  8.348624  138.42732  8.486239 36.376147 11.146789 30.917431 16.605505  2.293578 12.798165 10.4587156      21.972477 10.411045 14.452463 22.161908
7                    0              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0                    0 13.58763  31.38144 20.12371 1.010309  4.082474 10.74227 12.412371  3.134021  5.340206   27.99235  2.886598  8.556701  5.030928  7.237113  6.350515  3.731959  6.123711  0.7628866       2.969072  3.269719  5.533370  4.494208
8                    0              0                      0                     0                     0              0                      0                     0                     0             0                     0                    0                    0  0.00000   0.00000  0.00000 0.000000  0.000000  0.00000  0.000000  0.000000  0.000000    0.00000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.000000  0.0000000       0.000000  0.000000  0.000000  0.000000
9                    0              0                      0                     0                     1              0                      0                     0                     2             0                     0                    0                    0 16.87732  42.37918 26.28253 3.048327  3.680297 21.63569  9.962825  4.052045  5.055762   38.99131  2.044610 10.631970  6.951673  4.646840 12.230483  4.126394  7.100372  3.7546468       1.895911  1.991051  6.129754  7.964206
  hh_wrks_3_plus hh_kids_yes hh_kids_no pers_occ_management pers_occ_professional pers_occ_services pers_occ_retail pers_occ_manual pers_occ_military  gq_inst gq_type_univ gq_type_mil gq_type_othnon
1      0.0000000    0.000000   0.000000            0.000000              0.000000          0.000000        0.000000        0.000000                 0 0.000000            0           0      0.0000000
2      1.9635455    8.618616  22.393412            5.880218             13.769510          8.281307        4.214156        8.085299                 0 0.000000            0           0      0.0000000
3      0.0000000    0.000000   0.000000            0.000000              0.000000          0.000000        0.000000        0.000000                 0 0.000000            0           0      0.0000000
4      4.1132135   10.734934  28.091588            1.271233             16.589589          8.390137        8.962192       12.966575                 0 3.818095            0           0      0.3320083
5      0.0000000    0.000000   0.000000            0.000000              0.000000          0.000000        0.000000        0.000000                 0 0.000000            0           0      0.0000000
6      2.5039222   19.679950  29.849388           18.027523             35.825688          5.733945        1.651376        3.715596                 0 0.000000            0           0      0.0000000
7      0.6883618    4.500827   9.484832            3.237113              8.123711          4.680412        1.979381        2.103093                 0 0.000000            0           0      0.0000000
8      0.0000000    0.000000   0.000000            0.000000              0.000000          0.000000        0.000000        0.000000                 0 0.000000            0           0      0.0000000
9      1.0961969    4.451902  12.729306            4.535316              7.732342          7.026022        1.933086        5.055762                 0 0.000000            0           0      0.4250559
 [ reached 'max' / getOption("max.print") -- omitted 82200 rows ]
[1] "Initial workingdata_hhinc (82209 rows):"
# A tibble: 82,209 × 22
   GEOID           blockgroup   tract       TractTotal TAZ1454 sharebg hhinc000_010 hhinc010_015 hhinc015_020 hhinc020_025 hhinc025_030 hhinc030_035 hhinc035_040 hhinc040_045 hhinc045_050 hhinc050_060 hhinc060_075 hhinc075_100 hhinc100_125 hhinc125_150 hhinc150_200 hhinc200p
   <chr>           <chr>        <chr>            <int>   <int>   <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>     <dbl>
 1 060855017001008 060855017001 06085501700       5155     560  0                33            0           51            0            0            0           15           11            0           11           30           20           12           77           93        87
 2 060855109001003 060855109001 06085510900       5404     360  0.0490            0            0            0           36            0            0           19           16            0           33           11           40           48          106          181       264
 3 060014351032020 060014351032 06001435103       7726     820  0                16            0            0            0            0            0            0            0            0            0           29           42           53           32          103       295
 4 060014305003017 060014305003 06001430500       6289     853  0.0636           45            0            0            0            5           14            0            0           23           96            6            0          122          119            0        66
 5 060014506071030 060014506071 06001450607       6054     739  0                 9            0           32           10            0           26           23            0           15           62           44          122            0           17           65       322
 6 060014507451018 060014507451 06001450745       6374     743  0.0459           87            0           26            0            0           28            0            0            0           14            0          120           29           23          154       555
 7 060014507421002 060014507421 06001450742       5439     745  0.0206            0            0            0            0            5           17            0            0            6           27           67          126           54           38          132       187
 8 060014278001003 060014278001 06001427800       4827     959  0                 0            0            0           70            0            0            9            0            0            0            0            0           47            0           53        62
 9 060014006001007 060014006001 06001400600       1788    1000  0.0372           20           55            0            0            0           19            7            0           15           11           11           30           37           86           53       110
10 060014075001003 060014075001 06001407500       4383     903  0                 0            0           20            0           22            0            0            0            0           21           10           15            0            7            0        28
11 060133551091008 060133551091 06013355109       7167    1186  0.0386            0           32            0            0            0           13            0            0            0            0          113           26           36           39           11        81
12 060133680013009 060133680013 06013368001       5467    1067  0.0743           53            0           33           15            0           31            0            0            0           37            0           72           31           17           47        29
13 060133040072005 060133040072 06013304007       4706    1179  0.0793           16            0            0           88            0            0            0            0            0            0           11            0           53           62           91       151
14 060855078083002 060855078083 06085507808       5674     492  0.0688           11            9            0            0            0            0            0            0            0           10           32           46           11           10           47       375
15 060952529092014 060952529092 06095252909       4421    1278  0.0417            0            0            0            0           10           15            0            0           28           25           42          136          118           57          244       244
16 060952527026124 060952527026 06095252702       7039    1251  0                 2            0            0            0            0            0            0           12            0           43           15           52           87           52           65        85
17 060952535013017 060952535013 06095253501       6327    1290  0                 0           45            0            0            0            0          124           23            0            0          100            0           27            0           20         0
18 060014079001005 060014079001 06001407900       3081     907  0.201            11            0            0            0            0           14            0            0            0           11           25           34          155            9           73        49
19 060014219004016 060014219004 06001421900       3901    1025  0                35           22            0            8            7            0            0            0            0            0            8           39           34           11           60       145
20 060014277004001 060014277004 06001427700       5016     963  0.164            27           83            0            0            0            0            0            0            0            0           28           37           18           42            0       134
# ℹ 82,189 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "After pivoting hhinc categories to rows, workingdata_hhinc (1315344 rows):"
# A tibble: 1,315,344 × 8
   GEOID           blockgroup   tract       TractTotal TAZ1454 sharebg householdinc_acs_cat num_households
   <chr>           <chr>        <chr>            <int>   <int>   <dbl> <chr>                         <dbl>
 1 060855017001008 060855017001 06085501700       5155     560       0 hhinc000_010                     33
 2 060855017001008 060855017001 06085501700       5155     560       0 hhinc010_015                      0
 3 060855017001008 060855017001 06085501700       5155     560       0 hhinc015_020                     51
 4 060855017001008 060855017001 06085501700       5155     560       0 hhinc020_025                      0
 5 060855017001008 060855017001 06085501700       5155     560       0 hhinc025_030                      0
 6 060855017001008 060855017001 06085501700       5155     560       0 hhinc030_035                      0
 7 060855017001008 060855017001 06085501700       5155     560       0 hhinc035_040                     15
 8 060855017001008 060855017001 06085501700       5155     560       0 hhinc040_045                     11
 9 060855017001008 060855017001 06085501700       5155     560       0 hhinc045_050                      0
10 060855017001008 060855017001 06085501700       5155     560       0 hhinc050_060                     11
# ℹ 1,315,334 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "########################## map_ACS5year_household_income_to_TM1_categories(2022) start ##########################"
[1] "Loaded 159558 rows fromM:/Data/Census/PUMS/PUMS 2018-22/hbayarea1822.Rdata"
[1] "head(PUMS_hhbayarea, n=10)"
   NP  HINCP  ADJINC WGTP householdinc_202xdollars householdinc_2000dollars householdinc_acs_cat householdinc_TM1_cat
1   2 266500 1184371   19               315634.872               174383.907            hhinc200p              HHINCQ4
2   4 105000 1184371   12               124358.955                68706.605         hhinc100_125              HHINCQ3
3   2 564700 1184371   11               668814.304               369510.665            hhinc200p              HHINCQ4
4   1  29300 1184371   13                34702.070                19172.415         hhinc030_035              HHINCQ1
5   2 272000 1184371   13               322148.912               177982.824            hhinc200p              HHINCQ4
6   2  81700 1184371   12                96763.111                53460.282         hhinc075_100              HHINCQ2
7   3  89700 1184371   11               106238.079                58695.071         hhinc100_125              HHINCQ2
8   3 426000 1184371   13               504542.046               278752.512            hhinc200p              HHINCQ4
9   1   4000 1184371   26                 4737.484                 2617.394         hhinc000_010              HHINCQ1
10  1  38100 1184371   15                45124.535                24930.682         hhinc045_050              HHINCQ1
[1] "PUMS_hhinc_cat:"
# A tibble: 19 × 3
   householdinc_acs_cat householdinc_TM1_cat   WGTP
   <chr>                <chr>                 <int>
 1 hhinc000_010         HHINCQ1               94331
 2 hhinc010_015         HHINCQ1               70541
 3 hhinc015_020         HHINCQ1               51181
 4 hhinc020_025         HHINCQ1               55622
 5 hhinc025_030         HHINCQ1               58396
 6 hhinc030_035         HHINCQ1               56382
 7 hhinc035_040         HHINCQ1               53979
 8 hhinc040_045         HHINCQ1               56911
 9 hhinc045_050         HHINCQ1               54994
10 hhinc050_060         HHINCQ1               46973
11 hhinc050_060         HHINCQ2               65662
12 hhinc060_075         HHINCQ2              166088
13 hhinc075_100         HHINCQ2              274495
14 hhinc100_125         HHINCQ2               87597
15 hhinc100_125         HHINCQ3              158253
16 hhinc125_150         HHINCQ3              210678
17 hhinc150_200         HHINCQ3              228327
18 hhinc150_200         HHINCQ4              114376
19 hhinc200p            HHINCQ4              861092
[1] "PUMS_hhinc_cat:"
# A tibble: 16 × 6
   householdinc_acs_cat HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4 TOT_WGTP
   <chr>                  <dbl>   <dbl>   <dbl>   <dbl>    <int>
 1 hhinc000_010           1       0       0       0        94331
 2 hhinc010_015           1       0       0       0        70541
 3 hhinc015_020           1       0       0       0        51181
 4 hhinc020_025           1       0       0       0        55622
 5 hhinc025_030           1       0       0       0        58396
 6 hhinc030_035           1       0       0       0        56382
 7 hhinc035_040           1       0       0       0        53979
 8 hhinc040_045           1       0       0       0        56911
 9 hhinc045_050           1       0       0       0        54994
10 hhinc050_060           0.417   0.583   0       0       112635
11 hhinc060_075           0       1       0       0       166088
12 hhinc075_100           0       1       0       0       274495
13 hhinc100_125           0       0.356   0.644   0       245850
14 hhinc125_150           0       0       1       0       210678
15 hhinc150_200           0       0       0.666   0.334   342703
16 hhinc200p              0       0       0       1       861092
[1] "PUMS_hhinc_cat:"
# A tibble: 19 × 3
   householdinc_acs_cat HHINCQ  acs_to_hhincq_share
   <chr>                <chr>                 <dbl>
 1 hhinc000_010         HHINCQ1               1    
 2 hhinc010_015         HHINCQ1               1    
 3 hhinc015_020         HHINCQ1               1    
 4 hhinc020_025         HHINCQ1               1    
 5 hhinc025_030         HHINCQ1               1    
 6 hhinc030_035         HHINCQ1               1    
 7 hhinc035_040         HHINCQ1               1    
 8 hhinc040_045         HHINCQ1               1    
 9 hhinc045_050         HHINCQ1               1    
10 hhinc050_060         HHINCQ1               0.417
11 hhinc050_060         HHINCQ2               0.583
12 hhinc060_075         HHINCQ2               1    
13 hhinc075_100         HHINCQ2               1    
14 hhinc100_125         HHINCQ2               0.356
15 hhinc100_125         HHINCQ3               0.644
16 hhinc125_150         HHINCQ3               1    
17 hhinc150_200         HHINCQ3               0.666
18 hhinc150_200         HHINCQ4               0.334
19 hhinc200p            HHINCQ4               1    
[1] "########################## map_ACS5year_household_income_to_TM1_categories(2022) end ##########################"
[1] "After joining with PUMS-based mapping, workingdata_hhinc (1561971 rows):"
# A tibble: 1,561,971 × 10
   GEOID           blockgroup   tract       TractTotal TAZ1454 sharebg householdinc_acs_cat num_households HHINCQ  acs_to_hhincq_share
   <chr>           <chr>        <chr>            <int>   <int>   <dbl> <chr>                         <dbl> <chr>                 <dbl>
 1 060855017001008 060855017001 06085501700       5155     560       0 hhinc000_010                      0 HHINCQ1               1    
 2 060855017001008 060855017001 06085501700       5155     560       0 hhinc010_015                      0 HHINCQ1               1    
 3 060855017001008 060855017001 06085501700       5155     560       0 hhinc015_020                      0 HHINCQ1               1    
 4 060855017001008 060855017001 06085501700       5155     560       0 hhinc020_025                      0 HHINCQ1               1    
 5 060855017001008 060855017001 06085501700       5155     560       0 hhinc025_030                      0 HHINCQ1               1    
 6 060855017001008 060855017001 06085501700       5155     560       0 hhinc030_035                      0 HHINCQ1               1    
 7 060855017001008 060855017001 06085501700       5155     560       0 hhinc035_040                      0 HHINCQ1               1    
 8 060855017001008 060855017001 06085501700       5155     560       0 hhinc040_045                      0 HHINCQ1               1    
 9 060855017001008 060855017001 06085501700       5155     560       0 hhinc045_050                      0 HHINCQ1               1    
10 060855017001008 060855017001 06085501700       5155     560       0 hhinc050_060                      0 HHINCQ1               0.417
# ℹ 1,561,961 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "Resulting TAZ_hhinc (1454 rows):"
# A tibble: 1,454 × 5
   TAZ1454 HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4
     <int>   <dbl>   <dbl>   <dbl>   <dbl>
 1       1    20.6    8.85    3.74    6.29
 2       2    64.4   27.7    11.7    19.7 
 3       3   148.    42.6    70.3    74.7 
 4       4    61.0   28.2    46.4    37.9 
 5       5   186.    76.8   103.    113.  
 6       6   666.   564.    305.    632.  
 7       7  1937.   677.    419.    177.  
 8       8  3042.   840.    558.     65.4 
 9       9  3171.  1440.    871.    728.  
10      10  1133.   814.    767.   1123.  
# ℹ 1,444 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "tazdata_census (1454 rows):"
# A tibble: 1,454 × 56
   TAZ1454  TOTHH  HHPOP EMPRES AGE0004 AGE0519 AGE2044 AGE4564 AGE65P sum_age   SFDU   MFDU hh_own hh_rent hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus hh_kids_yes hh_kids_no AGE62P gq_inst gq_type_univ gq_type_mil gq_type_othnon  gqpop pers_occ_management pers_occ_professional pers_occ_services pers_occ_retail pers_occ_manual pers_occ_military white_nonh black_nonh asian_nonh other_nonh hispanic HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4 DISTRICT COUNTY
     <int>  <dbl>  <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl>  <dbl>   <dbl>  <dbl>  <dbl>  <dbl>   <dbl>     <dbl>     <dbl>     <dbl>          <dbl>     <dbl>     <dbl>     <dbl>          <dbl>       <dbl>      <dbl>  <dbl>   <dbl>        <dbl>       <dbl>          <dbl>  <dbl>               <dbl>                 <dbl>             <dbl>           <dbl>           <dbl>             <dbl>      <dbl>      <dbl>      <dbl>      <dbl>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>    <int>  <int>
 1       1   39.5   95.1   49.9     0     11.6     15.5    57.6   10.4    95.1   3.63   35.8    0      39.5      7.75      23.0      3.87           4.84      22.3      29.4      10.1           2.92        7.98       56.7   19.4       0         1.52           0           9.04   10.6                 0                    5.33              16.2            19.6            8.71                 0       36.3        0         55.7       81.7     3.15    20.6    8.85    3.74    6.29        1      1
 2       2  124.   298.   156.      0     36.4     48.5   180.    32.6   298.   11.4   112.     0     124.      24.3       72.0     12.1           15.2       69.8      92.1      31.5           9.14       25.0       178.    60.6       0         4.75           0          28.3    33.1                 0                   16.7               50.8            61.4           27.3                  0      114.         0        174.       196.      9.85    64.4   27.7    11.7    19.7         1      1
 3       3  336    551    282       8    108      265     142     40     563     0     387      0     336      188        124       24              0         83.4     110.       37.6          10.9        29.8       212.    54         0         5.67           0          33.8    39.5                31                   94                 94              63              0                    0      184          5        254        371.     12      148.    42.6    70.3    74.7         1      1
 4       4  173.   286.   193.     12.4    9.60   149.     83.3   45.2   300.    4.34  193.    31.6   142.     108.        43.4     13.9            8.05      51.1      67.4      23.0           6.69       18.3       130.    53.3       0         3.47           0          20.7    24.2                26.6                 53.3               35.9            42.4           35                    0      119.        18.0       77.1      217.     52.7     61.0   28.2    46.4    37.9         1      1
 5       5  480.   730.   474.     27.6   21.4    360.    238.   154.    800.    9.66  636.   100.    379.     334.        96.6     31.1           17.9      170.      225.       76.9          22.3        61.0       434.   172.        0        11.6            0          69.1    80.7                59.4                148.                80.1           109.            78                    0      308.        40.0      185.       393.    192.     186.    76.8   103.    113.          1      1
 6       6 2166   3072   2470      14    466     2103     657    273    3513     0    2645    133    2033     1594        459       28             85        268      1490       390            18          95        2071    326         0       375              0           0     375                 331                 1062                541             424            112                    0     1650        163       1062       1753.    443      666.   564.    305.    632.          1      1
 7       7 3209   4466   2391     105    203     2188    1308    711    4515    75    3827     56    3153     2403        617      103             86       1421      1347       410            31         126        3083    947         0        39              0         949     988                 226                  568                728             504            365                    0     1684        372       1282       1509.    867     1937.   677.    419.    177.          1      1
 8       8 4505   8625   3682     427   1207     3093    2662   2220    9609    80    5260     93    4412     2758        696      454            597       2294      1427       533           251         681        3824   2675        21         0              0        2934    2934                  66                  458               1006             804           1348                    0     1679        939       3232       1937.   3052     3042.   840.    558.     65.4         1      1
 9       9 6210.  9769.  5831.    345    787.    4893.   3171.  1255.  10451.   87.3  6941.   144.   6065.    4265.       962.     548.           435       2008.     3013.      980.          209.        587.       5622.  1630.        0       172.             0        1107.   1280.                691.                1909.              1092.            892.          1248.                   0     2979.      1165       3277.      3173.   2333     3171.  1440.    871.    728.          1      1
10      10 3837   6854   4207     421    453     3850    1527    901    7152   205    4321    831    3006     2055       1100      362            320       1152.     1468.      814.          205         536.       3103.  1301         0       327              0         796.   1123.                615                 1811                491             603            687                    0     2059        351       3155       2186.   1225     1133.   814.    767.   1123.          1      1
# ℹ 1,444 more rows
# ℹ 9 more variables: DISTRICT_NAME <chr>, County_Name <chr>, AGREMPN <int>, FPSEMPN <int>, HEREMPN <int>, MWTEMPN <int>, RETEMPN <int>, OTHEMPN <int>, TOTEMP <dbl>
# ℹ Use `print(n = ...)` to see more rows
[1] "DHC GQ population:"
# A tibble: 9 × 6
  County_Name   gq_inst gq_type_univ gq_type_mil gq_type_othnon  gqpop
  <chr>           <dbl>        <dbl>       <dbl>          <dbl>  <dbl>
1 Alameda        10130.       17462.         421         25818. 43701.
2 Contra Costa    4526.        1462.           0          5269.  6730.
3 Marin           5138          628            0          1977.  2605.
4 Napa            2222.         620            0          2336.  2956.
5 San Francisco   4014         6486           68         17324  23878 
6 San Mateo       3382.         900            0          5072.  5972.
7 Santa Clara     8474.       19440            0         11692. 31132.
8 Solano          7833.         823          917          1557.  3297.
9 Sonoma          2359         2873          278          3357.  6508.
[1] "Regional totals --"
[1] "gq_inst       : 48,078"
[1] "gq_type_univ  : 50,694"
[1] "gq_type_mil   : 1,684"
[1] "gq_type_othnon: 74,401"
[1] "gqpop         : 126,779"
[1] "households consistency checks"
# A tibble: 9 × 7
  County_Name     TOTHH sum_tenure sum_size sum_income sum_hhworkers sum_kids
  <chr>           <dbl>      <dbl>    <dbl>      <dbl>         <dbl>    <dbl>
1 Alameda       585724.    585724.  585724.    585724.       585733.  585733.
2 Contra Costa  408605.    408605.  408605.    408605.       408595.  408595.
3 Marin         103752.    103752.  103752.    103752.       103769.  103769.
4 Napa           49312.     49312.   49312.     49312.        49313.   49313.
5 San Francisco 360842     360842   360842     360842        360842   360842 
6 San Mateo     264352.    264352.  264352.    264352.       264353.  264353.
7 Santa Clara   650350.    650350.  650350.    650350.       650349.  650349.
8 Solano        154900.    154900.  154900.    154900.       154899.  154899.
9 Sonoma        189603.    189603.  189603.    189603.       189586.  189586.
[1] "population consistency checks"
# A tibble: 9 × 4
  County_Name     TOTPOP  sum_age sum_ethnicity
  <chr>            <dbl>    <dbl>         <dbl>
1 Alameda       1663584. 1663584.      2626280.
2 Contra Costa  1162795. 1162795.      1800450.
3 Marin          260602.  260602.       419935.
4 Napa           137664.  137664.       206294.
5 San Francisco  851036   851036       1364960.
6 San Mateo      754310.  754310.      1186734.
7 Santa Clara   1916864. 1916864.      3009935.
8 Solano         450726.  450726.       699260.
9 Sonoma         488308.  488308.       756819.
[1] "fix_rounding_artifacts(id_var=TAZ1454, sum_var=TOTPOP, partial_vars=AGE0004, AGE0519, AGE2044, AGE4564, AGE65P)"
[1] "fix_rounding_artifacts(): Rows needing updating:"
# A tibble: 341 × 9
   TAZ1454 TOTPOP AGE0004 AGE0519 AGE2044 AGE4564 AGE65P max_col diff_col
     <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl>  <dbl> <chr>      <dbl>
 1       4    300      12      10     149      83     45 AGE2044        1
 2       5    800      28      21     360     238    154 AGE2044       -1
 3      17   6773     230     112    4005    1577    848 AGE2044        1
 4      36   5076     126     302    1499    1547   1603 AGE65P        -1
 5      37   3072      56     225    1326     849    617 AGE2044       -1
 6      38   4445     426     301    1817    1361    541 AGE2044       -1
 7      39   3947     133     186    1614    1125    888 AGE2044        1
 8      41   4007     176     484    1727     793    828 AGE2044       -1
 9      83   4138      51     397    1768    1289    634 AGE2044       -1
10      89   8020     729     757    3889    1734    910 AGE2044        1
# ℹ 331 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "fix_rounding_artifacts(id_var=TAZ1454, sum_var=gqpop, partial_vars=gq_type_univ, gq_type_mil, gq_type_othnon)"
[1] "fix_rounding_artifacts(): Rows needing updating:"
# A tibble: 13 × 7
   TAZ1454 gqpop gq_type_univ gq_type_mil gq_type_othnon max_col        diff_col
     <dbl> <dbl>        <dbl>       <dbl>          <dbl> <chr>             <dbl>
 1       3    39            6           0             34 gq_type_othnon       -1
 2       9  1280          172           0           1107 gq_type_othnon        1
 3      20   441           11           0            429 gq_type_othnon        1
 4      21   219           10           0            210 gq_type_othnon       -1
 5      79    67            1           0             67 gq_type_othnon       -1
 6     433    35           32           0              2 gq_type_univ          1
 7     915     7            2           0              6 gq_type_othnon       -1
 8     998   131           29           0            103 gq_type_othnon       -1
 9    1222   629          625           0              3 gq_type_univ          1
10    1238   177          177           0              1 gq_type_univ         -1
11    1313   673          561           0            113 gq_type_univ         -1
12    1427   607          481           0            125 gq_type_univ          1
13    1434    14            0           0             13 gq_type_othnon        1
[1] "fix_rounding_artifacts(id_var=TAZ1454, sum_var=TOTHH, partial_vars=hh_own, hh_rent)"
[1] "fix_rounding_artifacts(): Rows needing updating:"
# A tibble: 207 × 6
   TAZ1454 TOTHH hh_own hh_rent max_col diff_col
     <dbl> <dbl>  <dbl>   <dbl> <chr>      <dbl>
 1       4   173     32     142 hh_rent       -1
 2       5   480    100     379 hh_rent        1
 3       9  6210    144    6065 hh_rent        1
 4      16  4915   1519    3397 hh_rent       -1
 5      17  3806   1413    2394 hh_rent       -1
 6      39  2099    452    1646 hh_rent        1
 7      41  2132    386    1747 hh_rent       -1
 8      79  1862    371    1492 hh_rent       -1
 9     108   897    172     724 hh_rent        1
10     109  3422   1452    1971 hh_rent       -1
# ℹ 197 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "fix_rounding_artifacts(id_var=TAZ1454, sum_var=TOTHH, partial_vars=hh_size_1, hh_size_2, hh_size_3, hh_size_4_plus)"
[1] "fix_rounding_artifacts(): Rows needing updating:"
# A tibble: 317 × 8
   TAZ1454 TOTHH hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus max_col   diff_col
     <dbl> <dbl>     <dbl>     <dbl>     <dbl>          <dbl> <chr>        <dbl>
 1       1    39         8        23         4              5 hh_size_2       -1
 2       2   124        24        72        12             15 hh_size_2        1
 3      16  4915      1957      2466       340            154 hh_size_2       -2
 4      55  1462       468       665        89            239 hh_size_2        1
 5      56    32        14        15         2              2 hh_size_2       -1
 6      69  2527       699       882       505            442 hh_size_2       -1
 7      83  2144       716      1111       141            177 hh_size_2       -1
 8      86  3017      1160      1166       327            363 hh_size_2        1
 9      89  3397      1050      1308       537            501 hh_size_2        1
10     108   897       378       387        64             67 hh_size_2        1
# ℹ 307 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "fix_rounding_artifacts(id_var=TAZ1454, sum_var=TOTHH, partial_vars=HHINCQ1, HHINCQ2, HHINCQ3, HHINCQ4)"
[1] "fix_rounding_artifacts(): Rows needing updating:"
# A tibble: 503 × 8
   TAZ1454 TOTHH HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4 max_col diff_col
     <dbl> <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>      <dbl>
 1       1    39      21       9       4       6 HHINCQ1       -1
 2       5   480     186      77     103     113 HHINCQ1        1
 3       6  2166     666     564     305     632 HHINCQ1       -1
 4       7  3209    1937     677     419     177 HHINCQ1       -1
 5      15   231      29      68      65      70 HHINCQ4       -1
 6      20  2203     685     279     418     820 HHINCQ4        1
 7      26   738     447     137     117      38 HHINCQ1       -1
 8      32  2857     696     761     733     666 HHINCQ2        1
 9      37  1734     817     343     260     313 HHINCQ1        1
10      38  2264     490     334     272    1169 HHINCQ4       -1
# ℹ 493 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "fix_rounding_artifacts(id_var=TAZ1454, sum_var=EMPRES, partial_vars=pers_occ_management, pers_occ_professional, pers_occ_services, pers_occ_retail, pers_occ_manual, pers_occ_military)"
[1] "fix_rounding_artifacts(): Rows needing updating:"
# A tibble: 351 × 10
   TAZ1454 EMPRES pers_occ_management pers_occ_professional pers_occ_services pers_occ_retail pers_occ_manual pers_occ_military max_col               diff_col
     <dbl>  <dbl>               <dbl>                 <dbl>             <dbl>           <dbl>           <dbl>             <dbl> <chr>                    <dbl>
 1       9   5831                 691                  1909              1092             892            1248                 0 pers_occ_professional       -1
 2      14    392                  23                   250                25              57              36                 0 pers_occ_professional        1
 3      17   4560                 879                  2451               589             470             170                 0 pers_occ_professional        1
 4      37   1924                 254                   536               629             181             323                 0 pers_occ_services            1
 5      38   2645                 534                  1349               326             361              66                 8 pers_occ_professional        1
 6      39   2534                 692                   992               320             391             140                 0 pers_occ_professional       -1
 7      41   1873                 282                   788               457             225             120                 0 pers_occ_professional        1
 8      55   1674                 333                   676               395             174              95                 0 pers_occ_professional        1
 9      56     34                  14                    14                 2               1               4                 0 pers_occ_management         -1
10      79   2523                 313                  1474               239             367             129                 0 pers_occ_professional        1
# ℹ 341 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "current_county_totals:"
# A tibble: 9 × 7
  County_Name    TOTHH  TOTPOP GQPOP   HHPOP  EMPRES TOTEMP
  <chr>          <dbl>   <dbl> <dbl>   <dbl>   <dbl>  <dbl>
1 Alameda       585723 1663586 43705 1628917  871629 725191
2 Contra Costa  408605 1162794  6731 1151340  574344 360032
3 Marin         103750  260601  2607  253800  129169 113637
4 Napa           49313  137665  2955  133582   68583  73440
5 San Francisco 360841  851035 23879  827667  498271 681981
6 San Mateo     264354  754312  5971  742282  403007 393422
7 Santa Clara   650349 1916861 31132 1877803 1003209 995663
8 Solano        154901  450725  3297  440329  216147 114919
9 Sonoma        189601  488306  6507  478415  248701 203018
[1] "##########################################################################################"
[1] "Scaling to ACS 1Year Totals: ACS_5year 2022 < ACS_PUMS_1year + 2 = 2025"
[1] "ACS_1year_target before removing institutionalized GQ:"
# A tibble: 9 × 7
  County_Name   TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst
  <chr>                <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>
1 Alameda             608534       1622188      1582968        854474        39220  10130.
2 Contra Costa        416172       1155025      1141589        578657        13436   4526.
3 Marin               101608        254407       247462        123552         6945   5138 
4 Napa                 51167        133216       128790         70192         4426   2222.
5 San Francisco       372027        808988       778344        469846        30644   4014 
6 San Mateo           265124        726353       714286        386668        12067   3382.
7 Santa Clara         665549       1877592      1836523       1012801        41069   8474.
8 Solano              157766        449218       438722        215010        10496   7833.
9 Sonoma              192765        481812       470927        252329        10885   2359 
# A tibble: 1 × 6
  TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst
         <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>
1      2830712       7508799      7339611       3963529       169188   48078
[1] "ACS_1year_target after removing institutionalized GQ:"
# A tibble: 9 × 7
  County_Name   TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst
  <chr>                <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>
1 Alameda             608534      1612058.      1582968        854474       29090.  10130.
2 Contra Costa        416172      1150499.      1141589        578657        8910.   4526.
3 Marin               101608       249269        247462        123552        1807    5138 
4 Napa                 51167       130994.       128790         70192        2204.   2222.
5 San Francisco       372027       804974        778344        469846       26630    4014 
6 San Mateo           265124       722971.       714286        386668        8685.   3382.
7 Santa Clara         665549      1869118.      1836523       1012801       32595.   8474.
8 Solano              157766       441385.       438722        215010        2663.   7833.
9 Sonoma              192765       479453        470927        252329        8526    2359 
# A tibble: 1 × 6
  TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst
         <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>
1      2830712       7460721      7339611       3963529       121110   48078
[1] "  Workers with h_county in BayArea: 4,087,664"
[1] "  Workers with w_county in BayArea: 4,421,291"
[1] "  Workers with h_county AND w_county in BayArea: 3,658,053"
[1] "lehd_lodes_h_county:"
# A tibble: 9 × 2
  County_Name   EMPRES_LEHD_target
  <chr>                      <dbl>
1 Alameda                   792353
2 Contra Costa              504136
3 Marin                     115373
4 Napa                       70361
5 San Francisco             465931
6 San Mateo                 373370
7 Santa Clara               933409
8 Solano                    175483
9 Sonoma                    227637
[1] "Incorporating EMPRES_LODES_WEIGHT=0.50; county_targets before adjustment:"
# A tibble: 9 × 15
  County_Name    TOTHH  TOTPOP GQPOP   HHPOP  EMPRES TOTEMP TOTEMP_target TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst EMPRES_LEHD_target
  <chr>          <dbl>   <dbl> <dbl>   <dbl>   <dbl>  <dbl>         <dbl>        <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>              <dbl>
1 Alameda       585723 1663586 43705 1628917  871629 725191        725191       608534      1612058.      1582968        854474       29090.  10130.             792353
2 Contra Costa  408605 1162794  6731 1151340  574344 360032        360032       416172      1150499.      1141589        578657        8910.   4526.             504136
3 Marin         103750  260601  2607  253800  129169 113637        113637       101608       249269        247462        123552        1807    5138              115373
4 Napa           49313  137665  2955  133582   68583  73440         73440        51167       130994.       128790         70192        2204.   2222.              70361
5 San Francisco 360841  851035 23879  827667  498271 681981        681981       372027       804974        778344        469846       26630    4014              465931
6 San Mateo     264354  754312  5971  742282  403007 393422        393422       265124       722971.       714286        386668        8685.   3382.             373370
7 Santa Clara   650349 1916861 31132 1877803 1003209 995663        995663       665549      1869118.      1836523       1012801       32595.   8474.             933409
8 Solano        154901  450725  3297  440329  216147 114919        114919       157766       441385.       438722        215010        2663.   7833.             175483
9 Sonoma        189601  488306  6507  478415  248701 203018        203018       192765       479453        470927        252329        8526    2359              227637
[1] "county_targets after adjustment:"
# A tibble: 9 × 14
  County_Name    TOTHH  TOTPOP GQPOP   HHPOP  EMPRES TOTEMP TOTEMP_target TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst
  <chr>          <dbl>   <dbl> <dbl>   <dbl>   <dbl>  <dbl>         <dbl>        <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>
1 Alameda       585723 1663586 43705 1628917  871629 725191        725191       608534      1612058.      1582968       823414.       29090.  10130.
2 Contra Costa  408605 1162794  6731 1151340  574344 360032        360032       416172      1150499.      1141589       541396.        8910.   4526.
3 Marin         103750  260601  2607  253800  129169 113637        113637       101608       249269        247462       119462.        1807    5138 
4 Napa           49313  137665  2955  133582   68583  73440         73440        51167       130994.       128790        70276.        2204.   2222.
5 San Francisco 360841  851035 23879  827667  498271 681981        681981       372027       804974        778344       467888.       26630    4014 
6 San Mateo     264354  754312  5971  742282  403007 393422        393422       265124       722971.       714286       380019         8685.   3382.
7 Santa Clara   650349 1916861 31132 1877803 1003209 995663        995663       665549      1869118.      1836523       973105        32595.   8474.
8 Solano        154901  450725  3297  440329  216147 114919        114919       157766       441385.       438722       195246.        2663.   7833.
9 Sonoma        189601  488306  6507  478415  248701 203018        203018       192765       479453        470927       239983         8526    2359 
# A tibble: 1 × 13
    TOTHH  TOTPOP  GQPOP   HHPOP  EMPRES  TOTEMP TOTEMP_target TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst
    <dbl>   <dbl>  <dbl>   <dbl>   <dbl>   <dbl>         <dbl>        <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>
1 2767437 7685885 126784 7534135 4013060 3661303       3661303      2830712       7460721      7339611       3810791       121110   48078
[1] "Implementing County Targets:"
# A tibble: 9 × 20
  County_Name    TOTHH  TOTPOP GQPOP   HHPOP  EMPRES TOTEMP TOTEMP_target TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst TOTHH_diff TOTPOP_diff HHPOP_diff GQPOP_diff EMPRES_diff TOTEMP_diff
  <chr>          <dbl>   <dbl> <dbl>   <dbl>   <dbl>  <dbl>         <dbl>        <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>      <dbl>       <dbl>      <dbl>      <dbl>       <dbl>       <dbl>
1 Alameda       585723 1663586 43705 1628917  871629 725191        725191       608534      1612058.      1582968       823414.       29090.  10130.      22811     -51528.     -45949    -14615.     -48216.           0
2 Contra Costa  408605 1162794  6731 1151340  574344 360032        360032       416172      1150499.      1141589       541396.        8910.   4526.       7567     -12295.      -9751      2179.     -32948.           0
3 Marin         103750  260601  2607  253800  129169 113637        113637       101608       249269        247462       119462.        1807    5138       -2142     -11332       -6338      -800       -9706.           0
4 Napa           49313  137665  2955  133582   68583  73440         73440        51167       130994.       128790        70276.        2204.   2222.       1854      -6671.      -4792      -751.       1694.           0
5 San Francisco 360841  851035 23879  827667  498271 681981        681981       372027       804974        778344       467888.       26630    4014       11186     -46061      -49323      2751      -30382.           0
6 San Mateo     264354  754312  5971  742282  403007 393422        393422       265124       722971.       714286       380019         8685.   3382.        770     -31341.     -27996      2714.     -22988            0
7 Santa Clara   650349 1916861 31132 1877803 1003209 995663        995663       665549      1869118.      1836523       973105        32595.   8474.      15200     -47743.     -41280      1463.     -30104            0
8 Solano        154901  450725  3297  440329  216147 114919        114919       157766       441385.       438722       195246.        2663.   7833.       2865      -9340.      -1607      -634.     -20900.           0
9 Sonoma        189601  488306  6507  478415  248701 203018        203018       192765       479453        470927       239983         8526    2359        3164      -8853       -7488      2019       -8718            0
[1] "Regional totals:"
# A tibble: 1 × 19
    TOTHH  TOTPOP  GQPOP   HHPOP  EMPRES  TOTEMP TOTEMP_target TOTHH_target TOTPOP_target HHPOP_target EMPRES_target GQPOP_target gq_inst TOTHH_diff TOTPOP_diff HHPOP_diff GQPOP_diff EMPRES_diff TOTEMP_diff
    <dbl>   <dbl>  <dbl>   <dbl>   <dbl>   <dbl>         <dbl>        <dbl>         <dbl>        <dbl>         <dbl>        <dbl>   <dbl>      <dbl>       <dbl>      <dbl>      <dbl>       <dbl>       <dbl>
1 2767437 7685885 126784 7534135 4013060 3661303       3661303      2830712       7460721      7339611       3810791       121110   48078      63275     -225164    -194524      -5674     -202269           0
[1] "########################## update_gqpop_to_county_totals(2023) ##########################"
[1] "target_df with GQPOP_target total=121110:"
# A tibble: 9 × 2
  County_Name   GQPOP_target
  <chr>                <dbl>
1 Alameda             29090.
2 Contra Costa         8910.
3 Marin                1807 
4 Napa                 2204.
5 San Francisco       26630 
6 San Mateo            8685.
7 Santa Clara         32595.
8 Solano               2663.
9 Sonoma               8526 
[1] "Read 9 rows from M:/Data/Census/PUMS/PUMS 2023/summaries/noninst_gq_summary.csv"
[1] "target_df with EMPRES_target refering to gqpop's EMPRES:"
# A tibble: 9 × 4
  County_Name   GQPOP_target worker_share EMPRES_target
  <chr>                <dbl>        <dbl>         <int>
1 Alameda             29090.        0.282          8189
2 Contra Costa         8910.        0.266          2368
3 Marin                1807         0.221           400
4 Napa                 2204.        0.365           804
5 San Francisco       26630         0.236          6294
6 San Mateo            8685.        0.179          1551
7 Santa Clara         32595.        0.336         10963
8 Solano               2663.        0.449          1195
9 Sonoma               8526         0.252          2148
# A tibble: 1 × 3
  GQPOP_target worker_share EMPRES_target
         <dbl>        <dbl>         <int>
1       121110         2.59         33912
[1] "Initial GQ_PUMS1YEAR_SUMMARY:"
    County_Name gq_type_mil gq_type_othnon gq_type_univ gqpop pers_occ_management pers_occ_manual pers_occ_military pers_occ_professional pers_occ_retail pers_occ_services EMPRES AGE0004 AGE0519 AGE2044 AGE4564 AGE65P worker_share
1       Alameda        2127          10810        16370 29307                  24            1451               872                  2144            1495              2264   8250      16   10429   11375    4556   2931    0.2815027
2  Contra Costa           0           6502         1745  8247                   0             878                 0                   617             535               162   2192       0    1090    1677    1992   3488    0.2657936
3         Marin           0           2736          805  3541                 577               0                 0                     0             193                13    783       0     656     691    1348    846    0.2211240
4          Napa          78           2306         1069  3453                   0             267                 0                   324             332               336   1259       0     884    1355     492    722    0.3646105
5 San Francisco         105          19742         7909 27756                  37             185                 0                  2306            2372              1660   6560       0    5121   10123    6659   5853    0.2363453
6     San Mateo           0           7705         1042  8747                  55             563                 0                   414              61               469   1562       0     590    1575    2781   3801    0.1785755
7   Santa Clara         205          10601        21319 32125                 429             470                 0                  4871            2043              2992  10805      19   10585   14661    3624   3236    0.3363424
8        Solano         777           1798          392  2967                 101             600               167                   153              85               226   1332       0     734    1645     326    262    0.4489383
9        Sonoma         332           5119         3298  8749                 134             325               138                   315             844               448   2204       0    2269    3037    2288   1155    0.2519145
  gq_type_mil gq_type_othnon gq_type_univ  gqpop pers_occ_management pers_occ_manual pers_occ_military pers_occ_professional pers_occ_retail pers_occ_services EMPRES AGE0004 AGE0519 AGE2044 AGE4564 AGE65P worker_share
1        3624          67319        53949 124892                1357            4739              1177                 11144            7960              8570  34947      35   32358   46139   24066  22294     2.585147
[1] "scale_data_to_targets(id_var=County_Name, sum_var=gqpop, partial_vars=gq_type_univ, gq_type_mil, gq_type_othnon)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=gqpop, partial_vars=gq_type_univ, gq_type_mil, gq_type_othnon)"
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_age, partial_vars=AGE0004, AGE0519, AGE2044, AGE4564, AGE65P)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_age, partial_vars=AGE0004, AGE0519, AGE2044, AGE4564, AGE65P)"
[1] "scale_data_to_targets(id_var=County_Name, sum_var=EMPRES, partial_vars=pers_occ_management, pers_occ_professional, pers_occ_services, pers_occ_retail, pers_occ_manual, pers_occ_military)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=EMPRES, partial_vars=pers_occ_management, pers_occ_professional, pers_occ_services, pers_occ_retail, pers_occ_manual, pers_occ_military)"
[1] "After adjusting to given target, detailed_GQ_county_targets:"
    County_Name gq_type_mil gq_type_othnon gq_type_univ gqpop pers_occ_management pers_occ_manual pers_occ_military pers_occ_professional pers_occ_retail pers_occ_services EMPRES AGE0004 AGE0519 AGE2044 AGE4564 AGE65P sum_age
1       Alameda        2111          10730        16249 29090                  24            1440               866                  2128            1484              2247   8189      16   10352   11291    4522   2909   29090
2  Contra Costa           0           7025         1885  8910                   0             948                 0                   667             578               175   2368       0    1178    1812    2152   3768    8910
3         Marin           0           1396          411  1807                 294               0                 0                     0              99                 7    400       0     335     353     687    432    1807
4          Napa          50           1472          682  2204                   0             171                 0                   207             212               214    804       0     564     865     314    461    2204
5 San Francisco         101          18941         7588 26630                  35             177                 0                  2212            2277              1593   6294       0    4913    9712    6389   5616   26630
6     San Mateo           0           7650         1035  8685                  55             558                 0                   411              61               466   1551       0     586    1564    2761   3774    8685
7   Santa Clara         208          10756        21631 32595                 435             477                 0                  4942            2073              3036  10963      19   10740   14876    3677   3283   32595
8        Solano         697           1614          352  2663                  91             538               150                   137              76               203   1195       0     659    1476     293    235    2663
9        Sonoma         324           4988         3214  8526                 131             317               134                   307             822               437   2148       0    2211    2959    2230   1126    8526
  gq_type_mil gq_type_othnon gq_type_univ  gqpop pers_occ_management pers_occ_manual pers_occ_military pers_occ_professional pers_occ_retail pers_occ_services EMPRES AGE0004 AGE0519 AGE2044 AGE4564 AGE65P sum_age
1        3491          64572        53047 121110                1065            4626              1150                 11011            7682              8378  33912      35   31538   44908   23025  21604  121110
[1] "source_df:"
# A tibble: 1,454 × 67
   TAZ1454 TOTHH HHPOP EMPRES AGE0004 AGE0519 AGE2044 AGE4564 AGE65P sum_age  SFDU  MFDU hh_own hh_rent hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus hh_kids_yes hh_kids_no AGE62P gq_inst gq_type_univ gq_type_mil gq_type_othnon gqpop pers_occ_management pers_occ_professional pers_occ_services pers_occ_retail pers_occ_manual pers_occ_military white_nonh black_nonh asian_nonh other_nonh hispanic HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4 DISTRICT COUNTY
     <dbl> <dbl> <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl>  <dbl>   <dbl> <dbl> <dbl>  <dbl>   <dbl>     <dbl>     <dbl>     <dbl>          <dbl>     <dbl>     <dbl>     <dbl>          <dbl>       <dbl>      <dbl>  <dbl>   <dbl>        <dbl>       <dbl>          <dbl> <dbl>               <dbl>                 <dbl>             <dbl>           <dbl>           <dbl>             <dbl>      <dbl>      <dbl>      <dbl>      <dbl>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>    <dbl>  <dbl>
 1       1    39    95     50       0      12      15      58     10      95     4    36      0      39         8        22         4              5        22        29        10              3           8         57     19       0            2           0              9    11                   0                     5                16              20               9                 0         36          0         56         82        3      20       9       4       6        1      1
 2       2   124   298    156       0      36      49     180     33     298    11   112      0     124        24        73        12             15        70        92        31              9          25        178     61       0            5           0             28    33                   0                    17                51              61              27                 0        114          0        174        196       10      64      28      12      20        1      1
 3       3   336   551    282       8     108     265     142     40     563     0   387      0     336       188       124        24              0        83       110        38             11          30        212     54       0            6           0             33    39                  31                    94                94              63               0                 0        184          5        254        371       12     148      43      70      75        1      1
 4       4   173   286    193      12      10     150      83     45     300     4   193     32     141       108        43        14              8        51        67        23              7          18        130     53       0            3           0             21    24                  27                    53                36              42              35                 0        119         18         77        217       53      61      28      46      38        1      1
 5       5   480   730    474      28      21     359     238    154     800    10   636    100     380       334        97        31             18       170       225        77             22          61        434    172       0           12           0             69    81                  59                   148                80             109              78                 0        308         40        185        393      192     187      77     103     113        1      1
 6       6  2166  3072   2470      14     466    2103     657    273    3513     0  2645    133    2033      1594       459        28             85       268      1490       390             18          95       2071    326       0          375           0              0   375                 331                  1062               541             424             112                 0       1650        163       1062       1753      443     665     564     305     632        1      1
 7       7  3209  4466   2391     105     203    2188    1308    711    4515    75  3827     56    3153      2403       617       103             86      1421      1347       410             31         126       3083    947       0           39           0            949   988                 226                   568               728             504             365                 0       1684        372       1282       1509      867    1936     677     419     177        1      1
 8       8  4505  8625   3682     427    1207    3093    2662   2220    9609    80  5260     93    4412      2758       696       454            597      2294      1427       533            251         681       3824   2675      21            0           0           2934  2934                  66                   458              1006             804            1348                 0       1679        939       3232       1937     3052    3042     840     558      65        1      1
 9       9  6210  9769   5831     345     787    4893    3171   1255   10451    87  6941    144    6066      4265       962       548            435      2008      3013       980            209         587       5622   1630       0          172           0           1108  1280                 691                  1908              1092             892            1248                 0       2979       1165       3277       3173     2333    3171    1440     871     728        1      1
10      10  3837  6854   4207     421     453    3850    1527    901    7152   205  4321    831    3006      2055      1100       362            320      1152      1468       814            205         536       3103   1301       0          327           0            796  1123                 615                  1811               491             603             687                 0       2059        351       3155       2186     1225    1133     814     767    1123        1      1
# ℹ 1,444 more rows
# ℹ 20 more variables: DISTRICT_NAME <chr>, County_Name <chr>, AGREMPN <dbl>, FPSEMPN <dbl>, HEREMPN <dbl>, MWTEMPN <dbl>, RETEMPN <dbl>, OTHEMPN <dbl>, TOTEMP <dbl>, sum_groupquarters <dbl>, sum_DU <dbl>, sum_tenure <dbl>, sum_size <dbl>, sum_hhworkers <dbl>, sum_kids <dbl>, sum_income <dbl>, sum_empres <dbl>, TOTPOP <dbl>, sum_ethnicity <dbl>, SHPOP62P <dbl>
# ℹ Use `print(n = ...)` to see more rows
[1] "source_county_df:"
# A tibble: 9 × 13
  County_Name   gq_type_univ gq_type_mil gq_type_othnon gqpop gq_type_univ_target gq_type_mil_target gq_type_othnon_target gqpop_target gq_type_univ_diff gq_type_mil_diff gq_type_othnon_diff gqpop_diff
  <chr>                <dbl>       <dbl>          <dbl> <dbl>               <dbl>              <dbl>                 <dbl>        <int>             <dbl>            <dbl>               <dbl>      <dbl>
1 Alameda              17465         421          25819 43705               16249               2111                 10730        29090             -1216             1690              -15089     -14615
2 Contra Costa          1462           0           5269  6731                1885                  0                  7025         8910               423                0                1756       2179
3 Marin                  629           0           1978  2607                 411                  0                  1396         1807              -218                0                -582       -800
4 Napa                   619           0           2336  2955                 682                 50                  1472         2204                63               50                -864       -751
5 San Francisco         6487          68          17324 23879                7588                101                 18941        26630              1101               33                1617       2751
6 San Mateo              900           0           5071  5971                1035                  0                  7650         8685               135                0                2579       2714
7 Santa Clara          19442           0          11690 31132               21631                208                 10756        32595              2189              208                -934       1463
8 Solano                 823         917           1557  3297                 352                697                  1614         2663              -471             -220                  57       -634
9 Sonoma                2873         278           3356  6507                3214                324                  4988         8526               341               46                1632       2019
# A tibble: 1 × 12
  gq_type_univ gq_type_mil gq_type_othnon  gqpop gq_type_univ_target gq_type_mil_target gq_type_othnon_target gqpop_target gq_type_univ_diff gq_type_mil_diff gq_type_othnon_diff gqpop_diff
         <dbl>       <dbl>          <dbl>  <dbl>               <dbl>              <dbl>                 <dbl>        <int>             <dbl>            <dbl>               <dbl>      <dbl>
1        50700        1684          74400 126784               53047               3491                 64572       121110              2347             1807               -9828      -5674
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=gq_type_univ)"
[1] "  Processing agg_id_value=             Alameda with diff=   -1216; filtered_source_df has   29 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=     423; filtered_source_df has    5 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -218; filtered_source_df has    7 rows"
[1] "  Processing agg_id_value=                Napa with diff=      63; filtered_source_df has    4 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    1101; filtered_source_df has   32 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     135; filtered_source_df has    4 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    2189; filtered_source_df has   14 rows"
[1] "  Processing agg_id_value=              Solano with diff=    -471; filtered_source_df has    3 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     341; filtered_source_df has    2 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=gq_type_mil)"
[1] "  Processing agg_id_value=             Alameda with diff=    1690; filtered_source_df has    3 rows"
[1] "  Processing agg_id_value=                Napa with diff=      50; filtered_source_df has    0 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=      33; filtered_source_df has    1 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=     208; filtered_source_df has    0 rows"
[1] "  Processing agg_id_value=              Solano with diff=    -220; filtered_source_df has    1 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=      46; filtered_source_df has    1 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=gq_type_othnon)"
[1] "  Processing agg_id_value=             Alameda with diff=  -15089; filtered_source_df has  277 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    1756; filtered_source_df has  130 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -582; filtered_source_df has   43 rows"
[1] "  Processing agg_id_value=                Napa with diff=    -864; filtered_source_df has   24 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    1617; filtered_source_df has  158 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=    2579; filtered_source_df has  122 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    -934; filtered_source_df has  262 rows"
[1] "  Processing agg_id_value=              Solano with diff=      57; filtered_source_df has   53 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=    1632; filtered_source_df has   72 rows"
[1] "Resulting group quarters by county:"
# A tibble: 9 × 5
  County_Name   gq_type_univ gq_type_mil gq_type_othnon gqpop
  <chr>                <dbl>       <dbl>          <dbl> <dbl>
1 Alameda              16249        2111          10742 29102
2 Contra Costa          1885           0           7025  8910
3 Marin                  411           0           1396  1807
4 Napa                   682           0           1472  2154
5 San Francisco         7588         101          18941 26630
6 San Mateo             1035           0           7650  8685
7 Santa Clara          21631           0          10756 32387
8 Solano                 352         697           1614  2663
9 Sonoma                3214         324           4988  8526
# A tibble: 1 × 4
  gq_type_univ gq_type_mil gq_type_othnon  gqpop
         <dbl>       <dbl>          <dbl>  <dbl>
1        53047        3233          64584 120864
[1] "regional_summary of source_df being returned:"
                      [,1]           
TAZ1454               " 1057785.0000"
TOTHH                 " 2767437.0000"
HHPOP                 " 7534135.0000"
EMPRES                " 4013060.0000"
AGE0004               "  400325.0000"
AGE0519               " 1311201.0000"
AGE2044               " 2736645.0000"
AGE4564               " 2001290.0000"
AGE65P                " 1236424.0000"
sum_age               " 7685885.0000"
SFDU                  " 1885833.0000"
MFDU                  " 1076948.0000"
hh_own                " 1563013.0000"
hh_rent               " 1204424.0000"
hh_size_1             "  697691.0000"
hh_size_2             "  884213.0000"
hh_size_3             "  477206.0000"
hh_size_4_plus        "  708327.0000"
hh_wrks_0             "  607687.0000"
hh_wrks_1             " 1006555.0000"
hh_wrks_2             "  885366.0000"
hh_wrks_3_plus        "  267840.0000"
hh_kids_yes           "  845635.0000"
hh_kids_no            " 1921796.0000"
AGE62P                " 1504199.0000"
gq_inst               "   48075.0000"
gq_type_univ          "   53047.0000"
gq_type_mil           "    3233.0000"
gq_type_othnon        "   64584.0000"
gqpop                 "  120864.0000"
pers_occ_management   "  564469.0000"
pers_occ_professional " 1378057.0000"
pers_occ_services     "  831797.0000"
pers_occ_retail       "  520999.0000"
pers_occ_manual       "  708215.0000"
pers_occ_military     "    9523.0000"
white_nonh            " 2830493.0000"
black_nonh            "  438049.0000"
asian_nonh            " 2122640.0000"
other_nonh            " 4860599.0000"
hispanic              " 1818913.0000"
HHINCQ1               "  598534.0000"
HHINCQ2               "  593724.0000"
HHINCQ3               "  603632.0000"
HHINCQ4               "  971547.0000"
DISTRICT              "   21677.0000"
COUNTY                "    5577.0000"
AGREMPN               "   24587.0000"
FPSEMPN               "  834187.0000"
HEREMPN               " 1335540.0000"
MWTEMPN               "  596021.0000"
RETEMPN               "  290211.0000"
OTHEMPN               "  580757.0000"
TOTEMP                " 3661303.0000"
sum_groupquarters     "  126784.0000"
sum_DU                " 2962778.0000"
sum_tenure            " 2767437.0000"
sum_size              " 2767437.0000"
sum_hhworkers         " 2767436.0000"
sum_kids              " 2767436.0000"
sum_income            " 2767437.0000"
sum_empres            " 4013060.0000"
TOTPOP                " 7685885.0000"
sum_ethnicity         "12070663.0000"
SHPOP62P              "     289.8924"
[1] "########################## update_tazdata_to_county_target(sum_var=EMPRES, partial_vars=c(pers_occ_management, pers_occ_professional, pers_occ_services, pers_occ_retail, pers_occ_manual, pers_occ_military)) ##########################"
[1] "target_df EMPRES_target total=3810791:"
[1] "source_county_summary from source_df (regional total=4013060):"
# A tibble: 9 × 8
  County_Name    EMPRES pers_occ_management pers_occ_professional pers_occ_services pers_occ_retail pers_occ_manual pers_occ_military
  <chr>           <dbl>               <dbl>                 <dbl>             <dbl>           <dbl>           <dbl>             <dbl>
1 Alameda        871629              117053                309493            183996          104731          154716              1640
2 Contra Costa   574344               80924                165587            129344           81721          116145               623
3 Marin          129169               23846                 40405             27998           19579           17143               198
4 Napa            68583                9223                 15100             14404           11846           17963                47
5 San Francisco  498271               82466                195266            101182           65054           53915               388
6 San Mateo      403007               61718                138470             81441           50547           70324               507
7 Santa Clara   1003209              137459                409012            178534          116599          160453              1152
8 Solano         216147               19525                 45575             57145           31390           58389              4123
9 Sonoma         248701               32255                 59149             57753           39532           59167               845
[1] "scale_data_to_targets(id_var=County_Name, sum_var=EMPRES, partial_vars=pers_occ_management, pers_occ_professional, pers_occ_services, pers_occ_retail, pers_occ_manual, pers_occ_military)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=EMPRES, partial_vars=pers_occ_management, pers_occ_professional, pers_occ_services, pers_occ_retail, pers_occ_manual, pers_occ_military)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 8
  County_Name   EMPRES_target pers_occ_management_target pers_occ_professional_target pers_occ_services_target pers_occ_retail_target pers_occ_manual_target pers_occ_military_target
  <chr>                 <int>                      <dbl>                        <dbl>                    <dbl>                  <dbl>                  <dbl>                    <dbl>
1 Alameda              823414                     110578                       292373                   173818                  98938                 146158                     1549
2 Contra Costa         541396                      76282                       156088                   121924                  77033                 109482                      587
3 Marin                119462                      22054                        37368                    25894                  18108                  15855                      183
4 Napa                  70276                       9451                        15473                    14760                  12139                  18405                       48
5 San Francisco        467888                      77438                       183360                    95012                  61087                  50627                      364
6 San Mateo            380019                      58198                       130570                    76796                  47664                  66313                      478
7 Santa Clara          973105                     133334                       396739                   173177                 113100                 155638                     1117
8 Solano               195246                      17637                        41168                    51619                  28355                  52743                     3724
9 Sonoma               239983                      31124                        57076                    55729                  38146                  57093                      815
[1] "target_partials_county:"
# A tibble: 9 × 22
  County_Name   EMPRES_target pers_occ_management_target pers_occ_professional_target pers_occ_services_target pers_occ_retail_target pers_occ_manual_target pers_occ_military_target  EMPRES pers_occ_management pers_occ_professional pers_occ_services pers_occ_retail pers_occ_manual pers_occ_military EMPRES_diff pers_occ_management_diff pers_occ_professional_diff pers_occ_services_diff pers_occ_retail_diff pers_occ_manual_diff pers_occ_military_diff
  <chr>                 <int>                      <dbl>                        <dbl>                    <dbl>                  <dbl>                  <dbl>                    <dbl>   <dbl>               <dbl>                 <dbl>             <dbl>           <dbl>           <dbl>             <dbl>       <dbl>                    <dbl>                      <dbl>                  <dbl>                <dbl>                <dbl>                  <dbl>
1 Alameda              823414                     110578                       292373                   173818                  98938                 146158                     1549  871629              117053                309493            183996          104731          154716              1640      -48215                    -6475                     -17120                 -10178                -5793                -8558                    -91
2 Contra Costa         541396                      76282                       156088                   121924                  77033                 109482                      587  574344               80924                165587            129344           81721          116145               623      -32948                    -4642                      -9499                  -7420                -4688                -6663                    -36
3 Marin                119462                      22054                        37368                    25894                  18108                  15855                      183  129169               23846                 40405             27998           19579           17143               198       -9707                    -1792                      -3037                  -2104                -1471                -1288                    -15
4 Napa                  70276                       9451                        15473                    14760                  12139                  18405                       48   68583                9223                 15100             14404           11846           17963                47        1693                      228                        373                    356                  293                  442                      1
5 San Francisco        467888                      77438                       183360                    95012                  61087                  50627                      364  498271               82466                195266            101182           65054           53915               388      -30383                    -5028                     -11906                  -6170                -3967                -3288                    -24
6 San Mateo            380019                      58198                       130570                    76796                  47664                  66313                      478  403007               61718                138470             81441           50547           70324               507      -22988                    -3520                      -7900                  -4645                -2883                -4011                    -29
7 Santa Clara          973105                     133334                       396739                   173177                 113100                 155638                     1117 1003209              137459                409012            178534          116599          160453              1152      -30104                    -4125                     -12273                  -5357                -3499                -4815                    -35
8 Solano               195246                      17637                        41168                    51619                  28355                  52743                     3724  216147               19525                 45575             57145           31390           58389              4123      -20901                    -1888                      -4407                  -5526                -3035                -5646                   -399
9 Sonoma               239983                      31124                        57076                    55729                  38146                  57093                      815  248701               32255                 59149             57753           39532           59167               845       -8718                    -1131                      -2073                  -2024                -1386                -2074                    -30
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=pers_occ_management)"
[1] "  Processing agg_id_value=             Alameda with diff=   -6475; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -4642; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -1792; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     228; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=   -5028; filtered_source_df has  188 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -3520; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=   -4125; filtered_source_df has  359 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -1888; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -1131; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=pers_occ_professional)"
[1] "  Processing agg_id_value=             Alameda with diff=  -17120; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -9499; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -3037; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     373; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=  -11906; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -7900; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=  -12273; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -4407; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -2073; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=pers_occ_services)"
[1] "  Processing agg_id_value=             Alameda with diff=  -10178; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -7420; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -2104; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     356; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=   -6170; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -4645; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=   -5357; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -5526; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -2024; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=pers_occ_retail)"
[1] "  Processing agg_id_value=             Alameda with diff=   -5793; filtered_source_df has  323 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -4688; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -1471; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     293; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=   -3967; filtered_source_df has  189 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -2883; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=   -3499; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -3035; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -1386; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=pers_occ_manual)"
[1] "  Processing agg_id_value=             Alameda with diff=   -8558; filtered_source_df has  322 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -6663; filtered_source_df has  170 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -1288; filtered_source_df has   49 rows"
[1] "  Processing agg_id_value=                Napa with diff=     442; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=   -3288; filtered_source_df has  186 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -4011; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=   -4815; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -5646; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -2074; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=pers_occ_military)"
[1] "  Processing agg_id_value=             Alameda with diff=     -91; filtered_source_df has   73 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=     -36; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=               Marin with diff=     -15; filtered_source_df has    7 rows"
[1] "  Processing agg_id_value=                Napa with diff=       1; filtered_source_df has    6 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=     -24; filtered_source_df has   20 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     -29; filtered_source_df has   15 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=     -35; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=              Solano with diff=    -399; filtered_source_df has   46 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     -30; filtered_source_df has   17 rows"
[1] "Resulting EMPRES and c(pers_occ_management, pers_occ_professional, pers_occ_services, pers_occ_retail, pers_occ_manual, pers_occ_military) by county:"
# A tibble: 9 × 8
  County_Name   EMPRES pers_occ_management pers_occ_professional pers_occ_services pers_occ_retail pers_occ_manual pers_occ_military
  <chr>          <dbl>               <dbl>                 <dbl>             <dbl>           <dbl>           <dbl>             <dbl>
1 Alameda       823414              110578                292373            173818           98938          146158              1549
2 Contra Costa  541396               76282                156088            121924           77033          109482               587
3 Marin         119462               22054                 37368             25894           18108           15855               183
4 Napa           70276                9451                 15473             14760           12139           18405                48
5 San Francisco 467888               77438                183360             95012           61087           50627               364
6 San Mateo     380019               58198                130570             76796           47664           66313               478
7 Santa Clara   973105              133334                396739            173177          113100          155638              1117
8 Solano        195246               17637                 41168             51619           28355           52743              3724
9 Sonoma        239983               31124                 57076             55729           38146           57093               815
[1] "regional_summary of source_df being returned:"
                      [,1]           
TAZ1454               " 1057785.0000"
TOTHH                 " 2767437.0000"
HHPOP                 " 7534135.0000"
EMPRES                " 3810789.0000"
AGE0004               "  400325.0000"
AGE0519               " 1311201.0000"
AGE2044               " 2736645.0000"
AGE4564               " 2001290.0000"
AGE65P                " 1236424.0000"
sum_age               " 7685885.0000"
SFDU                  " 1885833.0000"
MFDU                  " 1076948.0000"
hh_own                " 1563013.0000"
hh_rent               " 1204424.0000"
hh_size_1             "  697691.0000"
hh_size_2             "  884213.0000"
hh_size_3             "  477206.0000"
hh_size_4_plus        "  708327.0000"
hh_wrks_0             "  607687.0000"
hh_wrks_1             " 1006555.0000"
hh_wrks_2             "  885366.0000"
hh_wrks_3_plus        "  267840.0000"
hh_kids_yes           "  845635.0000"
hh_kids_no            " 1921796.0000"
AGE62P                " 1504199.0000"
gq_inst               "   48075.0000"
gq_type_univ          "   53047.0000"
gq_type_mil           "    3233.0000"
gq_type_othnon        "   64584.0000"
gqpop                 "  120864.0000"
pers_occ_management   "  536096.0000"
pers_occ_professional " 1310215.0000"
pers_occ_services     "  788729.0000"
pers_occ_retail       "  494570.0000"
pers_occ_manual       "  672314.0000"
pers_occ_military     "    8865.0000"
white_nonh            " 2830493.0000"
black_nonh            "  438049.0000"
asian_nonh            " 2122640.0000"
other_nonh            " 4860599.0000"
hispanic              " 1818913.0000"
HHINCQ1               "  598534.0000"
HHINCQ2               "  593724.0000"
HHINCQ3               "  603632.0000"
HHINCQ4               "  971547.0000"
DISTRICT              "   21677.0000"
COUNTY                "    5577.0000"
AGREMPN               "   24587.0000"
FPSEMPN               "  834187.0000"
HEREMPN               " 1335540.0000"
MWTEMPN               "  596021.0000"
RETEMPN               "  290211.0000"
OTHEMPN               "  580757.0000"
TOTEMP                " 3661303.0000"
sum_groupquarters     "  126784.0000"
sum_DU                " 2962778.0000"
sum_tenure            " 2767437.0000"
sum_size              " 2767437.0000"
sum_hhworkers         " 2767436.0000"
sum_kids              " 2767436.0000"
sum_income            " 2767437.0000"
sum_empres            " 4013060.0000"
TOTPOP                " 7685885.0000"
sum_ethnicity         "12070663.0000"
SHPOP62P              "     289.8924"
[1] "Compare to target_df EMPRES_target total=3810791"
[1] "########################## update_tazdata_to_county_target(sum_var=sum_age, partial_vars=c(AGE0004, AGE0519, AGE2044, AGE4564, AGE65P)) ##########################"
[1] "target_df sum_age_target total=7460721:"
[1] "source_county_summary from source_df (regional total=7685885):"
# A tibble: 9 × 7
  County_Name   sum_age AGE0004 AGE0519 AGE2044 AGE4564 AGE65P
  <chr>           <dbl>   <dbl>   <dbl>   <dbl>   <dbl>  <dbl>
1 Alameda       1663586   89974  283549  621646  425224 243193
2 Contra Costa  1162794   62837  223366  373077  313155 190359
3 Marin          260601   11384   45361   64638   78798  60420
4 Napa           137665    6359   24545   42650   36274  27837
5 San Francisco  851035   36577   91451  367139  213751 142117
6 San Mateo      754312   39742  125852  260018  201158 127542
7 Santa Clara   1916861  104467  350520  703052  488892 269930
8 Solano         450725   26110   83245  152896  113985  74489
9 Sonoma         488306   22875   83312  151529  130053 100537
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_age, partial_vars=AGE0004, AGE0519, AGE2044, AGE4564, AGE65P)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_age, partial_vars=AGE0004, AGE0519, AGE2044, AGE4564, AGE65P)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 7
  County_Name   sum_age_target AGE0004_target AGE0519_target AGE2044_target AGE4564_target AGE65P_target
  <chr>                  <int>          <dbl>          <dbl>          <dbl>          <dbl>         <dbl>
1 Alameda              1612058          87187         274766         602392         412053        235660
2 Contra Costa         1150499          62173         221004         369132         309844        188346
3 Marin                 249269          10889          43389          61827          75371         57793
4 Napa                  130994           6051          23356          40583          34516         26488
5 San Francisco         804974          34597          86501         347269         202182        134425
6 San Mateo             722971          38091         120623         249214         192800        122243
7 Santa Clara          1869118         101865         341790         685541         476715        263207
8 Solano                441385          25569          81520         149728         111623         72945
9 Sonoma                479453          22460          81802         148782         127695         98714
[1] "target_partials_county:"
# A tibble: 9 × 19
  County_Name   sum_age_target AGE0004_target AGE0519_target AGE2044_target AGE4564_target AGE65P_target sum_age AGE0004 AGE0519 AGE2044 AGE4564 AGE65P sum_age_diff AGE0004_diff AGE0519_diff AGE2044_diff AGE4564_diff AGE65P_diff
  <chr>                  <int>          <dbl>          <dbl>          <dbl>          <dbl>         <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>  <dbl>        <dbl>        <dbl>        <dbl>        <dbl>        <dbl>       <dbl>
1 Alameda              1612058          87187         274766         602392         412053        235660 1663586   89974  283549  621646  425224 243193       -51528        -2787        -8783       -19254       -13171       -7533
2 Contra Costa         1150499          62173         221004         369132         309844        188346 1162794   62837  223366  373077  313155 190359       -12295         -664        -2362        -3945        -3311       -2013
3 Marin                 249269          10889          43389          61827          75371         57793  260601   11384   45361   64638   78798  60420       -11332         -495        -1972        -2811        -3427       -2627
4 Napa                  130994           6051          23356          40583          34516         26488  137665    6359   24545   42650   36274  27837        -6671         -308        -1189        -2067        -1758       -1349
5 San Francisco         804974          34597          86501         347269         202182        134425  851035   36577   91451  367139  213751 142117       -46061        -1980        -4950       -19870       -11569       -7692
6 San Mateo             722971          38091         120623         249214         192800        122243  754312   39742  125852  260018  201158 127542       -31341        -1651        -5229       -10804        -8358       -5299
7 Santa Clara          1869118         101865         341790         685541         476715        263207 1916861  104467  350520  703052  488892 269930       -47743        -2602        -8730       -17511       -12177       -6723
8 Solano                441385          25569          81520         149728         111623         72945  450725   26110   83245  152896  113985  74489        -9340         -541        -1725        -3168        -2362       -1544
9 Sonoma                479453          22460          81802         148782         127695         98714  488306   22875   83312  151529  130053 100537        -8853         -415        -1510        -2747        -2358       -1823
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=AGE0004)"
[1] "  Processing agg_id_value=             Alameda with diff=   -2787; filtered_source_df has  321 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    -664; filtered_source_df has  168 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -495; filtered_source_df has   49 rows"
[1] "  Processing agg_id_value=                Napa with diff=    -308; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=   -1980; filtered_source_df has  184 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -1651; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=   -2602; filtered_source_df has  360 rows"
[1] "  Processing agg_id_value=              Solano with diff=    -541; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=    -415; filtered_source_df has   85 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=AGE0519)"
[1] "  Processing agg_id_value=             Alameda with diff=   -8783; filtered_source_df has  323 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -2362; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -1972; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=   -1189; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=   -4950; filtered_source_df has  186 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -5229; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=   -8730; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -1725; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -1510; filtered_source_df has   85 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=AGE2044)"
[1] "  Processing agg_id_value=             Alameda with diff=  -19254; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -3945; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -2811; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=   -2067; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=  -19870; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=  -10804; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=  -17511; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -3168; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -2747; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=AGE4564)"
[1] "  Processing agg_id_value=             Alameda with diff=  -13171; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -3311; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -3427; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=   -1758; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=  -11569; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -8358; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=  -12177; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -2362; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -2358; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=AGE65P)"
[1] "  Processing agg_id_value=             Alameda with diff=   -7533; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -2013; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -2627; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=   -1349; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=   -7692; filtered_source_df has  189 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -5299; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=   -6723; filtered_source_df has  357 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -1544; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -1823; filtered_source_df has   86 rows"
[1] "Resulting sum_age and c(AGE0004, AGE0519, AGE2044, AGE4564, AGE65P) by county:"
# A tibble: 9 × 7
  County_Name   sum_age AGE0004 AGE0519 AGE2044 AGE4564 AGE65P
  <chr>           <dbl>   <dbl>   <dbl>   <dbl>   <dbl>  <dbl>
1 Alameda       1612058   87187  274766  602392  412053 235660
2 Contra Costa  1150499   62173  221004  369132  309844 188346
3 Marin          249269   10889   43389   61827   75371  57793
4 Napa           130994    6051   23356   40583   34516  26488
5 San Francisco  804974   34597   86501  347269  202182 134425
6 San Mateo      722971   38091  120623  249214  192800 122243
7 Santa Clara   1869118  101865  341790  685541  476715 263207
8 Solano         441385   25569   81520  149728  111623  72945
9 Sonoma         479453   22460   81802  148782  127695  98714
[1] "regional_summary of source_df being returned:"
                      [,1]           
TAZ1454               " 1057785.0000"
TOTHH                 " 2767437.0000"
HHPOP                 " 7534135.0000"
EMPRES                " 3810789.0000"
AGE0004               "  388882.0000"
AGE0519               " 1274751.0000"
AGE2044               " 2654468.0000"
AGE4564               " 1942799.0000"
AGE65P                " 1199821.0000"
sum_age               " 7460721.0000"
SFDU                  " 1885833.0000"
MFDU                  " 1076948.0000"
hh_own                " 1563013.0000"
hh_rent               " 1204424.0000"
hh_size_1             "  697691.0000"
hh_size_2             "  884213.0000"
hh_size_3             "  477206.0000"
hh_size_4_plus        "  708327.0000"
hh_wrks_0             "  607687.0000"
hh_wrks_1             " 1006555.0000"
hh_wrks_2             "  885366.0000"
hh_wrks_3_plus        "  267840.0000"
hh_kids_yes           "  845635.0000"
hh_kids_no            " 1921796.0000"
AGE62P                " 1504199.0000"
gq_inst               "   48075.0000"
gq_type_univ          "   53047.0000"
gq_type_mil           "    3233.0000"
gq_type_othnon        "   64584.0000"
gqpop                 "  120864.0000"
pers_occ_management   "  536096.0000"
pers_occ_professional " 1310215.0000"
pers_occ_services     "  788729.0000"
pers_occ_retail       "  494570.0000"
pers_occ_manual       "  672314.0000"
pers_occ_military     "    8865.0000"
white_nonh            " 2830493.0000"
black_nonh            "  438049.0000"
asian_nonh            " 2122640.0000"
other_nonh            " 4860599.0000"
hispanic              " 1818913.0000"
HHINCQ1               "  598534.0000"
HHINCQ2               "  593724.0000"
HHINCQ3               "  603632.0000"
HHINCQ4               "  971547.0000"
DISTRICT              "   21677.0000"
COUNTY                "    5577.0000"
AGREMPN               "   24587.0000"
FPSEMPN               "  834187.0000"
HEREMPN               " 1335540.0000"
MWTEMPN               "  596021.0000"
RETEMPN               "  290211.0000"
OTHEMPN               "  580757.0000"
TOTEMP                " 3661303.0000"
sum_groupquarters     "  126784.0000"
sum_DU                " 2962778.0000"
sum_tenure            " 2767437.0000"
sum_size              " 2767437.0000"
sum_hhworkers         " 2767436.0000"
sum_kids              " 2767436.0000"
sum_income            " 2767437.0000"
sum_empres            " 4013060.0000"
TOTPOP                " 7685885.0000"
sum_ethnicity         "12070663.0000"
SHPOP62P              "     289.8924"
[1] "Compare to target_df sum_age_target total=7460721"
[1] "########################## update_tazdata_to_county_target(sum_var=sum_ethnicity, partial_vars=c(white_nonh, black_nonh, asian_nonh, other_nonh, hispanic)) ##########################"
[1] "target_df sum_ethnicity_target total=7460721:"
[1] "source_county_summary from source_df (regional total=12070663):"
# A tibble: 9 × 7
  County_Name   sum_ethnicity white_nonh black_nonh asian_nonh other_nonh hispanic
  <chr>                 <dbl>      <dbl>      <dbl>      <dbl>      <dbl>    <dbl>
1 Alameda             2626278     487325     165384     530914    1073068   369600
2 Contra Costa        1800455     471869      97616     209579     714488   306900
3 Marin                419933     180426       5726      16171     174444    43168
4 Napa                 206292      69291       2442      10943      75325    48291
5 San Francisco       1364961     325901      41935     294027     571585   131518
6 San Mateo           1186734     279249      16018     228215     482855   180403
7 Santa Clara         3009939     559089      43575     742694    1188226   476354
8 Solano               699255     159999      58342      68932     285899   126087
9 Sonoma               756816     297344       7011      21165     294709   136592
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_ethnicity, partial_vars=white_nonh, black_nonh, asian_nonh, other_nonh, hispanic)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_ethnicity, partial_vars=white_nonh, black_nonh, asian_nonh, other_nonh, hispanic)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 7
  County_Name   sum_ethnicity_target white_nonh_target black_nonh_target asian_nonh_target other_nonh_target hispanic_target
  <chr>                        <int>             <dbl>             <dbl>             <dbl>             <dbl>           <dbl>
1 Alameda                    1612058            299129            101516            325885            658661          226867
2 Contra Costa               1150499            301526             62377            133922            456563          196111
3 Marin                       249269            107098              3399              9599            103549           25624
4 Napa                        130994             43999              1551              6949             47830           30665
5 San Francisco               804974            192197             24731            173400            337084           77562
6 San Mateo                   722971            170121              9758            139031            294158          109903
7 Santa Clara                1869118            347184             27059            461200            737868          295807
8 Solano                      441385            100995             36827             43511            180463           79589
9 Sonoma                      479453            188368              4442             13408            186702           86533
[1] "target_partials_county:"
# A tibble: 9 × 19
  County_Name   sum_ethnicity_target white_nonh_target black_nonh_target asian_nonh_target other_nonh_target hispanic_target sum_ethnicity white_nonh black_nonh asian_nonh other_nonh hispanic sum_ethnicity_diff white_nonh_diff black_nonh_diff asian_nonh_diff other_nonh_diff hispanic_diff
  <chr>                        <int>             <dbl>             <dbl>             <dbl>             <dbl>           <dbl>         <dbl>      <dbl>      <dbl>      <dbl>      <dbl>    <dbl>              <dbl>           <dbl>           <dbl>           <dbl>           <dbl>         <dbl>
1 Alameda                    1612058            299129            101516            325885            658661          226867       2626278     487325     165384     530914    1073068   369600           -1014220         -188196          -63868         -205029         -414407       -142733
2 Contra Costa               1150499            301526             62377            133922            456563          196111       1800455     471869      97616     209579     714488   306900            -649956         -170343          -35239          -75657         -257925       -110789
3 Marin                       249269            107098              3399              9599            103549           25624        419933     180426       5726      16171     174444    43168            -170664          -73328           -2327           -6572          -70895        -17544
4 Napa                        130994             43999              1551              6949             47830           30665        206292      69291       2442      10943      75325    48291             -75298          -25292            -891           -3994          -27495        -17626
5 San Francisco               804974            192197             24731            173400            337084           77562       1364961     325901      41935     294027     571585   131518            -559987         -133704          -17204         -120627         -234501        -53956
6 San Mateo                   722971            170121              9758            139031            294158          109903       1186734     279249      16018     228215     482855   180403            -463763         -109128           -6260          -89184         -188697        -70500
7 Santa Clara                1869118            347184             27059            461200            737868          295807       3009939     559089      43575     742694    1188226   476354           -1140821         -211905          -16516         -281494         -450358       -180547
8 Solano                      441385            100995             36827             43511            180463           79589        699255     159999      58342      68932     285899   126087            -257870          -59004          -21515          -25421         -105436        -46498
9 Sonoma                      479453            188368              4442             13408            186702           86533        756816     297344       7011      21165     294709   136592            -277363         -108976           -2569           -7757         -108007        -50059
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=white_nonh)"
[1] "  Processing agg_id_value=             Alameda with diff= -188196; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff= -170343; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=  -73328; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=  -25292; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff= -133704; filtered_source_df has  188 rows"
[1] "  Processing agg_id_value=           San Mateo with diff= -109128; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff= -211905; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=  -59004; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff= -108976; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=black_nonh)"
[1] "  Processing agg_id_value=             Alameda with diff=  -63868; filtered_source_df has  319 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=  -35239; filtered_source_df has  168 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -2327; filtered_source_df has   44 rows"
[1] "  Processing agg_id_value=                Napa with diff=    -891; filtered_source_df has   24 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=  -17204; filtered_source_df has  174 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -6260; filtered_source_df has  143 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=  -16516; filtered_source_df has  321 rows"
[1] "  Processing agg_id_value=              Solano with diff=  -21515; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -2569; filtered_source_df has   77 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=asian_nonh)"
[1] "  Processing agg_id_value=             Alameda with diff= -205029; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=  -75657; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -6572; filtered_source_df has   49 rows"
[1] "  Processing agg_id_value=                Napa with diff=   -3994; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff= -120627; filtered_source_df has  189 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=  -89184; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff= -281494; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=  -25421; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -7757; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=other_nonh)"
[1] "  Processing agg_id_value=             Alameda with diff= -414407; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff= -257925; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=  -70895; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=  -27495; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff= -234501; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff= -188697; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff= -450358; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff= -105436; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff= -108007; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hispanic)"
[1] "  Processing agg_id_value=             Alameda with diff= -142733; filtered_source_df has  323 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff= -110789; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=  -17544; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=  -17626; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=  -53956; filtered_source_df has  189 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=  -70500; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff= -180547; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=  -46498; filtered_source_df has   80 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=  -50059; filtered_source_df has   86 rows"
[1] "Resulting sum_ethnicity and c(white_nonh, black_nonh, asian_nonh, other_nonh, hispanic) by county:"
# A tibble: 9 × 7
  County_Name   sum_ethnicity white_nonh black_nonh asian_nonh other_nonh hispanic
  <chr>                 <dbl>      <dbl>      <dbl>      <dbl>      <dbl>    <dbl>
1 Alameda             1612058     299129     101516     325885     658661   226867
2 Contra Costa        1150499     301526      62377     133922     456563   196111
3 Marin                249269     107098       3399       9599     103549    25624
4 Napa                 130994      43999       1551       6949      47830    30665
5 San Francisco        804974     192197      24731     173400     337084    77562
6 San Mateo            722971     170121       9758     139031     294158   109903
7 Santa Clara         1869118     347184      27059     461200     737868   295807
8 Solano               441385     100995      36827      43511     180463    79589
9 Sonoma               479453     188368       4442      13408     186702    86533
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7534135.0000"
EMPRES                "3810789.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1885833.0000"
MFDU                  "1076948.0000"
hh_own                "1563013.0000"
hh_rent               "1204424.0000"
hh_size_1             " 697691.0000"
hh_size_2             " 884213.0000"
hh_size_3             " 477206.0000"
hh_size_4_plus        " 708327.0000"
hh_wrks_0             " 607687.0000"
hh_wrks_1             "1006555.0000"
hh_wrks_2             " 885366.0000"
hh_wrks_3_plus        " 267840.0000"
hh_kids_yes           " 845635.0000"
hh_kids_no            "1921796.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 598534.0000"
HHINCQ2               " 593724.0000"
HHINCQ3               " 603632.0000"
HHINCQ4               " 971547.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2962778.0000"
sum_tenure            "2767437.0000"
sum_size              "2767437.0000"
sum_hhworkers         "2767436.0000"
sum_kids              "2767436.0000"
sum_income            "2767437.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
[1] "Compare to target_df sum_ethnicity_target total=7460721"
[1] "########################## update_tazdata_to_county_target(sum_var=sum_DU, partial_vars=c(SFDU, MFDU)) ##########################"
[1] "target_df sum_DU_target total=2830712:"
[1] "source_county_summary from source_df (regional total=2962778):"
# A tibble: 9 × 4
  County_Name   sum_DU   SFDU   MFDU
  <chr>          <dbl>  <dbl>  <dbl>
1 Alameda       622749 383505 239252
2 Contra Costa  424126 327940  96186
3 Marin         111723  81132  30590
4 Napa           55683  44314  11369
5 San Francisco 408199 124502 283696
6 San Mateo     284248 186416  97825
7 Santa Clara   688283 447888 240398
8 Solano        162425 127470  34954
9 Sonoma        205342 162666  42678
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_DU, partial_vars=SFDU, MFDU)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_DU, partial_vars=SFDU, MFDU)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 4
  County_Name   sum_DU_target SFDU_target MFDU_target
  <chr>                 <int>       <dbl>       <dbl>
1 Alameda              608534      374743      233791
2 Contra Costa         416172      321790       94382
3 Marin                101608       73788       27820
4 Napa                  51167       40720       10447
5 San Francisco        372027      113469      258558
6 San Mateo            265124      173881       91243
7 Santa Clara          665549      433091      232458
8 Solano               157766      123815       33951
9 Sonoma               192765      152701       40064
[1] "target_partials_county:"
# A tibble: 9 × 10
  County_Name   sum_DU_target SFDU_target MFDU_target sum_DU   SFDU   MFDU sum_DU_diff SFDU_diff MFDU_diff
  <chr>                 <int>       <dbl>       <dbl>  <dbl>  <dbl>  <dbl>       <dbl>     <dbl>     <dbl>
1 Alameda              608534      374743      233791 622749 383505 239252      -14215     -8762     -5461
2 Contra Costa         416172      321790       94382 424126 327940  96186       -7954     -6150     -1804
3 Marin                101608       73788       27820 111723  81132  30590      -10115     -7344     -2770
4 Napa                  51167       40720       10447  55683  44314  11369       -4516     -3594      -922
5 San Francisco        372027      113469      258558 408199 124502 283696      -36172    -11033    -25138
6 San Mateo            265124      173881       91243 284248 186416  97825      -19124    -12535     -6582
7 Santa Clara          665549      433091      232458 688283 447888 240398      -22734    -14797     -7940
8 Solano               157766      123815       33951 162425 127470  34954       -4659     -3655     -1003
9 Sonoma               192765      152701       40064 205342 162666  42678      -12577     -9965     -2614
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=SFDU)"
[1] "  Processing agg_id_value=             Alameda with diff=   -8762; filtered_source_df has  323 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -6150; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -7344; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=   -3594; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=  -11033; filtered_source_df has  187 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=  -12535; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=  -14797; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -3655; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -9965; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=MFDU)"
[1] "  Processing agg_id_value=             Alameda with diff=   -5461; filtered_source_df has  318 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=   -1804; filtered_source_df has  159 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -2770; filtered_source_df has   49 rows"
[1] "  Processing agg_id_value=                Napa with diff=    -922; filtered_source_df has   25 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=  -25138; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=   -6582; filtered_source_df has  151 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=   -7940; filtered_source_df has  339 rows"
[1] "  Processing agg_id_value=              Solano with diff=   -1003; filtered_source_df has   74 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=   -2614; filtered_source_df has   85 rows"
[1] "Resulting sum_DU and c(SFDU, MFDU) by county:"
# A tibble: 9 × 4
  County_Name   sum_DU   SFDU   MFDU
  <chr>          <dbl>  <dbl>  <dbl>
1 Alameda       608534 374743 233791
2 Contra Costa  416172 321790  94382
3 Marin         101608  73788  27820
4 Napa           51167  40720  10447
5 San Francisco 372027 113469 258558
6 San Mateo     265124 173881  91243
7 Santa Clara   665549 433091 232458
8 Solano        157766 123815  33951
9 Sonoma        192765 152701  40064
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7534135.0000"
EMPRES                "3810789.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1563013.0000"
hh_rent               "1204424.0000"
hh_size_1             " 697691.0000"
hh_size_2             " 884213.0000"
hh_size_3             " 477206.0000"
hh_size_4_plus        " 708327.0000"
hh_wrks_0             " 607687.0000"
hh_wrks_1             "1006555.0000"
hh_wrks_2             " 885366.0000"
hh_wrks_3_plus        " 267840.0000"
hh_kids_yes           " 845635.0000"
hh_kids_no            "1921796.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 598534.0000"
HHINCQ2               " 593724.0000"
HHINCQ3               " 603632.0000"
HHINCQ4               " 971547.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2767437.0000"
sum_size              "2767437.0000"
sum_hhworkers         "2767436.0000"
sum_kids              "2767436.0000"
sum_income            "2767437.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
[1] "Compare to target_df sum_DU_target total=2830712"
[1] "########################## update_tazdata_to_county_target(sum_var=sum_tenure, partial_vars=c(hh_own, hh_rent)) ##########################"
[1] "target_df sum_tenure_target total=2830712:"
[1] "source_county_summary from source_df (regional total=2767437):"
# A tibble: 9 × 4
  County_Name   sum_tenure hh_own hh_rent
  <chr>              <dbl>  <dbl>   <dbl>
1 Alameda           585723 317365  268358
2 Contra Costa      408605 274458  134147
3 Marin             103750  66475   37275
4 Napa               49313  32150   17163
5 San Francisco     360841 139115  221726
6 San Mateo         264354 157377  106977
7 Santa Clara       650349 361569  288780
8 Solano            154901  97625   57276
9 Sonoma            189601 116879   72722
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_tenure, partial_vars=hh_own, hh_rent)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_tenure, partial_vars=hh_own, hh_rent)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 4
  County_Name   sum_tenure_target hh_own_target hh_rent_target
  <chr>                     <int>         <dbl>          <dbl>
1 Alameda                  608534        329725         278809
2 Contra Costa             416172        279541         136631
3 Marin                    101608         65103          36505
4 Napa                      51167         33359          17808
5 San Francisco            372027        143428         228599
6 San Mateo                265124        157835         107289
7 Santa Clara              665549        370020         295529
8 Solano                   157766         99431          58335
9 Sonoma                   192765        118829          73936
[1] "target_partials_county:"
# A tibble: 9 × 10
  County_Name   sum_tenure_target hh_own_target hh_rent_target sum_tenure hh_own hh_rent sum_tenure_diff hh_own_diff hh_rent_diff
  <chr>                     <int>         <dbl>          <dbl>      <dbl>  <dbl>   <dbl>           <dbl>       <dbl>        <dbl>
1 Alameda                  608534        329725         278809     585723 317365  268358           22811       12360        10451
2 Contra Costa             416172        279541         136631     408605 274458  134147            7567        5083         2484
3 Marin                    101608         65103          36505     103750  66475   37275           -2142       -1372         -770
4 Napa                      51167         33359          17808      49313  32150   17163            1854        1209          645
5 San Francisco            372027        143428         228599     360841 139115  221726           11186        4313         6873
6 San Mateo                265124        157835         107289     264354 157377  106977             770         458          312
7 Santa Clara              665549        370020         295529     650349 361569  288780           15200        8451         6749
8 Solano                   157766         99431          58335     154901  97625   57276            2865        1806         1059
9 Sonoma                   192765        118829          73936     189601 116879   72722            3164        1950         1214
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_own)"
[1] "  Processing agg_id_value=             Alameda with diff=   12360; filtered_source_df has  322 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    5083; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -1372; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=    1209; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    4313; filtered_source_df has  184 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     458; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    8451; filtered_source_df has  360 rows"
[1] "  Processing agg_id_value=              Solano with diff=    1806; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=    1950; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_rent)"
[1] "  Processing agg_id_value=             Alameda with diff=   10451; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    2484; filtered_source_df has  170 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -770; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     645; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    6873; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     312; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    6749; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=    1059; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=    1214; filtered_source_df has   86 rows"
[1] "Resulting sum_tenure and c(hh_own, hh_rent) by county:"
# A tibble: 9 × 4
  County_Name   sum_tenure hh_own hh_rent
  <chr>              <dbl>  <dbl>   <dbl>
1 Alameda           608534 329725  278809
2 Contra Costa      416172 279541  136631
3 Marin             101608  65103   36505
4 Napa               51167  33359   17808
5 San Francisco     372027 143428  228599
6 San Mateo         265124 157835  107289
7 Santa Clara       665549 370020  295529
8 Solano            157766  99431   58335
9 Sonoma            192765 118829   73936
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7534135.0000"
EMPRES                "3810789.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1597271.0000"
hh_rent               "1233441.0000"
hh_size_1             " 697691.0000"
hh_size_2             " 884213.0000"
hh_size_3             " 477206.0000"
hh_size_4_plus        " 708327.0000"
hh_wrks_0             " 607687.0000"
hh_wrks_1             "1006555.0000"
hh_wrks_2             " 885366.0000"
hh_wrks_3_plus        " 267840.0000"
hh_kids_yes           " 845635.0000"
hh_kids_no            "1921796.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 598534.0000"
HHINCQ2               " 593724.0000"
HHINCQ3               " 603632.0000"
HHINCQ4               " 971547.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2830712.0000"
sum_size              "2767437.0000"
sum_hhworkers         "2767436.0000"
sum_kids              "2767436.0000"
sum_income            "2767437.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
[1] "Compare to target_df sum_tenure_target total=2830712"
[1] "########################## update_tazdata_to_county_target(sum_var=sum_kids, partial_vars=c(hh_kids_yes, hh_kids_no)) ##########################"
[1] "target_df sum_kids_target total=2830712:"
[1] "source_county_summary from source_df (regional total=2767436):"
# A tibble: 9 × 4
  County_Name   sum_kids hh_kids_yes hh_kids_no
  <chr>            <dbl>       <dbl>      <dbl>
1 Alameda         585730      186909     398821
2 Contra Costa    408594      143376     265220
3 Marin           103770       28616      75153
4 Napa             49314       14493      34821
5 San Francisco   360842       65247     295597
6 San Mateo       264350       82364     181986
7 Santa Clara     650352      222565     427784
8 Solano          154899       50560     104333
9 Sonoma          189585       51505     138081
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_kids, partial_vars=hh_kids_yes, hh_kids_no)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_kids, partial_vars=hh_kids_yes, hh_kids_no)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 4
  County_Name   sum_kids_target hh_kids_yes_target hh_kids_no_target
  <chr>                   <int>              <dbl>             <int>
1 Alameda                608534             194186            414348
2 Contra Costa           416172             146035            270137
3 Marin                  101608              28020             73588
4 Napa                    51167              15038             36129
5 San Francisco          372027              67269            304758
6 San Mateo              265124              82605            182519
7 Santa Clara            665549             227766            437783
8 Solano                 157766              51496            106270
9 Sonoma                 192765              52369            140396
[1] "target_partials_county:"
# A tibble: 9 × 10
  County_Name   sum_kids_target hh_kids_yes_target hh_kids_no_target sum_kids hh_kids_yes hh_kids_no sum_kids_diff hh_kids_yes_diff hh_kids_no_diff
  <chr>                   <int>              <dbl>             <int>    <dbl>       <dbl>      <dbl>         <dbl>            <dbl>           <dbl>
1 Alameda                608534             194186            414348   585730      186909     398821         22804             7277           15527
2 Contra Costa           416172             146035            270137   408594      143376     265220          7578             2659            4917
3 Marin                  101608              28020             73588   103770       28616      75153         -2162             -596           -1565
4 Napa                    51167              15038             36129    49314       14493      34821          1853              545            1308
5 San Francisco          372027              67269            304758   360842       65247     295597         11185             2022            9161
6 San Mateo              265124              82605            182519   264350       82364     181986           774              241             533
7 Santa Clara            665549             227766            437783   650352      222565     427784         15197             5201            9999
8 Solano                 157766              51496            106270   154899       50560     104333          2867              936            1937
9 Sonoma                 192765              52369            140396   189585       51505     138081          3180              864            2315
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_kids_yes)"
[1] "  Processing agg_id_value=             Alameda with diff=    7277; filtered_source_df has  322 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    2659; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -596; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     545; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    2022; filtered_source_df has  188 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     241; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    5201; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=     936; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     864; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_kids_no)"
[1] "  Processing agg_id_value=             Alameda with diff=   15527; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    4917; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=   -1565; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=    1308; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    9161; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     533; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    9999; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=    1937; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=    2315; filtered_source_df has   86 rows"
[1] "Resulting sum_kids and c(hh_kids_yes, hh_kids_no) by county:"
# A tibble: 9 × 4
  County_Name   sum_kids hh_kids_yes hh_kids_no
  <chr>            <dbl>       <dbl>      <dbl>
1 Alameda         608534      194186     414348
2 Contra Costa    416172      146035     270137
3 Marin           101608       28020      73588
4 Napa             51167       15038      36129
5 San Francisco   372027       67269     304758
6 San Mateo       265124       82605     182519
7 Santa Clara     665549      227766     437783
8 Solano          157766       51496     106270
9 Sonoma          192765       52369     140396
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7534135.0000"
EMPRES                "3810789.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1597271.0000"
hh_rent               "1233441.0000"
hh_size_1             " 697691.0000"
hh_size_2             " 884213.0000"
hh_size_3             " 477206.0000"
hh_size_4_plus        " 708327.0000"
hh_wrks_0             " 607687.0000"
hh_wrks_1             "1006555.0000"
hh_wrks_2             " 885366.0000"
hh_wrks_3_plus        " 267840.0000"
hh_kids_yes           " 864784.0000"
hh_kids_no            "1965928.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 598534.0000"
HHINCQ2               " 593724.0000"
HHINCQ3               " 603632.0000"
HHINCQ4               " 971547.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2830712.0000"
sum_size              "2767437.0000"
sum_hhworkers         "2767436.0000"
sum_kids              "2830712.0000"
sum_income            "2767437.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
[1] "Compare to target_df sum_kids_target total=2830712"
[1] "########################## update_tazdata_to_county_target(sum_var=sum_income, partial_vars=c(HHINCQ1, HHINCQ2, HHINCQ3, HHINCQ4)) ##########################"
[1] "target_df sum_income_target total=2830712:"
[1] "source_county_summary from source_df (regional total=2767437):"
# A tibble: 9 × 6
  County_Name   sum_income HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4
  <chr>              <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
1 Alameda           585723  136199  128086  127198  194240
2 Contra Costa      408605   89422   95161   96611  127411
3 Marin             103750   21043   20932   20246   41529
4 Napa               49313   12336   12653   12129   12195
5 San Francisco     360841   88182   65068   67620  139971
6 San Mateo         264354   46942   50957   56982  109473
7 Santa Clara       650349  114315  122169  138501  275364
8 Solano            154901   40028   46175   38602   30096
9 Sonoma            189601   50067   52523   45743   41268
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_income, partial_vars=HHINCQ1, HHINCQ2, HHINCQ3, HHINCQ4)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_income, partial_vars=HHINCQ1, HHINCQ2, HHINCQ3, HHINCQ4)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 6
  County_Name   sum_income_target HHINCQ1_target HHINCQ2_target HHINCQ3_target HHINCQ4_target
  <chr>                     <int>          <dbl>          <dbl>          <dbl>          <dbl>
1 Alameda                  608534         141503         133074         132152         201805
2 Contra Costa             416172          91078          96923          98400         129771
3 Marin                    101608          20609          20500          19828          40671
4 Napa                      51167          12800          13129          12585          12653
5 San Francisco            372027          90916          67085          69716         144310
6 San Mateo                265124          47079          51105          57148         109792
7 Santa Clara              665549         116987         125024         141738         281800
8 Solano                   157766          40768          47029          39316          30653
9 Sonoma                   192765          50903          53399          46506          41957
[1] "target_partials_county:"
# A tibble: 9 × 16
  County_Name   sum_income_target HHINCQ1_target HHINCQ2_target HHINCQ3_target HHINCQ4_target sum_income HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4 sum_income_diff HHINCQ1_diff HHINCQ2_diff HHINCQ3_diff HHINCQ4_diff
  <chr>                     <int>          <dbl>          <dbl>          <dbl>          <dbl>      <dbl>   <dbl>   <dbl>   <dbl>   <dbl>           <dbl>        <dbl>        <dbl>        <dbl>        <dbl>
1 Alameda                  608534         141503         133074         132152         201805     585723  136199  128086  127198  194240           22811         5304         4988         4954         7565
2 Contra Costa             416172          91078          96923          98400         129771     408605   89422   95161   96611  127411            7567         1656         1762         1789         2360
3 Marin                    101608          20609          20500          19828          40671     103750   21043   20932   20246   41529           -2142         -434         -432         -418         -858
4 Napa                      51167          12800          13129          12585          12653      49313   12336   12653   12129   12195            1854          464          476          456          458
5 San Francisco            372027          90916          67085          69716         144310     360841   88182   65068   67620  139971           11186         2734         2017         2096         4339
6 San Mateo                265124          47079          51105          57148         109792     264354   46942   50957   56982  109473             770          137          148          166          319
7 Santa Clara              665549         116987         125024         141738         281800     650349  114315  122169  138501  275364           15200         2672         2855         3237         6436
8 Solano                   157766          40768          47029          39316          30653     154901   40028   46175   38602   30096            2865          740          854          714          557
9 Sonoma                   192765          50903          53399          46506          41957     189601   50067   52523   45743   41268            3164          836          876          763          689
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=HHINCQ1)"
[1] "  Processing agg_id_value=             Alameda with diff=    5304; filtered_source_df has  323 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    1656; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -434; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     464; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    2734; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     137; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    2672; filtered_source_df has  361 rows"
[1] "  Processing agg_id_value=              Solano with diff=     740; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     836; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=HHINCQ2)"
[1] "  Processing agg_id_value=             Alameda with diff=    4988; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    1762; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -432; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     476; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    2017; filtered_source_df has  189 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     148; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    2855; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=     854; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     876; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=HHINCQ3)"
[1] "  Processing agg_id_value=             Alameda with diff=    4954; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    1789; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -418; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     456; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    2096; filtered_source_df has  189 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     166; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    3237; filtered_source_df has  360 rows"
[1] "  Processing agg_id_value=              Solano with diff=     714; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     763; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=HHINCQ4)"
[1] "  Processing agg_id_value=             Alameda with diff=    7565; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    2360; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -858; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     458; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    4339; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     319; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    6436; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=     557; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     689; filtered_source_df has   86 rows"
[1] "Resulting sum_income and c(HHINCQ1, HHINCQ2, HHINCQ3, HHINCQ4) by county:"
# A tibble: 9 × 6
  County_Name   sum_income HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4
  <chr>              <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
1 Alameda           608534  141503  133074  132152  201805
2 Contra Costa      416172   91078   96923   98400  129771
3 Marin             101608   20609   20500   19828   40671
4 Napa               51167   12800   13129   12585   12653
5 San Francisco     372027   90916   67085   69716  144310
6 San Mateo         265124   47079   51105   57148  109792
7 Santa Clara       665549  116987  125024  141738  281800
8 Solano            157766   40768   47029   39316   30653
9 Sonoma            192765   50903   53399   46506   41957
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7534135.0000"
EMPRES                "3810789.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1597271.0000"
hh_rent               "1233441.0000"
hh_size_1             " 697691.0000"
hh_size_2             " 884213.0000"
hh_size_3             " 477206.0000"
hh_size_4_plus        " 708327.0000"
hh_wrks_0             " 607687.0000"
hh_wrks_1             "1006555.0000"
hh_wrks_2             " 885366.0000"
hh_wrks_3_plus        " 267840.0000"
hh_kids_yes           " 864784.0000"
hh_kids_no            "1965928.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 612643.0000"
HHINCQ2               " 607268.0000"
HHINCQ3               " 617389.0000"
HHINCQ4               " 993412.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2830712.0000"
sum_size              "2767437.0000"
sum_hhworkers         "2767436.0000"
sum_kids              "2830712.0000"
sum_income            "2830712.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
[1] "Compare to target_df sum_income_target total=2830712"
[1] "########################## update_tazdata_to_county_target(sum_var=sum_size, partial_vars=c(hh_size_1, hh_size_2, hh_size_3, hh_size_4_plus)) ##########################"
[1] "target_df sum_size_target total=2830712:"
[1] "source_county_summary from source_df (regional total=2767437):"
# A tibble: 9 × 6
  County_Name   sum_size hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus
  <chr>            <dbl>     <dbl>     <dbl>     <dbl>          <dbl>
1 Alameda         585723    145732    181180    102428         156383
2 Contra Costa    408605     90044    128136     72783         117642
3 Marin           103750     30215     37690     15179          20666
4 Napa             49313     12511     17414      7200          12188
5 San Francisco   360841    133766    118593     50079          58403
6 San Mateo       264354     61301     85418     48220          69415
7 Santa Clara     650349    136584    200630    124951         188184
8 Solano          154901     36434     48378     27040          43049
9 Sonoma          189601     51104     66774     29326          42397
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_size, partial_vars=hh_size_1, hh_size_2, hh_size_3, hh_size_4_plus)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_size, partial_vars=hh_size_1, hh_size_2, hh_size_3, hh_size_4_plus)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 6
  County_Name   sum_size_target hh_size_1_target hh_size_2_target hh_size_3_target hh_size_4_plus_target
  <chr>                   <int>            <dbl>            <dbl>            <dbl>                 <dbl>
1 Alameda                608534           151408           188236           106417                162473
2 Contra Costa           416172            91712           130508            74131                119821
3 Marin                  101608            29591            36912            14866                 20239
4 Napa                    51167            12981            18069             7471                 12646
5 San Francisco          372027           137914           122269            51631                 60213
6 San Mateo              265124            61480            85667            48360                 69617
7 Santa Clara            665549           139776           205320           127871                192582
8 Solano                 157766            37108            49273            27540                 43845
9 Sonoma                 192765            51957            67888            29815                 43105
[1] "target_partials_county:"
# A tibble: 9 × 16
  County_Name   sum_size_target hh_size_1_target hh_size_2_target hh_size_3_target hh_size_4_plus_target sum_size hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus sum_size_diff hh_size_1_diff hh_size_2_diff hh_size_3_diff hh_size_4_plus_diff
  <chr>                   <int>            <dbl>            <dbl>            <dbl>                 <dbl>    <dbl>     <dbl>     <dbl>     <dbl>          <dbl>         <dbl>          <dbl>          <dbl>          <dbl>               <dbl>
1 Alameda                608534           151408           188236           106417                162473   585723    145732    181180    102428         156383         22811           5676           7056           3989                6090
2 Contra Costa           416172            91712           130508            74131                119821   408605     90044    128136     72783         117642          7567           1668           2372           1348                2179
3 Marin                  101608            29591            36912            14866                 20239   103750     30215     37690     15179          20666         -2142           -624           -778           -313                -427
4 Napa                    51167            12981            18069             7471                 12646    49313     12511     17414      7200          12188          1854            470            655            271                 458
5 San Francisco          372027           137914           122269            51631                 60213   360841    133766    118593     50079          58403         11186           4148           3676           1552                1810
6 San Mateo              265124            61480            85667            48360                 69617   264354     61301     85418     48220          69415           770            179            249            140                 202
7 Santa Clara            665549           139776           205320           127871                192582   650349    136584    200630    124951         188184         15200           3192           4690           2920                4398
8 Solano                 157766            37108            49273            27540                 43845   154901     36434     48378     27040          43049          2865            674            895            500                 796
9 Sonoma                 192765            51957            67888            29815                 43105   189601     51104     66774     29326          42397          3164            853           1114            489                 708
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_size_1)"
[1] "  Processing agg_id_value=             Alameda with diff=    5676; filtered_source_df has  323 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    1668; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -624; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     470; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    4148; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     179; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    3192; filtered_source_df has  361 rows"
[1] "  Processing agg_id_value=              Solano with diff=     674; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     853; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_size_2)"
[1] "  Processing agg_id_value=             Alameda with diff=    7056; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    2372; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -778; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     655; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    3676; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     249; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    4690; filtered_source_df has  360 rows"
[1] "  Processing agg_id_value=              Solano with diff=     895; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=    1114; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_size_3)"
[1] "  Processing agg_id_value=             Alameda with diff=    3989; filtered_source_df has  323 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    1348; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -313; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     271; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    1552; filtered_source_df has  189 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     140; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    2920; filtered_source_df has  359 rows"
[1] "  Processing agg_id_value=              Solano with diff=     500; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     489; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_size_4_plus)"
[1] "  Processing agg_id_value=             Alameda with diff=    6090; filtered_source_df has  323 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    2179; filtered_source_df has  170 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -427; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     458; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    1810; filtered_source_df has  186 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     202; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    4398; filtered_source_df has  362 rows"
[1] "  Processing agg_id_value=              Solano with diff=     796; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     708; filtered_source_df has   85 rows"
[1] "Resulting sum_size and c(hh_size_1, hh_size_2, hh_size_3, hh_size_4_plus) by county:"
# A tibble: 9 × 6
  County_Name   sum_size hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus
  <chr>            <dbl>     <dbl>     <dbl>     <dbl>          <dbl>
1 Alameda         608534    151408    188236    106417         162473
2 Contra Costa    416172     91712    130508     74131         119821
3 Marin           101608     29591     36912     14866          20239
4 Napa             51167     12981     18069      7471          12646
5 San Francisco   372027    137914    122269     51631          60213
6 San Mateo       265124     61480     85667     48360          69617
7 Santa Clara     665549    139776    205320    127871         192582
8 Solano          157766     37108     49273     27540          43845
9 Sonoma          192765     51957     67888     29815          43105
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7534135.0000"
EMPRES                "3810789.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1597271.0000"
hh_rent               "1233441.0000"
hh_size_1             " 713927.0000"
hh_size_2             " 904142.0000"
hh_size_3             " 488102.0000"
hh_size_4_plus        " 724541.0000"
hh_wrks_0             " 607687.0000"
hh_wrks_1             "1006555.0000"
hh_wrks_2             " 885366.0000"
hh_wrks_3_plus        " 267840.0000"
hh_kids_yes           " 864784.0000"
hh_kids_no            "1965928.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 612643.0000"
HHINCQ2               " 607268.0000"
HHINCQ3               " 617389.0000"
HHINCQ4               " 993412.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2830712.0000"
sum_size              "2830712.0000"
sum_hhworkers         "2767436.0000"
sum_kids              "2830712.0000"
sum_income            "2830712.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
[1] "Compare to target_df sum_size_target total=2830712"
[1] "########################## make_hhsizes_consistent_with_population(hh_size, popsyn_ACS_PUMS_5year=2021) ##########################"
[1] "target_df (HHPOP_target total=7339611):"
# A tibble: 9 × 2
  County_Name   HHPOP_target
  <chr>                <dbl>
1 Alameda            1582968
2 Contra Costa       1141589
3 Marin               247462
4 Napa                128790
5 San Francisco       778344
6 San Mateo           714286
7 Santa Clara        1836523
8 Solano              438722
9 Sonoma              470927
[1] "Read M:/Data/Census/PUMS/PUMS 2017-21/summaries/county_hh_size_summary_wide.csv"
[1] "big_cat_df:"
    County_Name big_cat_avg
1       Alameda    4.688484
2  Contra Costa    4.731602
3         Marin    4.505844
4          Napa    4.790308
5 San Francisco    4.727142
6     San Mateo    4.705065
7   Santa Clara    4.725152
8        Solano    4.868094
9        Sonoma    4.632406
[1] "source_df with estimated pop_var"
# A tibble: 1,454 × 7
   County_Name   sum_size hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus HHPOP_est
   <chr>            <dbl>     <dbl>     <dbl>     <dbl>          <dbl>     <dbl>
 1 San Francisco       40         8        22         4              6      92.4
 2 San Francisco      129        27        74        13             15     285. 
 3 San Francisco      350       197       128        25              0     528  
 4 San Francisco      179       114        43        14              8     280. 
 5 San Francisco      505       351       103        33             18     741. 
 6 San Francisco     2227      1641       470        28             88    3081. 
 7 San Francisco     3313      2480       639       105             89    4494. 
 8 San Francisco     4636      2842       716       467            611    8563. 
 9 San Francisco     6410      4411       982       565            452   10207. 
10 San Francisco     3955      2121      1129       373            332    7067. 
# ℹ 1,444 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "source_county_summary from source_df (regional HHPOP_est=7402275 HHPOP_target=7339611 HHPOP_diff=-62664):"
# A tibble: 9 × 12
  County_Name   big_cat_avg sum_size hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus HHPOP_est HHPOP_target HHPOP_diff avg_incr_value avg_decr_value
  <chr>               <dbl>    <dbl>     <dbl>     <dbl>     <dbl>          <dbl>     <dbl>        <dbl>      <dbl>          <dbl>          <dbl>
1 Alameda              4.69   608534    151408    188236    106417         162473  1608883.      1582968    -25915.           1.16           1.24
2 Contra Costa         4.73   416172     91712    130508     74131         119821  1142066.      1141589      -477.           1.18           1.27
3 Marin                4.51   101608     29591     36912     14866          20239   239207.       247462      8255.           1.09           1.14
4 Napa                 4.79    51167     12981     18069      7471          12646   132110.       128790     -3320.           1.15           1.26
5 San Francisco        4.73   372027    137914    122269     51631          60213   821980.       778344    -43636.           1.12           1.19
6 San Mateo            4.71   265124     61480     85667     48360          69617   705447.       714286      8839.           1.17           1.24
7 Santa Clara          4.73   665549    139776    205320    127871         192582  1844008.      1836523     -7485.           1.20           1.27
8 Solano               4.87   157766     37108     49273     27540          43845   431716.       438722      7006.           1.21           1.32
9 Sonoma               4.63   192765     51957     67888     29815          43105   476858.       470927     -5931.           1.13           1.19
[1] "  Processing county       Alameda (big_cat_avg=4.69 avg_change=1.24) with diff=-25915 slice_size= 20820; filtered_source_df has  324 rows"
[1] "  Processing county  Contra Costa (big_cat_avg=4.73 avg_change=1.27) with diff=  -477 slice_size=   375; filtered_source_df has  171 rows"
[1] "  Processing county         Marin (big_cat_avg=4.51 avg_change=1.09) with diff=  8255 slice_size=  7556; filtered_source_df has   50 rows"
[1] "  Processing county          Napa (big_cat_avg=4.79 avg_change=1.26) with diff= -3320 slice_size=  2631; filtered_source_df has   27 rows"
[1] "  Processing county San Francisco (big_cat_avg=4.73 avg_change=1.19) with diff=-43636 slice_size= 36761; filtered_source_df has  190 rows"
[1] "  Processing county     San Mateo (big_cat_avg=4.71 avg_change=1.17) with diff=  8839 slice_size=  7526; filtered_source_df has  155 rows"
[1] "  Processing county   Santa Clara (big_cat_avg=4.73 avg_change=1.27) with diff= -7485 slice_size=  5914; filtered_source_df has  363 rows"
[1] "  Processing county        Solano (big_cat_avg=4.87 avg_change=1.21) with diff=  7006 slice_size=  5791; filtered_source_df has   79 rows"
[1] "  Processing county        Sonoma (big_cat_avg=4.63 avg_change=1.19) with diff= -5931 slice_size=  4968; filtered_source_df has   86 rows"
[1] "full new_taz_tibble:"
# A tibble: 1,405 × 6
   County_Name TAZ1454 hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus
   <chr>         <dbl>     <dbl>     <dbl>     <dbl>          <dbl>
 1 Alameda         715       444       563       497           1139
 2 Alameda         716       408       731       317            362
 3 Alameda         717       473       712       646            480
 4 Alameda         718       555       856       483            889
 5 Alameda         719       780       700       462            898
 6 Alameda         720       487       755       506            453
 7 Alameda         721       653       636       476            575
 8 Alameda         722       638       931       397            927
 9 Alameda         723       259       723       284            592
10 Alameda         724       846       849       535            540
# ℹ 1,395 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "source_df with new replacements"
# A tibble: 1,454 × 7
   County_Name   TAZ1454 big_cat_avg hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus
   <chr>           <dbl>       <dbl>     <dbl>     <dbl>     <dbl>          <dbl>
 1 San Francisco       1        4.73        12        18         5              5
 2 San Francisco       2        4.73        35        67        15             12
 3 San Francisco       3        4.73       212       118        20              0
 4 San Francisco       4        4.73       127        34        10              8
 5 San Francisco       5        4.73       367        92        30             16
 6 San Francisco       6        4.73      1746       377        32             72
 7 San Francisco       7        4.73      2635       507       106             65
 8 San Francisco       8        4.73      3001       657       514            464
 9 San Francisco       9        4.73      4643       871       558            338
10 San Francisco      10        4.73      2310      1008       364            273
# ℹ 1,444 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "Returning source_df:"
# A tibble: 1,454 × 8
   County_Name   TAZ1454 hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus sum_size HHPOP
   <chr>           <dbl>     <dbl>     <dbl>     <dbl>          <dbl>    <dbl> <dbl>
 1 San Francisco       1        12        18         5              5       40    87
 2 San Francisco       2        35        67        15             12      129   271
 3 San Francisco       3       212       118        20              0      350   508
 4 San Francisco       4       127        34        10              8      179   263
 5 San Francisco       5       367        92        30             16      505   717
 6 San Francisco       6      1746       377        32             72     2227  2936
 7 San Francisco       7      2635       507       106             65     3313  4274
 8 San Francisco       8      3001       657       514            464     4636  8050
 9 San Francisco       9      4643       871       558            338     6410  9657
10 San Francisco      10      2310      1008       364            273     3955  6709
# ℹ 1,444 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "source_county_summary (regional HHPOP=7339321 HHPOP_target=7339611 HHPOP_diff=290):"
# A tibble: 9 × 9
  County_Name   sum_size hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus   HHPOP HHPOP_target HHPOP_diff
  <chr>            <dbl>     <dbl>     <dbl>     <dbl>          <dbl>   <dbl>        <dbl>      <dbl>
1 Alameda         608534    159758    184765    109129         154882 1582832      1582968        136
2 Contra Costa    416172     91870    130429     74190         119683 1141595      1141589         -6
3 Marin           101608     26876     36218     16843          21671  247488       247462        -26
4 Napa             51167     14204     17323      7925          11715  128744       128790         46
5 San Francisco   372027    156832    111427     53322          50446  778120       778344        224
6 San Mateo       265124     59244     84550     49776          71554  714335       714286        -49
7 Santa Clara     665549    142021    204547    128596         190385 1836503      1836523         20
8 Solano          157766     35337     48481     28646          45302  438768       438722        -46
9 Sonoma          192765     54391     66490     30277          41607  470936       470927         -9
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7339321.0000"
EMPRES                "3810789.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1597271.0000"
hh_rent               "1233441.0000"
hh_size_1             " 740533.0000"
hh_size_2             " 884230.0000"
hh_size_3             " 498704.0000"
hh_size_4_plus        " 707245.0000"
hh_wrks_0             " 607687.0000"
hh_wrks_1             "1006555.0000"
hh_wrks_2             " 885366.0000"
hh_wrks_3_plus        " 267840.0000"
hh_kids_yes           " 864784.0000"
hh_kids_no            "1965928.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 612643.0000"
HHINCQ2               " 607268.0000"
HHINCQ3               " 617389.0000"
HHINCQ4               " 993412.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2830712.0000"
sum_size              "2830712.0000"
sum_hhworkers         "2767436.0000"
sum_kids              "2830712.0000"
sum_income            "2830712.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
HHPOP_est             "7402274.8533"
[1] "########################## update_tazdata_to_county_target(sum_var=sum_hhworkers, partial_vars=c(hh_wrks_0, hh_wrks_1, hh_wrks_2, hh_wrks_3_plus)) ##########################"
[1] "target_df sum_hhworkers_target total=2830712:"
[1] "source_county_summary from source_df (regional total=2767436):"
# A tibble: 9 × 6
  County_Name   sum_hhworkers hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus
  <chr>                 <dbl>     <dbl>     <dbl>     <dbl>          <dbl>
1 Alameda              585730    129459    213252    189736          53294
2 Contra Costa         408594     94328    147863    126405          39998
3 Marin                103770     28993     37519     30552           6708
4 Napa                  49314     13073     16776     14643           4820
5 San Francisco        360842     83065    136310    110353          31115
6 San Mateo            264350     52574     92150     91878          27754
7 Santa Clara          650352    116275    241282    221127          71664
8 Solano               154899     37637     56774     45517          14971
9 Sonoma               189585     52283     64629     55155          17516
[1] "scale_data_to_targets(id_var=County_Name, sum_var=sum_hhworkers, partial_vars=hh_wrks_0, hh_wrks_1, hh_wrks_2, hh_wrks_3_plus)"
[1] "fix_rounding_artifacts(id_var=County_Name, sum_var=sum_hhworkers, partial_vars=hh_wrks_0, hh_wrks_1, hh_wrks_2, hh_wrks_3_plus)"
[1] "target_partials_county before diffs:"
# A tibble: 9 × 6
  County_Name   sum_hhworkers_target hh_wrks_0_target hh_wrks_1_target hh_wrks_2_target hh_wrks_3_plus_target
  <chr>                        <int>            <dbl>            <int>            <dbl>                 <dbl>
1 Alameda                     608534           134499           221543           197123                 55369
2 Contra Costa                416172            96077           150606           128749                 40740
3 Marin                       101608            28389            36736            29915                  6568
4 Napa                         51167            13564            17409            15193                  5001
5 San Francisco               372027            85640           140534           113774                 32079
6 San Mateo                   265124            52728            92414            92147                 27835
7 Santa Clara                 665549           118992           246924           226294                 73339
8 Solano                      157766            38334            57825            46359                 15248
9 Sonoma                      192765            53160            65715            56080                 17810
[1] "target_partials_county:"
# A tibble: 9 × 16
  County_Name   sum_hhworkers_target hh_wrks_0_target hh_wrks_1_target hh_wrks_2_target hh_wrks_3_plus_target sum_hhworkers hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus sum_hhworkers_diff hh_wrks_0_diff hh_wrks_1_diff hh_wrks_2_diff hh_wrks_3_plus_diff
  <chr>                        <int>            <dbl>            <int>            <dbl>                 <dbl>         <dbl>     <dbl>     <dbl>     <dbl>          <dbl>              <dbl>          <dbl>          <dbl>          <dbl>               <dbl>
1 Alameda                     608534           134499           221543           197123                 55369        585730    129459    213252    189736          53294              22804           5040           8291           7387                2075
2 Contra Costa                416172            96077           150606           128749                 40740        408594     94328    147863    126405          39998               7578           1749           2743           2344                 742
3 Marin                       101608            28389            36736            29915                  6568        103770     28993     37519     30552           6708              -2162           -604           -783           -637                -140
4 Napa                         51167            13564            17409            15193                  5001         49314     13073     16776     14643           4820               1853            491            633            550                 181
5 San Francisco               372027            85640           140534           113774                 32079        360842     83065    136310    110353          31115              11185           2575           4224           3421                 964
6 San Mateo                   265124            52728            92414            92147                 27835        264350     52574     92150     91878          27754                774            154            264            269                  81
7 Santa Clara                 665549           118992           246924           226294                 73339        650352    116275    241282    221127          71664              15197           2717           5642           5167                1675
8 Solano                      157766            38334            57825            46359                 15248        154899     37637     56774     45517          14971               2867            697           1051            842                 277
9 Sonoma                      192765            53160            65715            56080                 17810        189585     52283     64629     55155          17516               3180            877           1086            925                 294
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_wrks_0)"
[1] "  Processing agg_id_value=             Alameda with diff=    5040; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    1749; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -604; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     491; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    2575; filtered_source_df has  189 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     154; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    2717; filtered_source_df has  359 rows"
[1] "  Processing agg_id_value=              Solano with diff=     697; filtered_source_df has   78 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     877; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_wrks_1)"
[1] "  Processing agg_id_value=             Alameda with diff=    8291; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    2743; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -783; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     633; filtered_source_df has   27 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    4224; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     264; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    5642; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=    1051; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=    1086; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_wrks_2)"
[1] "  Processing agg_id_value=             Alameda with diff=    7387; filtered_source_df has  324 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=    2344; filtered_source_df has  171 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -637; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     550; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=    3421; filtered_source_df has  190 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=     269; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    5167; filtered_source_df has  363 rows"
[1] "  Processing agg_id_value=              Solano with diff=     842; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     925; filtered_source_df has   86 rows"
[1] "update_disaggregate_data_to_aggregate_targets(disagg_id_var=TAZ1454, agg_id_var=County_Name, col_name=hh_wrks_3_plus)"
[1] "  Processing agg_id_value=             Alameda with diff=    2075; filtered_source_df has  322 rows"
[1] "  Processing agg_id_value=        Contra Costa with diff=     742; filtered_source_df has  169 rows"
[1] "  Processing agg_id_value=               Marin with diff=    -140; filtered_source_df has   50 rows"
[1] "  Processing agg_id_value=                Napa with diff=     181; filtered_source_df has   26 rows"
[1] "  Processing agg_id_value=       San Francisco with diff=     964; filtered_source_df has  187 rows"
[1] "  Processing agg_id_value=           San Mateo with diff=      81; filtered_source_df has  155 rows"
[1] "  Processing agg_id_value=         Santa Clara with diff=    1675; filtered_source_df has  360 rows"
[1] "  Processing agg_id_value=              Solano with diff=     277; filtered_source_df has   79 rows"
[1] "  Processing agg_id_value=              Sonoma with diff=     294; filtered_source_df has   86 rows"
[1] "Resulting sum_hhworkers and c(hh_wrks_0, hh_wrks_1, hh_wrks_2, hh_wrks_3_plus) by county:"
# A tibble: 9 × 6
  County_Name   sum_hhworkers hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus
  <chr>                 <dbl>     <dbl>     <dbl>     <dbl>          <dbl>
1 Alameda              608534    134499    221543    197123          55369
2 Contra Costa         416172     96077    150606    128749          40740
3 Marin                101608     28389     36736     29915           6568
4 Napa                  51167     13564     17409     15193           5001
5 San Francisco        372027     85640    140534    113774          32079
6 San Mateo            265124     52728     92414     92147          27835
7 Santa Clara          665549    118992    246924    226294          73339
8 Solano               157766     38334     57825     46359          15248
9 Sonoma               192765     53160     65715     56080          17810
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7339321.0000"
EMPRES                "3810789.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1597271.0000"
hh_rent               "1233441.0000"
hh_size_1             " 740533.0000"
hh_size_2             " 884230.0000"
hh_size_3             " 498704.0000"
hh_size_4_plus        " 707245.0000"
hh_wrks_0             " 621383.0000"
hh_wrks_1             "1029706.0000"
hh_wrks_2             " 905634.0000"
hh_wrks_3_plus        " 273989.0000"
hh_kids_yes           " 864784.0000"
hh_kids_no            "1965928.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 612643.0000"
HHINCQ2               " 607268.0000"
HHINCQ3               " 617389.0000"
HHINCQ4               " 993412.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2830712.0000"
sum_size              "2830712.0000"
sum_hhworkers         "2830712.0000"
sum_kids              "2830712.0000"
sum_income            "2830712.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
HHPOP_est             "7402274.8533"
[1] "Compare to target_df sum_hhworkers_target total=2830712"
[1] "########################## make_hhsizes_consistent_with_population(hh_wrks, popsyn_ACS_PUMS_5year=2021) ##########################"
[1] "target_df (EMPRES_target total=3810791):"
# A tibble: 9 × 2
  County_Name   EMPRES_target
  <chr>                 <dbl>
1 Alameda             823414.
2 Contra Costa        541396.
3 Marin               119462.
4 Napa                 70276.
5 San Francisco       467888.
6 San Mateo           380019 
7 Santa Clara         973105 
8 Solano              195246.
9 Sonoma              239983 
[1] "Read M:/Data/Census/PUMS/PUMS 2017-21/summaries/county_hh_worker_summary_wide.csv"
[1] "big_cat_df:"
    County_Name big_cat_avg
1       Alameda    3.410451
2  Contra Costa    3.332610
3         Marin    3.309955
4          Napa    3.392616
5 San Francisco    3.500281
6     San Mateo    3.473634
7   Santa Clara    3.456515
8        Solano    3.344303
9        Sonoma    3.359125
[1] "source_df with estimated pop_var"
# A tibble: 1,454 × 7
   County_Name   sum_hhworkers hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus EMPRES_est
   <chr>                 <dbl>     <dbl>     <dbl>     <dbl>          <dbl>      <dbl>
 1 San Francisco            68        24        30        11              3       62.5
 2 San Francisco           209        74        94        32              9      190. 
 3 San Francisco           248        85       112        39             12      232. 
 4 San Francisco           154        52        69        26              7      146. 
 5 San Francisco           519       177       238        78             26      485. 
 6 San Francisco          2227       272      1533       403             19     2406. 
 7 San Francisco          3299      1452      1393       422             32     2349. 
 8 San Francisco          4644      2355      1476       553            260     3492. 
 9 San Francisco          6393      2063      3102      1011            217     5884. 
10 San Francisco          3755      1187      1523       834            211     3930. 
# ℹ 1,444 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "source_county_summary from source_df (regional EMPRES_est=3777576 EMPRES_target=3810791 EMPRES_diff=33215):"
# A tibble: 9 × 12
  County_Name   big_cat_avg sum_hhworkers hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus EMPRES_est EMPRES_target EMPRES_diff avg_incr_value avg_decr_value
  <chr>               <dbl>         <dbl>     <dbl>     <dbl>     <dbl>          <dbl>      <dbl>         <dbl>       <dbl>          <dbl>          <dbl>
1 Alameda              3.41        608534    134499    221543    197123          55369    804622.       823414.      18791.           1.15           1.05
2 Contra Costa         3.33        416172     96077    150606    128749          40740    543875.       541396.      -2478.           1.11           1.04
3 Marin                3.31        101608     28389     36736     29915           6568    118306.       119462.       1157.           1.10           1.03
4 Napa                 3.39         51167     13564     17409     15193           5001     64761.        70276.       5515.           1.13           1.05
5 San Francisco        3.50        372027     85640    140534    113774          32079    480368.       467888.     -12479.           1.17           1.06
6 San Mateo            3.47        265124     52728     92414     92147          27835    373397.       380019        6622.           1.18           1.06
7 Santa Clara          3.46        665549    118992    246924    226294          73339    953009.       973105       20096.           1.17           1.06
8 Solano               3.34        157766     38334     57825     46359          15248    201537.       195246.      -6290.           1.11           1.04
9 Sonoma               3.36        192765     53160     65715     56080          17810    237701.       239983        2282.           1.12           1.05
[1] "  Processing county       Alameda (big_cat_avg=3.41 avg_change=1.15) with diff= 18791 slice_size= 16393; filtered_source_df has  324 rows"
[1] "  Processing county  Contra Costa (big_cat_avg=3.33 avg_change=1.04) with diff= -2478 slice_size=  2377; filtered_source_df has  171 rows"
[1] "  Processing county         Marin (big_cat_avg=3.31 avg_change=1.10) with diff=  1157 slice_size=  1053; filtered_source_df has   50 rows"
[1] "  Processing county          Napa (big_cat_avg=3.39 avg_change=1.13) with diff=  5515 slice_size=  4883; filtered_source_df has   27 rows"
[1] "  Processing county San Francisco (big_cat_avg=3.50 avg_change=1.06) with diff=-12479 slice_size= 11816; filtered_source_df has  190 rows"
[1] "  Processing county     San Mateo (big_cat_avg=3.47 avg_change=1.18) with diff=  6622 slice_size=  5593; filtered_source_df has  155 rows"
[1] "  Processing county   Santa Clara (big_cat_avg=3.46 avg_change=1.17) with diff= 20096 slice_size= 17110; filtered_source_df has  363 rows"
[1] "  Processing county        Solano (big_cat_avg=3.34 avg_change=1.04) with diff= -6290 slice_size=  6025; filtered_source_df has   79 rows"
[1] "  Processing county        Sonoma (big_cat_avg=3.36 avg_change=1.12) with diff=  2282 slice_size=  2046; filtered_source_df has   86 rows"
[1] "full new_taz_tibble:"
# A tibble: 1,434 × 6
   County_Name TAZ1454 hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus
   <chr>         <dbl>     <dbl>     <dbl>     <dbl>          <dbl>
 1 Alameda         715       386       900      1090            281
 2 Alameda         716       425       574       687            147
 3 Alameda         717       441       671       939            240
 4 Alameda         718       349       950      1035            440
 5 Alameda         719       547      1145       901            241
 6 Alameda         720       316       834       879            186
 7 Alameda         721       497       810       793            250
 8 Alameda         722       544       711      1117            507
 9 Alameda         723       203       736       807            126
10 Alameda         724       656       994       742            371
# ℹ 1,424 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "source_df with new replacements"
# A tibble: 1,454 × 7
   County_Name   TAZ1454 big_cat_avg hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus
   <chr>           <dbl>       <dbl>     <dbl>     <dbl>     <dbl>          <dbl>
 1 San Francisco       1        3.50        26        28        11              3
 2 San Francisco       2        3.50        80        88        32              9
 3 San Francisco       3        3.50        92       107        39             10
 4 San Francisco       4        3.50        54        69        25              6
 5 San Francisco       5        3.50       183       236        74             26
 6 San Francisco       6        3.50       313      1511       384             19
 7 San Francisco       7        3.50      1499      1357       414             29
 8 San Francisco       8        3.50      2421      1425       547            251
 9 San Francisco       9        3.50      2174      3027       980            212
10 San Francisco      10        3.50      1247      1502       799            207
# ℹ 1,444 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "Returning source_df:"
# A tibble: 1,454 × 8
   County_Name   TAZ1454 hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus sum_hhworkers EMPRES
   <chr>           <dbl>     <dbl>     <dbl>     <dbl>          <dbl>         <dbl>  <dbl>
 1 San Francisco       1        26        28        11              3            68     61
 2 San Francisco       2        80        88        32              9           209    184
 3 San Francisco       3        92       107        39             10           248    220
 4 San Francisco       4        54        69        25              6           154    140
 5 San Francisco       5       183       236        74             26           519    475
 6 San Francisco       6       313      1511       384             19          2227   2346
 7 San Francisco       7      1499      1357       414             29          3299   2287
 8 San Francisco       8      2421      1425       547            251          4644   3398
 9 San Francisco       9      2174      3027       980            212          6393   5729
10 San Francisco      10      1247      1502       799            207          3755   3825
# ℹ 1,444 more rows
# ℹ Use `print(n = ...)` to see more rows
[1] "source_county_summary (regional EMPRES=3810997 EMPRES_target=3810791 EMPRES_diff=-206):"
# A tibble: 9 × 9
  County_Name   sum_hhworkers hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus EMPRES EMPRES_target EMPRES_diff
  <chr>                 <dbl>     <dbl>     <dbl>     <dbl>          <dbl>  <dbl>         <dbl>       <dbl>
1 Alameda              608534    130514    219137    197497          61386 823497       823414.       -83.5
2 Contra Costa         416172     97143    150539    128062          40428 541400       541396.        -3.5
3 Marin                101608     28093     36621     29980           6914 119469       119462.        -6.5
4 Napa                  51167     12236     16900     15312           6719  70317        70276.       -40.5
5 San Francisco        372027     91169    139845    110381          30632 467869       467888.        19.5
6 San Mateo            265124     51513     91440     92147          30024 380021       380019         -2  
7 Santa Clara          665549    115567    243393    226521          80068 973181       973105        -76  
8 Solano               157766     41215     57287     44817          14447 195240       195246.         6.5
9 Sonoma               192765     52586     65534     56118          18527 240003       239983        -20  
[1] "regional_summary of source_df being returned:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2767437.0000"
HHPOP                 "7339321.0000"
EMPRES                "3810997.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1597271.0000"
hh_rent               "1233441.0000"
hh_size_1             " 740533.0000"
hh_size_2             " 884230.0000"
hh_size_3             " 498704.0000"
hh_size_4_plus        " 707245.0000"
hh_wrks_0             " 620036.0000"
hh_wrks_1             "1020696.0000"
hh_wrks_2             " 900835.0000"
hh_wrks_3_plus        " 289145.0000"
hh_kids_yes           " 864784.0000"
hh_kids_no            "1965928.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 612643.0000"
HHINCQ2               " 607268.0000"
HHINCQ3               " 617389.0000"
HHINCQ4               " 993412.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2830712.0000"
sum_size              "2830712.0000"
sum_hhworkers         "2830712.0000"
sum_kids              "2830712.0000"
sum_income            "2830712.0000"
sum_empres            "4013060.0000"
TOTPOP                "7685885.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
HHPOP_est             "7402274.8533"
EMPRES_est            "3777575.5151"
[1] "FINAL tazdata_census (1454 rows):"
# A tibble: 1,454 × 69
   TAZ1454 TOTHH HHPOP EMPRES AGE0004 AGE0519 AGE2044 AGE4564 AGE65P sum_age  SFDU  MFDU hh_own hh_rent hh_size_1 hh_size_2 hh_size_3 hh_size_4_plus hh_wrks_0 hh_wrks_1 hh_wrks_2 hh_wrks_3_plus hh_kids_yes hh_kids_no AGE62P gq_inst gq_type_univ gq_type_mil gq_type_othnon gqpop pers_occ_management pers_occ_professional pers_occ_services pers_occ_retail pers_occ_manual pers_occ_military white_nonh black_nonh asian_nonh other_nonh hispanic HHINCQ1 HHINCQ2 HHINCQ3 HHINCQ4 DISTRICT COUNTY
     <dbl> <dbl> <dbl>  <dbl>   <dbl>   <dbl>   <dbl>   <dbl>  <dbl>   <dbl> <dbl> <dbl>  <dbl>   <dbl>     <dbl>     <dbl>     <dbl>          <dbl>     <dbl>     <dbl>     <dbl>          <dbl>       <dbl>      <dbl>  <dbl>   <dbl>        <dbl>       <dbl>          <dbl> <dbl>               <dbl>                 <dbl>             <dbl>           <dbl>           <dbl>             <dbl>      <dbl>      <dbl>      <dbl>      <dbl>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl>    <dbl>  <dbl>
 1       1    40    87     61       0      11      13      53     10      87     3    34      0      42        12        18         5              5        26        28        11              3           9         59     19       0            2           0              9    11                   0                     5                15              19               8                 0         28          0         25         40        2      22      11       4       8        1      1
 2       2   129   271    184       0      35      47     175     32     289    11   101      0     127        35        67        15             12        80        88        32              9          25        181     61       0            5           0             29    34                   0                    16                49              58              26                 0         68          0        107        124        7      68      30      12      20        1      1
 3       3   350   508    220       8     104     247     138     36     533     0   354      0     344       212       118        20              0        92       107        39             10          32        220     54       0            6           0             34    40                  26                    90                84              60               0                 0        112          4        165        221       11     150      44      71      76        1      1
 4       4   179   263    140      12      10     139      79     43     283     2   176     33     146       127        34        10              8        54        69        25              6          18        133     53       0            4           0             22    26                  26                    45                33              40              35                 0         70         10         49        133       40      62      28      47      39        1      1
 5       5   505   717    475      27      19     340     227    149     762    10   586    102     389       367        92        30             16       183       236        74             26          61        452    172       0           12           0             76    88                  57                   141                75             104              74                 0        177         19        114        241      114     191      81     109     118        1      1
 6       6  2227  2936   2346      14     441    2007     622    262    3346     0  2415    135    2096      1746       377        32             72       313      1511       384             19          98       2146    326       0          441           0              0   441                 314                   997               503             390             107                 0        989        101        647       1054      277     690     585     309     659        1      1
 7       7  3313  4274   2287     101     188    2083    1223    678    4273    72  3472     57    3238      2635       507       106             65      1499      1357       414             29         127       3177    947       0           45           0           1029  1074                 212                   537               687             476             343                 0       1028        230        719        874      523    1990     707     429     184        1      1
 8       8  4636  8050   3398     415    1152    2917    2519   2117    9120    70  4789     98    4568      3001       657       514            464      2421      1425       547            251         700       3952   2675      21            0           0           3188  3188                  63                   433               954             756            1244                 0        974        559       1957       1167     1817    3151     874     578      68        1      1
 9       9  6410  9657   5729     325     747    4622    2975   1190    9859    77  6387    148    6246      4643       871       558            338      2174      3027       980            212         611       5794   1630       0          203           0           1217  1420                 642                  1786              1032             836            1182                 0       1791        688       1873       1828     1296    3273    1487     891     747        1      1
10      10  3955  6709   3825     396     420    3656    1450    841    6763   185  3953    860    3101      2310      1008       364            273      1247      1502       799            207         550       3200   1301       0          390           0            877  1267                 576                  1698               467             569             636                 0       1178        220       1851       1319      746    1171     834     796    1160        1      1
# ℹ 1,444 more rows
# ℹ 22 more variables: DISTRICT_NAME <chr>, County_Name <chr>, AGREMPN <dbl>, FPSEMPN <dbl>, HEREMPN <dbl>, MWTEMPN <dbl>, RETEMPN <dbl>, OTHEMPN <dbl>, TOTEMP <dbl>, sum_groupquarters <dbl>, sum_DU <dbl>, sum_tenure <dbl>, sum_size <dbl>, sum_hhworkers <dbl>, sum_kids <dbl>, sum_income <dbl>, sum_empres <dbl>, TOTPOP <dbl>, sum_ethnicity <dbl>, SHPOP62P <dbl>, HHPOP_est <dbl>, EMPRES_est <dbl>
# ℹ Use `print(n = ...)` to see more rows
[1] "FINAL tazdata_census sums:"
                      [,1]          
TAZ1454               "1057785.0000"
TOTHH                 "2830712.0000"
HHPOP                 "7339321.0000"
EMPRES                "3810997.0000"
AGE0004               " 388882.0000"
AGE0519               "1274751.0000"
AGE2044               "2654468.0000"
AGE4564               "1942799.0000"
AGE65P                "1199821.0000"
sum_age               "7460721.0000"
SFDU                  "1807998.0000"
MFDU                  "1022714.0000"
hh_own                "1597271.0000"
hh_rent               "1233441.0000"
hh_size_1             " 740533.0000"
hh_size_2             " 884230.0000"
hh_size_3             " 498704.0000"
hh_size_4_plus        " 707245.0000"
hh_wrks_0             " 620036.0000"
hh_wrks_1             "1020696.0000"
hh_wrks_2             " 900835.0000"
hh_wrks_3_plus        " 289145.0000"
hh_kids_yes           " 864784.0000"
hh_kids_no            "1965928.0000"
AGE62P                "1504199.0000"
gq_inst               "  48075.0000"
gq_type_univ          "  53047.0000"
gq_type_mil           "   3233.0000"
gq_type_othnon        "  64584.0000"
gqpop                 " 120864.0000"
pers_occ_management   " 536096.0000"
pers_occ_professional "1310215.0000"
pers_occ_services     " 788729.0000"
pers_occ_retail       " 494570.0000"
pers_occ_manual       " 672314.0000"
pers_occ_military     "   8865.0000"
white_nonh            "1750617.0000"
black_nonh            " 271660.0000"
asian_nonh            "1306905.0000"
other_nonh            "3002878.0000"
hispanic              "1128661.0000"
HHINCQ1               " 612643.0000"
HHINCQ2               " 607268.0000"
HHINCQ3               " 617389.0000"
HHINCQ4               " 993412.0000"
DISTRICT              "  21677.0000"
COUNTY                "   5577.0000"
AGREMPN               "  24587.0000"
FPSEMPN               " 834187.0000"
HEREMPN               "1335540.0000"
MWTEMPN               " 596021.0000"
RETEMPN               " 290211.0000"
OTHEMPN               " 580757.0000"
TOTEMP                "3661303.0000"
sum_groupquarters     " 126784.0000"
sum_DU                "2830712.0000"
sum_tenure            "2830712.0000"
sum_size              "2830712.0000"
sum_hhworkers         "2830712.0000"
sum_kids              "2830712.0000"
sum_income            "2830712.0000"
sum_empres            "4013060.0000"
TOTPOP                "7460185.0000"
sum_ethnicity         "7460721.0000"
SHPOP62P              "    289.8924"
HHPOP_est             "7402274.8533"
EMPRES_est            "3777575.5151"
[1] "Wrote 2023/TAZ1454_Ethnicity.csv"
